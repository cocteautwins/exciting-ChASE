<?xml version="1.0" encoding="UTF-8"?>
<xs:schema xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:ex="http://xml.exciting-code.org/inputschemaextentions.xsd" xmlns:xs="http://www.w3.org/2001/XMLSchema" xsi:schemaLocation="http://xml.exciting-code.org/inputschemaextentions.xsd    http://xml.exciting-code.org/inputschemaextentions.xsd">
  <!--
#######################
!DO NOT EDIT THIS FILE!
#######################

This file is compiled form the files in the schema directiory:

input.xsd 
common.xsd 
structure.xsd 
groundstate.xsd 
relax.xsd 
phonons.xsd 
properties.xsd 
xs.xsd 
gw.xsd 
-->
  <xs:annotation>
    <xs:appinfo>
      <includes>common.xsd structure.xsd groundstate.xsd relax.xsd phonons.xsd properties.xsd xs.xsd gw.xsd </includes>
    </xs:appinfo>
  </xs:annotation>
  <xs:annotation>
    <xs:appinfo>
      <root>/</root>
      <parent>.</parent>
    </xs:appinfo>
  </xs:annotation>
  <xs:simpleType name="fortrandouble">
    <xs:annotation>
      <xs:documentation> The type <pre>fortrandouble</pre> allows to use the letters
        <pre>"eEdDqQ"</pre> for exponent operators. This alters in what precision the number is
        parsed. </xs:documentation>
    </xs:annotation>
    <xs:restriction base="xs:token">
      <xs:pattern value="\-?[0-9]*\.?[0-9]+([eEdDqQ][\-+]?[0-9]+)?"/>
    </xs:restriction>
  </xs:simpleType>
  <xs:simpleType name="booleanlist">
    <xs:annotation>
      <xs:documentation> List of space separated booleans.</xs:documentation>
    </xs:annotation>
    <xs:list itemType="xs:boolean"/>
  </xs:simpleType>
  <xs:simpleType name="booleantriple">
    <xs:annotation>
      <xs:documentation> Space separated list of three booleans. <p>Example: <pre> "true false true" </pre></p>
      </xs:documentation>
    </xs:annotation>
    <xs:restriction base="booleanlist">
      <xs:length value="3"/>
    </xs:restriction>
  </xs:simpleType>
  <xs:simpleType name="vector">
    <xs:annotation>
      <xs:documentation> A vector is a space separated list of floating point numbers. <p> Example:
          <pre> "1.3 2.3e4 3 90"</pre>
        </p>
      </xs:documentation>
    </xs:annotation>
    <xs:list itemType="fortrandouble"/>
  </xs:simpleType>
  <xs:simpleType name="integerlist">
    <xs:annotation>
      <xs:documentation> List of space separated integers.</xs:documentation>
    </xs:annotation>
    <xs:list itemType="xs:integer"/>
  </xs:simpleType>
  <xs:simpleType name="vect3d">
    <xs:annotation>
      <xs:documentation> Three dimensional vector as three space separated floating point
        numbers.</xs:documentation>
    </xs:annotation>
    <xs:restriction base="vector">
      <xs:length value="3"/>
    </xs:restriction>
  </xs:simpleType>
  <xs:simpleType name="vect2d">
    <xs:annotation>
      <xs:documentation> Two dimensional vector as two space separated floating point
        numbers.</xs:documentation>
    </xs:annotation>
    <xs:restriction base="vector">
      <xs:length value="2"/>
    </xs:restriction>
  </xs:simpleType>
  <xs:simpleType name="integertriple">
    <xs:annotation>
      <xs:documentation> Space separated list of three integers. <p> Example: <pre> "1 2 3" </pre>
        </p>
      </xs:documentation>
    </xs:annotation>
    <xs:restriction base="integerlist">
      <xs:length value="3"/>
    </xs:restriction>
  </xs:simpleType>
  <xs:simpleType name="integerquadrupel">
    <xs:annotation>
      <xs:documentation> Space separated list of three integers. <p> Example: <pre> "1 2 3 4" </pre>
        </p>
      </xs:documentation>
    </xs:annotation>
    <xs:restriction base="integerlist">
      <xs:length value="4"/>
    </xs:restriction>
  </xs:simpleType>
  <xs:simpleType name="integerpair">
    <xs:annotation>
      <xs:documentation> Space separated list of two integers <p> Example: <pre> "1 2" </pre>
        </p>
      </xs:documentation>
    </xs:annotation>
    <xs:restriction base="integerlist">
      <xs:length value="2"/>
    </xs:restriction>
  </xs:simpleType>
  <xs:attribute ex:importance="experimental" ex:unit="" name="outfileprefix" type="xs:string">
    <xs:annotation>
      <xs:documentation>A prefix to be prepended to the output files.</xs:documentation>
    </xs:annotation>
  </xs:attribute>
  <xs:attribute ex:importance="expert" ex:unit="" name="tfibs" type="xs:boolean" default="true">
    <xs:annotation>
      <xs:documentation> If the IBS correction to the force should be calculated Because calculation
        of the incomplete basis set (IBS) correction to the force is fairly time-consuming, it can
        be switched off by setting <pre> tfibs </pre> to <pre> "false"</pre> This correction can
        then be included only when necessary, i.e. when the atoms are close to equilibrium in a
        structural relaxation run. </xs:documentation>
    </xs:annotation>
  </xs:attribute>
  <xs:attribute ex:importance="expert" ex:unit="" name="tforce" type="xs:boolean" default="false">
    <xs:annotation>
      <xs:documentation> The attribute is set to <pre> "true"</pre> if the force should be
        calculated at the end of the self-consistent cycle This variable is automatically set to
        <pre> "true"</pre> when performing structural optimization. </xs:documentation>
    </xs:annotation>
  </xs:attribute>
  <xs:attribute ex:importance="expert" ex:unit="" name="symmorph" type="xs:boolean" default="false">
    <xs:annotation>
      <xs:documentation> When set to <pre>"true"</pre> only symmorphic space-group operations are to
        be considered, i.e. only symmetries without non-primitive translations are used anywhere in
        the code. </xs:documentation>
    </xs:annotation>
  </xs:attribute>
  <xs:attribute ex:importance="expert" ex:unit="Hartree" name="scissor" type="fortrandouble" default="0.0d0">
    <xs:annotation>
      <xs:documentation> This is the scissors shift applied to states above the Fermi energy.
        Affects DOS, optics and band structure plots.</xs:documentation>
    </xs:annotation>
  </xs:attribute>
  <xs:attribute ex:importance="expert" ex:unit="" name="fastpmat" type="xs:boolean" default="true">
    <xs:annotation>
      <xs:documentation> if <pre>"true"</pre>, a fast method to calculate APW-lo, lo-APW and lo-lo
        parts of the momentum matrix elements in the muffin-tin is used. </xs:documentation>
    </xs:annotation>
  </xs:attribute>
  <xs:attribute ex:importance="expert" ex:unit="" name="intraband" type="xs:boolean" default="false">
    <xs:annotation>
      <xs:documentation> The intraband attribute is <pre>"true"</pre> if the intraband term is to be
        added to the optical matrix (q=0) </xs:documentation>
    </xs:annotation>
  </xs:attribute>
  <xs:attribute ex:importance="expert" ex:unit="" name="action" default="include">
    <xs:annotation>
      <xs:documentation>Select to include or exclude states</xs:documentation>
    </xs:annotation>
    <xs:simpleType>
      <xs:restriction base="xs:string">
        <xs:enumeration value="include"/>
        <xs:enumeration value="exclude"/>
      </xs:restriction>
    </xs:simpleType>
  </xs:attribute>
  <xs:attribute ex:importance="expert" ex:unit="" name="statestype">
    <xs:annotation>
      <xs:documentation>Select for initial or final state range</xs:documentation>
    </xs:annotation>
    <xs:simpleType>
      <xs:restriction base="xs:string">
        <xs:enumeration value="initialstates"/>
        <xs:enumeration value="finalstates"/>
      </xs:restriction>
    </xs:simpleType>
  </xs:attribute>
  <xs:attribute ex:importance="essential" ex:unit="" name="epsforce" type="fortrandouble" default="5.0d-5"> </xs:attribute>
  <xs:attribute ex:importance="essential" ex:unit="" name="nwdos" type="xs:integer" default="500">
    <xs:annotation>
      <xs:documentation>Number of frequency/energy points in the DOS</xs:documentation>
    </xs:annotation>
  </xs:attribute>
  <xs:attribute ex:importance="essential" ex:unit="" name="ngrdos" type="xs:integer" default="100">
    <xs:annotation>
      <xs:documentation>Effective k-point mesh size to be used for Brillouin zone
        integration.</xs:documentation>
    </xs:annotation>
  </xs:attribute>
  <xs:attribute ex:importance="expert" ex:unit="" name="nsmdos" type="xs:integer" default="0">
    <xs:annotation>
      <xs:documentation>Level of smoothing applied to DOS/optics output integer
        0.</xs:documentation>
    </xs:annotation>
  </xs:attribute>
  <xs:element ex:importance="essential" ex:unit="" name="origin">
    <xs:complexType>
      <xs:attribute ex:importance="essential" ex:unit="" name="coord" type="vect3d"/>
    </xs:complexType>
  </xs:element>
  <xs:element ex:importance="essential" ex:unit="" name="point">
    <xs:complexType>
      <xs:attribute ex:importance="essential" ex:unit="" name="coord" type="vect3d" use="required"/>
      <xs:attribute ex:importance="essential" ex:unit="" name="label" type="xs:string" default=""/>
    </xs:complexType>
  </xs:element>
  <xs:element ex:importance="essential" ex:unit="" name="plot1d">
    <xs:annotation>
      <xs:documentation> The element plot1d specifies sample points along a path. The coordinate space (lattice or cartesian)is chosen in the context of the parent.</xs:documentation>
    </xs:annotation>
    <xs:complexType>
      <xs:all>
        <xs:element ex:importance="essential" ex:unit="" name="path" maxOccurs="1" minOccurs="1">
          <xs:complexType>
            <xs:sequence>
              <xs:annotation>
                <xs:documentation>A path consists of at least two points and a number of divisions.</xs:documentation>
              </xs:annotation>
              <xs:element ex:importance="essential" ex:unit="" ref="point" minOccurs="1" maxOccurs="unbounded"/>
            </xs:sequence>
            <xs:attribute ex:importance="essential" ex:unit="" name="steps" type="xs:integer" use="required"/>
            <xs:attribute ex:importance="expert" ex:unit="" ref="outfileprefix"/>
          </xs:complexType>
        </xs:element>
      </xs:all>
    </xs:complexType>
  </xs:element>
  <xs:element ex:importance="essential" ex:unit="" name="plot2d">
    <xs:annotation>
      <xs:documentation>Defines a 2d plot domain.</xs:documentation>
    </xs:annotation>
    <xs:complexType>
      <xs:all>
        <xs:element ex:importance="essential" ex:unit="" name="parallelogram" maxOccurs="1" minOccurs="1">
          <xs:complexType>
            <xs:sequence>
              <xs:element ex:importance="essential" ex:unit="" ref="origin" minOccurs="1" maxOccurs="1"/>
              <xs:element ex:importance="essential" ex:unit="" ref="point" minOccurs="2" maxOccurs="2"/>
            </xs:sequence>
            <xs:attribute ex:importance="essential" ex:unit="" name="grid" type="integerpair" use="required"/>
            <xs:attribute ex:importance="expert" ex:unit="" ref="outfileprefix"/>
          </xs:complexType>
        </xs:element>
      </xs:all>
    </xs:complexType>
  </xs:element>
  <xs:element ex:importance="essential" ex:unit="" name="plot3d">
    <xs:annotation>
      <xs:documentation>Defines a 3d plot domain.</xs:documentation>
    </xs:annotation>
    <xs:complexType>
      <xs:all>
        <xs:element ex:importance="essential" ex:unit="" name="box" maxOccurs="1" minOccurs="1">
          <xs:complexType>
            <xs:sequence>
              <xs:element ex:importance="essential" ex:unit="" ref="origin" minOccurs="1" maxOccurs="1"/>
              <xs:element ex:importance="essential" ex:unit="" ref="point" minOccurs="3" maxOccurs="3"/>
            </xs:sequence>
            <xs:attribute ex:importance="essential" ex:unit="" name="grid" type="integertriple" use="required"/>
            <xs:attribute ex:importance="expert" ex:unit="" ref="outfileprefix"/>
          </xs:complexType>
        </xs:element>
      </xs:all>			
      <xs:attribute ex:importance="expert" ex:unit="" name="usesym" type="xs:boolean" default="false">
        <xs:annotation>
	  <xs:documentation> When set to <pre>"true"</pre>, crystal symmetries
  	    are used in the determination of the 3D spatial grid. Also, in that case the whole unit cell
	    is sampled. 
          </xs:documentation>
        </xs:annotation>
      </xs:attribute>
    </xs:complexType>
  </xs:element>
  <xs:element ex:importance="essential" ex:unit="" name="kstlist">
    <xs:annotation>
      <xs:documentation> The kstlist element is used in the LSJ and wavefunction plot element This
        is a user-defined list of <inlinemath>{ \bf k}</inlinemath>-point and state index pairs
        which are those used for plotting wavefunctions and writing <inlinemath>{ \bf
          L}</inlinemath>, <inlinemath>{ \bf S}</inlinemath> and <inlinemath>{ \bf J} </inlinemath>
        expectation values. </xs:documentation>
    </xs:annotation>
	<xs:complexType>
	  <xs:sequence>
	    <xs:element ex:importance="essential" ex:unit="" name="pointstatepair" type="integerpair" minOccurs="1" maxOccurs="unbounded">
	      <xs:annotation>
	        <xs:documentation> The element <pre>pointstatepair</pre> defines a <inlinemath>{ \bf
	          k}</inlinemath>-point and state index pair. </xs:documentation>
	        </xs:annotation>
	    </xs:element>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
  <xs:element ex:importance="expert" ex:unit="" name="energywindow">
    <xs:complexType>
      <xs:attribute ex:importance="expert" ex:unit="" name="points" type="xs:integer" default="500">
        <xs:annotation>
          <xs:documentation>number of points to be sampled linearly inside the energy interval
            including the lower limit.</xs:documentation>
        </xs:annotation>
      </xs:attribute>
      <xs:attribute ex:importance="expert" ex:unit="" name="intv" type="vect2d" default="-0.5d0 0.5d0">
        <xs:annotation>
          <xs:documentation>energy interval lower and upper limits.</xs:documentation>
        </xs:annotation>
      </xs:attribute>
    </xs:complexType>
  </xs:element>
  <xs:element ex:importance="expert" ex:unit="" name="qpointset">
    <xs:complexType>
      <xs:sequence>
        <xs:element ex:importance="expert" ex:unit="" name="qpoint" type="vect3d" minOccurs="1" maxOccurs="unbounded">
          <xs:annotation>
            <xs:documentation> a q-point is given in reciprocal space coordinates</xs:documentation>
          </xs:annotation>
        </xs:element>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
  <xs:element ex:importance="expert" ex:unit="" name="parts">
    <xs:complexType>
      <xs:sequence>
        <xs:element ex:importance="expert" ex:unit="" name="dopart" minOccurs="0" maxOccurs="unbounded">
          <xs:complexType>
            <xs:attribute ex:importance="expert" ex:unit="" name="id" type="xs:string" use="required">
              <xs:annotation>
                <xs:documentation> This attribute is used to trigger lower-level tasks and is mainly
                  used for testing, debugging, and the testing of new features. Do not use it unless
                  you know what you are doing.</xs:documentation>
              </xs:annotation>
            </xs:attribute>
          </xs:complexType>
        </xs:element>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
  <xs:annotation>
    <xs:appinfo>
      <parent>/input</parent>
      <root>structure</root>
    </xs:appinfo>
  </xs:annotation>
  <xs:element ex:importance="essential" ex:unit="" name="structure">
    <xs:annotation>
      <xs:documentation>This element contains all structural information, such as unit-cell
        parameters as well as type and position of each atom. The presence of the subelement
          <elementref>species</elementref> is necessary unless one wants to perform an empty-lattice
        calculation. The attribute <attref>speciespath</attref> must be
        specified.</xs:documentation>
    </xs:annotation>
    <xs:complexType>
      <xs:sequence>
        <xs:element ex:importance="essential" ex:unit="" name="crystal" minOccurs="1" maxOccurs="1">
          <xs:annotation>
            <xs:documentation>Defines the unit cell of the crystal via the 3 basis
              vectors.</xs:documentation>
          </xs:annotation>
          <xs:complexType>
            <xs:annotation>
              <xs:documentation>The unit cell is spanned by 3 base vectors that define the lattice
                coordinates.</xs:documentation>
            </xs:annotation>
            <xs:sequence>
              <xs:element ex:importance="essential" ex:unit="Bohr" name="basevect" minOccurs="3" maxOccurs="3" type="vect3d">
                <xs:annotation>
                  <xs:documentation>Defines one basis vector in Cartesian
                    coordinates.</xs:documentation>
                  <xs:appinfo>
                    <oldname>avec</oldname>
                  </xs:appinfo>
                </xs:annotation>
              </xs:element>
            </xs:sequence>
            <xs:attribute ex:importance="essential" ex:unit="1" name="scale" type="fortrandouble" default="1.0d0">
              <xs:annotation>
                <xs:documentation>Scales all the lattice vectors by the same factor. This is useful
                  for varying the volume.</xs:documentation>
                <xs:appinfo>
                  <oldname>scale</oldname>
                </xs:appinfo>
              </xs:annotation>
            </xs:attribute>
            <xs:attribute ex:importance="essential" ex:unit="" name="stretch" type="vect3d" default="1.0d0 1.0d0 1.0d0 ">
              <xs:annotation>
                <xs:documentation> Allows for an individual scaling of each lattice vector
                  separately. <pre>"1 1 1"</pre> means no scaling. </xs:documentation>
                <xs:appinfo>
                  <oldname>(sc1|sc2|sc3)</oldname>
                </xs:appinfo>
              </xs:annotation>
            </xs:attribute>
          </xs:complexType>
        </xs:element>
        <xs:element ex:importance="essential" ex:unit="" name="species" minOccurs="0" maxOccurs="unbounded">
          <xs:annotation>
            <xs:documentation>Defines the atomic species, <it>i.e.</it>, the chemical element. Aatomic
              coordinates and, optionally, quantities relevant for magnetic calculations are defined
              in the subelement(s) atom.</xs:documentation>
          </xs:annotation>
          <xs:complexType>
            <xs:sequence>
              <xs:element ex:importance="essential" ex:unit="" name="atom" minOccurs="1" maxOccurs="unbounded">
                <xs:annotation>
                  <xs:documentation>Defines the position and other attributes of one atom in the
                    unit cell.</xs:documentation>
                  <xs:appinfo>
                    <oldname>noname</oldname>
                  </xs:appinfo>
                </xs:annotation>
                <xs:complexType>
                  <xs:attribute ex:importance="essential" ex:unit="lattice coordinates" name="coord" type="vect3d" use="required">
                    <xs:annotation>
                      <xs:documentation>Atom position in lattice coordinates.</xs:documentation>
                      <xs:appinfo>
                        <oldname>atposl</oldname>
                      </xs:appinfo>
                    </xs:annotation>
                  </xs:attribute>

                  <xs:attribute ex:importance="expert" ex:unit="" name="lockxyz" type="booleantriple" default="false false false" use="optional">
                    <xs:annotation>
                      <xs:documentation>Switches to constrain atomic movement along x/y/z directions.</xs:documentation>
                    </xs:annotation>
                  </xs:attribute>

                  <xs:attribute ex:importance="expert" ex:unit="" name="bfcmt" type="vect3d" default="0.0d0 0.0d0 0.0d0" use="optional">
                    <xs:annotation>
                      <xs:documentation>Muffin-tin external magnetic field in Cartesian
                        coordinates.</xs:documentation>
                    </xs:annotation>
                  </xs:attribute>
                  <xs:attribute ex:importance="expert" ex:unit="" name="mommtfix" type="vect3d" default="0.0d0 0.0d0 0.0d0" use="optional">
                    <xs:annotation>
                      <xs:documentation>The desired muffin-tin moment for a Fixed Spin Moment (FSM)
                        calculation.</xs:documentation>
                    </xs:annotation>
                  </xs:attribute>
                </xs:complexType>
              </xs:element>
              <xs:element ex:importance="expert" ex:unit="" name="LDAplusU" minOccurs="0">
                <xs:annotation>
                  <xs:documentation> The LADplusU element is used to specify the  J, U, and l
                    parameters of an atomic species. To switch on the LDAplusU feature one needs to set the
                      <attref>ldapu</attref> attribute of the groundstate element.
                  </xs:documentation>
                </xs:annotation>
                <xs:complexType>
                  <xs:attribute ex:importance="expert" ex:unit="" name="l" type="xs:integer" default="-1">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldname>notaname</oldname>
                      </xs:appinfo>
                    </xs:annotation>
                  </xs:attribute>
                  <xs:attribute ex:importance="expert" ex:unit="" name="U" type="fortrandouble" default="0.0d0">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldname>notaname</oldname>
                      </xs:appinfo>
                    </xs:annotation>
                  </xs:attribute>
                  <xs:attribute ex:importance="expert" ex:unit="" name="J" type="fortrandouble" default="0.0d0">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldname>notaname</oldname>
                      </xs:appinfo>
                    </xs:annotation>
                  </xs:attribute>
                </xs:complexType>
              </xs:element>
              <xs:element ex:importance="expert" ex:unit="" name="dfthalfparam" minOccurs="0" maxOccurs="1">
			<xs:annotation>
				<xs:documentation> This element specifies some of the fundamentals parameters 
					(for each species) regarding a <bf>DFT-1/2</bf> calculation. 
					Do not forget to specify the subelement <elementref>dfthalf</elementref> 
					inside the element <elementref>groundstate</elementref>, otherwise 
					no <bf>DFT-1/2</bf> correction will be done 
					(even though you specify the parameters).
				</xs:documentation>
			</xs:annotation>
			<xs:complexType>
				<xs:sequence>
					<xs:element ex:importance="essential" ex:unit="" name="shell" minOccurs="1" maxOccurs="unbounded">
						<xs:annotation>
							<xs:documentation> 
							  This element specifies the shell to which the <bf>DFT-1/2</bf> correction should be applied to.
							</xs:documentation>
						</xs:annotation>
					  <xs:complexType>
						<xs:attribute ex:importance="expert" ex:unit="" name="number" type="xs:integer" default="0">
							<xs:annotation>
								<xs:documentation> Specifies the number of the shell to be ionized. For instance,
								a number equal to 1 will ionize the first shell, a number equal to 2, the second, and so on.
								The default value of 0 corresponds to the last shell specified in the species file.
								</xs:documentation>
							</xs:annotation>
						</xs:attribute>
						<xs:attribute ex:importance="expert" ex:unit="Bohr" name="ionization" type="fortrandouble" default="0.5d0">
							<xs:annotation>
								<xs:documentation> Specifies the degree of ionization.
								</xs:documentation>
							</xs:annotation>
						</xs:attribute>
					  </xs:complexType>
					</xs:element>
				 </xs:sequence>
				 <xs:attribute ex:importance="expert" ex:unit="" name="ampl" type="fortrandouble" default="1.00">
					<xs:annotation>
						<xs:documentation> Specifies the amplitude of the self-energy potential.
						</xs:documentation>
					</xs:annotation>
				</xs:attribute>
				<xs:attribute ex:importance="expert" ex:unit="" name="exponent" type="xs:integer" default="8">
					<xs:annotation>
						<xs:documentation> Specifies the exponent <inlinemath>n</inlinemath> of the cutoff-function
							(for the self-energy potential)
							<displaymath>
							  \Theta (r) = A\left[1-\left(\frac{r}{r_{\rm cut}} \right)^{\!\!n} \right]^3
							  \nonumber
							</displaymath>
							for <inlinemath>r \le r_{\rm cut}</inlinemath>.
						</xs:documentation>
					</xs:annotation>
				</xs:attribute>
				<xs:attribute ex:importance="expert" ex:unit="Bohr" name="cut" type="fortrandouble" default="0.0d0">
					<xs:annotation>
						<xs:documentation> Specifies the value of <inlinemath>r_{\rm cut}</inlinemath> (in Bohrs) 
							for the self-energy potential, which determines the range of the correction. 
							Note that this can/should be specified for each species.
						</xs:documentation>
					</xs:annotation>
				</xs:attribute>
                </xs:complexType>  
              </xs:element>
            </xs:sequence>
            <xs:attribute ex:importance="essential" ex:unit="" name="speciesfile" type="xs:anyURI" use="required">
              <xs:annotation>
                <xs:documentation> Defines the file that contains the species definition. It is
                  looked up in the species directory specified by  <attref>speciespath</attref>. By default, the
                  name of the file is <it>element</it>.<pre>xml</pre>, <it>e.g.</it>, <pre>Ag.xml</pre>. </xs:documentation>
                <xs:appinfo>
                  <oldname>spfname</oldname>
                </xs:appinfo>
              </xs:annotation>
            </xs:attribute>
            <xs:attribute ex:importance="output" ex:unit="" name="chemicalSymbol" type="xs:string" use="optional" default="">
              <xs:annotation>
                <xs:documentation> Optional attribute that may be used in visualization and by
                  converters. It is ignored by <exciting>exciting</exciting>.
                </xs:documentation>
                <xs:appinfo>
                  <oldname>spsymb</oldname>
                </xs:appinfo>
              </xs:annotation>
            </xs:attribute>
            <xs:attribute ex:importance="output" ex:unit="" name="atomicNumber" type="xs:integer" use="optional">
              <xs:annotation>
                <xs:documentation> Optional attribute that may be used in visualization and by
                  converters. It is not used in <exciting>exciting</exciting>.
                </xs:documentation>
              </xs:annotation>
            </xs:attribute>
            <xs:attribute ex:importance="expert" ex:unit="Bohr" name="rmt" type="fortrandouble" default="-1.0d0" use="optional">
              <xs:annotation>
                <xs:appinfo>
                  <oldname>noreplace&gt;</oldname>
                </xs:appinfo>
                <xs:documentation> Defines the muffin-tin radius. This optional parameter allows to
                  override the value either specified in the species file or generated by automatic determination.
                   The muffin-tin radius defines
                  the region around the atomic nucleus where the wave function is expanded in terms
                  of atomic-like functions. In contrast, the interstitial region, <it>i.e.</it>, the 
                  region not belonging to any muffin-tin sphere, is described by planewaves.
                 </xs:documentation>
              </xs:annotation>
            </xs:attribute>
           

          </xs:complexType>
        </xs:element>
         <xs:element ex:importance="ignore" ex:unit="" name="symmetries" maxOccurs="1" minOccurs="0">
         <xs:annotation>
         <xs:appinfo>
         
         </xs:appinfo>
         </xs:annotation>
         </xs:element>
         
            </xs:sequence>
      <xs:attribute ex:importance="essential" ex:unit="" name="speciespath" type="xs:anyURI" use="required">
        <xs:annotation>
          <xs:documentation> The path to the directory containing the species files. Alternatively,
            it can be defined as an HTTP URL, in this case the <a href="http://exciting-code.org/wget"> wget </a> utility must be installed. </xs:documentation>
          <xs:appinfo>
            <oldname>sppath</oldname>
          </xs:appinfo>
        </xs:annotation>
      </xs:attribute>
<!-- Giulio Biddau 1.11.2012-->
      <xs:attribute ex:importance="expert" ex:unit="" name="cartesian" type="xs:boolean" default="false">
        <xs:annotation>
          <xs:documentation> 
	  If <pre>"true"</pre> the input atomic positions are given in cartesian coordinates.
	  </xs:documentation>
        </xs:annotation>
      </xs:attribute>
<!-- Giulio Biddau 1.11.2012-->
      <xs:attribute ex:importance="expert" ex:unit="" name="rmtapm" type="vect2d" default="0.25d0 0.95d0">
        <xs:annotation>
          <xs:documentation> This attribute assigns the two parameters governing the automatic
            generation of the muffin-tin radii. When the attribute <attref>autormt</attref> is set
            to <pre>"true"</pre>, the muffin-tin radii are determined according to the following
            expression <displaymath>R_i\propto 1+\zeta|Z_i|^{1/3}, </displaymath> where
              <inlinemath>Z_i</inlinemath> is the atomic number of the <inlinemath>i</inlinemath> th
            species, <inlinemath>\zeta</inlinemath> is stored in <attref>rmtapm</attref>(1). The
            distance between the muffin-tin speheres is determined by the value of
              <attref>rmtapm</attref>(2): When <attref>rmtapm</attref>(2)=1, the closest muffin-tin
            spheres will touch each other. </xs:documentation>
        </xs:annotation>
      </xs:attribute>
      <xs:attribute ex:importance="expert" ex:unit="Bohr" name="epslat" type="fortrandouble" default="1.0d-6">
        <xs:annotation>
          <xs:documentation>This attribute defines the accuracy up to which two vectors can be
            considered numerically identical. Vectors with lengths less than this are considered
            zero.</xs:documentation>
        </xs:annotation>
      </xs:attribute>
      <xs:attribute ex:importance="expert" ex:unit="" name="autormt" type="xs:boolean" default="false">
        <xs:annotation>
          <xs:documentation> If <pre>"true"</pre>, the muffin-tin radius of each species is
            automatically set according to the variables specified by the attribute
              <attref>rmtapm</attref>. </xs:documentation>
        </xs:annotation>
      </xs:attribute>
      <xs:attribute ex:importance="expert" ex:unit="" name="primcell" type="xs:boolean" default="false">
        <xs:annotation>
          <xs:documentation> If <pre>"true"</pre>, the primitive unit cell is determined
            automatically from the conventional cell defined by the basis vectors given by the
              <elementref>basevect</elementref> elements. The primitive unit cell is determined by
            searching for lattice vectors among all vectors connecting atomic sites and choosing the
            three shortest ones which produce a unit cell with non-zero volume. </xs:documentation>
        </xs:annotation>
      </xs:attribute>
      <xs:attribute ex:importance="expert" ex:unit="" name="tshift" type="xs:boolean" default="true">
        <xs:annotation>
          <xs:documentation> If <pre>"true"</pre>,  the crystal is shifted such that
            the atom closest to the origin is exactly at the origin. </xs:documentation>
        </xs:annotation>
      </xs:attribute>
    </xs:complexType>
  </xs:element>
  <xs:annotation>
    <xs:appinfo>
      <parent>/input</parent>
      <root>groundstate</root>
    </xs:appinfo>
  </xs:annotation>
  <xs:element ex:importance="essential" ex:unit="" name="groundstate">
    <xs:annotation>
      <xs:documentation> 
      The <elementref>groundstate</elementref> element is required for any calculation. 
      Its attributes are parameters and methods which are used to calculate the ground-state density.
      </xs:documentation>
    </xs:annotation>
    <xs:complexType>
      <xs:all>
        
	<xs:element ex:importance="expert" ex:unit="" name="DFTD2parameters" minOccurs="0" maxOccurs="1">
          <xs:annotation>
            <xs:documentation> 
	      This element allows to customize parameters when either the option <pre>"DFTD2"</pre> of the attribute <attref>vdWcorrection</attref> is chosen, or the subelement <elementref>DFTD2</elementref> of the element <elementref>properties</elementref> is specified.
	    </xs:documentation>
            <xs:appinfo/>
          </xs:annotation>
          <xs:complexType>

            <xs:attribute ex:importance="essential" ex:unit="" name="s6" type="fortrandouble" default="0.75d0">
              <xs:annotation>
                <xs:documentation>
			Global scaling factor for all <inlinemath>C_6</inlinemath>-dispersion coefficients for the method <pre>"DFTD2"</pre>. This factor depends on the exchange-correlation functional in use. The default value suits PBE calculations.  
		</xs:documentation>
              </xs:annotation>
            </xs:attribute>

            <xs:attribute ex:importance="essential" ex:unit="" name="sr6" type="fortrandouble" default="1.1d0">
              <xs:annotation>
                <xs:documentation>
			Scaling factor for van-der-Waals radii for the method <pre>"DFTD2"</pre>. This factor depends on the exchange-correlation functional in use. The default value suits PBE calculations.  
		</xs:documentation>
              </xs:annotation>
            </xs:attribute>

            <xs:attribute ex:importance="essential" ex:unit="" name="d" type="fortrandouble" default="20.0d0">
              <xs:annotation>
                <xs:documentation>
			This damping constant determines the steepnes of the damping function for the method <pre>"DFTD2"</pre>.
		</xs:documentation>
              </xs:annotation>
            </xs:attribute>

            <xs:attribute ex:importance="essential" ex:unit="" name="cutoff" type="fortrandouble" default="95.0d0">
              <xs:annotation>
                <xs:documentation>
		  Cutoff distance of interatomic interactions for the method <pre>"DFTD2"</pre>. In the sum over all pairwise interactions, only pairs of atoms are considered which are closer to each other than the value of the <pre>cutoff</pre> attribute.
		</xs:documentation>
              </xs:annotation>
            </xs:attribute>
	  </xs:complexType>
	</xs:element>



	<xs:element ex:importance="expert" ex:unit="" name="TSvdWparameters" minOccurs="0" maxOccurs="1">
          <xs:annotation>
            <xs:documentation> 
	      This element allows to customize parameters when either the option <pre>"TSvdW"</pre> of the attribute <attref>vdWcorrection</attref> is chosen, or the subelement <elementref>TSvdW</elementref> of the element <elementref>properties</elementref> is specified.
	    </xs:documentation>
            <xs:appinfo/>
          </xs:annotation>
          <xs:complexType>

            <xs:attribute ex:importance="essential" ex:unit="" name="s6" type="fortrandouble" default="1.0d0">
              <xs:annotation>
                <xs:documentation>
			Global scaling factor for all <inlinemath>C_6</inlinemath>-dispersion coefficients for the method <pre>"TSvdW"</pre>.
		</xs:documentation>
              </xs:annotation>
            </xs:attribute>

            <xs:attribute ex:importance="essential" ex:unit="" name="sr6" type="fortrandouble" default="0.94d0">
              <xs:annotation>
                <xs:documentation>
			Scaling factor for van-der-Waals radii for the method <pre>"TSvdW"</pre>. This factor depends on the exchange-correlation functional in use. The default value suits PBE calculations.  
		</xs:documentation>
              </xs:annotation>
            </xs:attribute>

            <xs:attribute ex:importance="essential" ex:unit="" name="d" type="fortrandouble" default="20.0d0">
              <xs:annotation>
                <xs:documentation>
			This damping constant determines the steepnes of the damping function for the method <pre>"TSvdW"</pre>.
		</xs:documentation>
              </xs:annotation>
            </xs:attribute>

            <xs:attribute ex:importance="essential" ex:unit="" name="cutoff" type="fortrandouble" default="95.0d0">
              <xs:annotation>
                <xs:documentation>
		  Cutoff distance of interatomic interactions for the method <pre>"TSvdW"</pre>. In the sum over all pairwise interactions, only pairs of atoms are considered which are closer to each other than the value of the <pre>cutoff</pre> attribute.
		</xs:documentation>
              </xs:annotation>
            </xs:attribute>

            <xs:attribute ex:importance="essential" ex:unit="" name="nr" type="xs:integer" default="120">
              <xs:annotation>
                <xs:documentation>
		  Number of radial grid points for the Gauss-Chebyshev quadrature.
		</xs:documentation>
              </xs:annotation>
            </xs:attribute>

            <xs:attribute ex:importance="essential" ex:unit="" name="nsph" type="xs:integer" default="590">
              <xs:annotation>
                <xs:documentation>
		  Number of Lebedev grid points. The <bf>only</bf> possible values are: <pre>"1"</pre>, <pre>"6"</pre>, <pre>"14"</pre>, <pre>"26"</pre>, <pre>"38"</pre>, <pre>"50"</pre>, <pre>"74"</pre>, <pre>"86"</pre>, <pre>"110"</pre>, <pre>"146"</pre>, <pre>"170"</pre>, <pre>"194"</pre>, <pre>"230"</pre>, <pre>"266"</pre>, <pre>"302"</pre>, <pre>"350"</pre>, <pre>"434"</pre>, <pre>"590"</pre>, <pre>"770"</pre>, <pre>"974"</pre>, <pre>"1202"</pre>, <pre>"1454"</pre>, <pre>"1730"</pre>, <pre>"2030"</pre>, <pre>"2354"</pre>, <pre>"2702"</pre>, <pre>"3074"</pre>, <pre>"3740"</pre>, <pre>"3890"</pre>, <pre>"4334"</pre>, <pre>"4802"</pre>, <pre>"5294"</pre>, <pre>"5810"</pre>.
		</xs:documentation>
              </xs:annotation>
            </xs:attribute>

	  </xs:complexType>
	</xs:element>


	
	<xs:element ex:importance="essential" ex:unit="" name="spin" minOccurs="0" maxOccurs="1">
          <xs:annotation>
            <xs:documentation> 
	    If the <elementref>spin</elementref> element is present, calculation is done with
            spin polarization. 
	    </xs:documentation>
            <xs:appinfo>
              <oldname>spinpol</oldname>
            </xs:appinfo>
          </xs:annotation>
          <xs:complexType>
            <xs:attribute ex:importance="essential" ex:unit="" name="momfix" type="vect3d" default="0.0d0 0.0d0 0.0d0">
              <xs:annotation>
                <xs:documentation>
	        The desired total moment for a fixed spin moment (<pre>FSM</pre>) calculation.
		</xs:documentation>
              </xs:annotation>
            </xs:attribute>
            <xs:attribute ex:importance="essential" ex:unit="" name="bfieldc" type="vect3d" default="0.0d0 0.0d0 0.0d0 ">
              <xs:annotation>
                <xs:documentation> 
		Allows to apply a constant <inlinemath>{ \bf B}_{\tt ext}</inlinemath> field. 
		This is an external constant magnetic field applied throughout the entire unit cell 
		and enters the second-variational Hamiltonian as 
		<displaymath>\frac{g_e\,\alpha}{4}\;\vec{\sigma}\cdot{\bf B}_{\tt ext}\,,</displaymath>
		where <inlinemath>g_e</inlinemath> is the electron <inlinemath>g</inlinemath>-factor
                (<inlinemath>g_e</inlinemath>=2.0023193043718). The external magnetic field is normally used
                to break spin symmetry for spin-polarised calculations and considered to be
                infinitesimal with no direct contribution to the total energy. In cases where the
                magnetic field is finite (for example when computing magnetic response) the
                external <inlinemath>{ \bf B}</inlinemath>-field energy reported in
                <filename>INFO.OUT</filename> (when the attribute <attref>outputlevel</attref> is set to 
		<pre>"high"</pre>) should be added to the total energy by hand. This external magnetic field 
		is applied hroughout the entire unit cell. To apply magnetic fields in particular muffin-tins 
		use the <attref>bfcmt</attref> vectors in the <elementref>atom</elementref> elements.
                Collinear calculations are more efficient if the field is applied in the
                <inlinemath>z</inlinemath>-direction. 
		</xs:documentation>
              </xs:annotation>
            </xs:attribute>
            <xs:attribute ex:importance="essential" ex:unit="" name="spinorb" type="xs:boolean" default="false">
              <xs:annotation>
                <xs:documentation> 
		If <attref>spinorb</attref> is <pre>"true"</pre>, then a
                <inlinemath>\boldsymbol \sigma\cdot{ \bf L}</inlinemath> term is added to the
                second-variational Hamiltonian. 
		</xs:documentation>
              </xs:annotation>
            </xs:attribute>
            <xs:attribute ex:importance="expert" ex:unit="" name="spinsprl" type="xs:boolean" default="false">
              <xs:annotation>
                <xs:documentation> 
		Set to <pre>"true"</pre> if a spin-spiral calculation is required. 
                Experimental feature for the calculation of spin-spiral states.
                See <attref>vqlss</attref> for details. 
		</xs:documentation>
              </xs:annotation>
            </xs:attribute>
            <xs:attribute ex:importance="expert" ex:unit="" name="vqlss" type="vect3d" default="0.0d0 0.0d0 0.0d0">
              <xs:annotation>
                <xs:documentation> 
		This attribute allows to specify the <inlinemath>{ \bf q}</inlinemath>-vector of the
                spin-spiral state in lattice coordinates. Spin-spirals arise from spinor states
                assumed to be of the form 
		<displaymath> 
		  \Psi^{ \bf q}_{ \bf k}({ \bf r})= 
		  \left(\begin{array}{c} 
		  U^{{ \bf q}\uparrow}_{ \bf k}({ \bf r})\;e^{i({ \bf k+q/2})\cdot{ \bf r}} \\
		  \phantom{o} \\
                  U^{{ \bf q}\downarrow}_{ \bf k}({ \bf r})\;e^{i({ \bf k-q/2})\cdot{ \bf r}} \\ 
                  \end{array} \right)\,. 
		</displaymath> 
		These spin-spirals are determined using a second-variational approach, 
		and give rise to a magnetization density of the form
                <displaymath> 
		  {\bf m}^{ \bf q}({ \bf r})=\left[m_x({\bf r})\,\cos({ \bf q \cdot r}),\;
                  m_y({\bf r})\,\sin({ \bf q \cdot r}),\; m_z({\bf r})\right]\,, 
		</displaymath> where
                <inlinemath>m_x</inlinemath>, <inlinemath>m_y</inlinemath>, and <inlinemath>m_z</inlinemath>
                have the periodicity of the lattice. See also <attref>spinsprl</attref>. 
		</xs:documentation>
              </xs:annotation>
            </xs:attribute>
            <xs:attribute ex:importance="expert" ex:unit="" name="taufsm" type="fortrandouble" default="0.01d0">
              <xs:annotation>
                <xs:documentation> 
		The effective magnetic field required for fixing the spin moment
                to a given value, is updated according to 
                <displaymath> 
		  {\bf B}_{\tt FSM}^{i+1}={\bf B}_{\tt FSM}^i+\tau_{\tt FSM}\left(
                  \boldsymbol{\mu}^i-\boldsymbol{\mu}_{\tt FSM}\right)\,, 
		</displaymath>
                for iteration <inlinemath>i</inlinemath>. It must be positive. 
		</xs:documentation>
              </xs:annotation>
              </xs:attribute>
            <xs:attribute ex:importance="expert" ex:unit="" name="reducebf" type="fortrandouble" default="1.0d0">
              <xs:annotation>
                <xs:documentation> 
		After each iteration the external magnetic fields are multiplied
                with reducebf. This allows for a large external magnetic field at the start of
                the self-consistent loop to break spin symmetry, while at the end of the loop the
                field will be effectively zero, i.e. infinitesimal. See <attref>bfieldc</attref>
                and atom element. 
		</xs:documentation>
              </xs:annotation>
            </xs:attribute>
            <xs:attribute ex:importance="essential" ex:unit="" name="fixspin" default="none">
              <xs:simpleType>
                <xs:restriction base="xs:string">
                  <xs:enumeration value="none">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr>0</oldnr>
                      </xs:appinfo>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="total FSM">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr>1</oldnr>
                      </xs:appinfo>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="localmt FSM">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr>2</oldnr>
                      </xs:appinfo>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="both">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr>3</oldnr>
                      </xs:appinfo>
                    </xs:annotation>
                  </xs:enumeration>
                </xs:restriction>
              </xs:simpleType>
            </xs:attribute>
          </xs:complexType>
        </xs:element>      
        <xs:element ex:importance="experimental" ex:unit="" name="HartreeFock" minOccurs="0" maxOccurs="1">
          <xs:annotation>
            <xs:documentation>If preset Hartree-Fock calculation is triggered.</xs:documentation>
          </xs:annotation>                 
          <xs:complexType>
          </xs:complexType>
          
          </xs:element>
                <xs:element ex:importance="expert" ex:unit="" name="dfthalf" minOccurs="0" maxOccurs="1">
			<xs:annotation>
			  <xs:documentation>The presence of this element triggers <bf>DFT-1/2</bf> calculations.</xs:documentation>				
			</xs:annotation>
			<xs:complexType>
				<xs:attribute ex:importance="expert" ex:unit="" name="printVSfile" type="xs:boolean" default="false">
					<xs:annotation>
						<xs:documentation> When set to <pre>"true"</pre>, the self-energy 
						correction potential <inlinemath>V_S({\bf r})</inlinemath>
						(as defined in the <bf>DFT-1/2</bf> method) is calculated for each constituent 
						atomic species and written into the files <pre>VS_S*.OUT</pre>, 
						where <pre>*</pre> ranges from <bf>1</bf> to the number of atomic species. 
						The exciting run quits after the printing. In this case, a serial calculation 
						is suggested. It is useful to visualize the self-energy potential, or for 
						debugging purposes.
						</xs:documentation>
					</xs:annotation>
				</xs:attribute>
			</xs:complexType>			
          </xs:element>
        <xs:element ex:importance="essential" ex:unit="" name="Hybrid" minOccurs="0" maxOccurs="1">
          <xs:annotation>
            <xs:documentation>Options for hybrid functionals.</xs:documentation>
          </xs:annotation>                 
          <xs:complexType>
            <xs:attribute ex:importance="essential" ex:unit="" name="exchangetype" default="HF">
              <xs:annotation>
                  <xs:documentation> Type of exchange (Hartree Fock or OEP) 
                  to be used for the exact exchange.
                  </xs:documentation>
              </xs:annotation>
              <xs:simpleType>
                <xs:restriction base="xs:string">
                  <xs:enumeration value="HF">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr>1</oldnr>
                      </xs:appinfo>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="OEP">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr>2</oldnr>
                      </xs:appinfo>
                    </xs:annotation>
                  </xs:enumeration>
                </xs:restriction>
              </xs:simpleType>
            </xs:attribute>
            <xs:attribute ex:importance="essential" ex:unit="" name="excoeff" type="fortrandouble" default="0.25d0">
              <xs:annotation>
                <xs:documentation> Define value of the mixing parameter for exact exchange.
                  ATTENTION: If you are using libxc, the libxc settings will be employed 
                  and your choice of this parameter will be ignored. 
                  </xs:documentation>
              </xs:annotation>
            </xs:attribute>
            <xs:attribute ex:importance="experimental" ex:unit="" name="eccoeff" type="fortrandouble" default="1.0d0">
              <xs:annotation>
                <xs:documentation> Use for testing purposes only! </xs:documentation>
              </xs:annotation>
            </xs:attribute>
            <xs:attribute ex:importance="essential" ex:unit="" name="maxscl" type="xs:integer" default="50">
              <xs:annotation>
                <xs:documentation>Upper limit for the Hybrids self-consistency loop.</xs:documentation>
              </xs:annotation>
            </xs:attribute>
            <xs:attribute ex:importance="experimental" ex:unit="" name="savepotential" type="xs:boolean" default="true">
              <xs:annotation>
                <xs:documentation>
                  If set to true, the non-local potential will be stored in the file VNLMAT.OUT 
                  ATTENTION: this file can become extremely large (size: Hamiltoniansize * Hamiltoniansize * k-point number * 16).
                </xs:documentation>
              </xs:annotation>
            </xs:attribute>
            <xs:attribute ex:importance="experimental" ex:unit="" name="updateRadial" type="xs:boolean" default="false">
              <xs:annotation>
                <xs:documentation>
                  If set to true, the radial functions will be updated after each hybrid cycle.
                </xs:documentation>
              </xs:annotation>
            </xs:attribute>
          </xs:complexType>
        </xs:element>
        
        <xs:element ex:importance="expert" ex:unit="" name="solver" minOccurs="0" maxOccurs="1">
          <xs:annotation>
            <xs:documentation>Optional configuration options for eigenvector
              solver.</xs:documentation>
          </xs:annotation>
          <xs:complexType>
            <xs:attribute ex:importance="expert" ex:unit="" name="type" default="Lapack">
              <xs:annotation>
                <xs:appinfo>
                  <oldname>solvertype</oldname>
                </xs:appinfo>
                <xs:documentation>Selects the eigenvalue solver for the first variational
                  equation</xs:documentation>
              </xs:annotation>
              <xs:simpleType>
                <xs:restriction base="xs:string">
                  <xs:enumeration value="Lapack">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr>1</oldnr>
                      </xs:appinfo>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="Arpack">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr>2</oldnr>
                      </xs:appinfo>
                    </xs:annotation>
                  </xs:enumeration>
                  <!-- xs:enumeration value="DIIS">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr>3</oldnr>
                      </xs:appinfo>
                    </xs:annotation>
                  </xs:enumeration-->
                </xs:restriction>
              </xs:simpleType>
            </xs:attribute>
            <xs:attribute ex:importance="expert" ex:unit="" name="packedmatrixstorage" type="xs:boolean" use="optional" default="false">
              <xs:annotation>
                <xs:documentation> In the default calculation the matrix is sored in packed form.
                  When using multi-threaded BLAS setting this parameter to <pre>"false"</pre>
                  increases efficiency. </xs:documentation>
              </xs:annotation>
            </xs:attribute>
            <xs:attribute ex:importance="expert" ex:unit="" name="epsarpack" type="fortrandouble" default="1.0d-14">
              <xs:annotation>
                <xs:documentation>Tolerance parameter for the ARPACK shift invert
                  solver</xs:documentation>
              </xs:annotation>
            </xs:attribute>
            <xs:attribute ex:importance="expert" ex:unit="" name="ArpackLinSolve" default="LDL">
              <xs:annotation>
                <xs:documentation> 
                    Linear solve method during shift-and-invert process in ARPACK.
                    Pick either LDL, LU, LL, Diag and InvertOnce.
                </xs:documentation>
              </xs:annotation>
              <xs:simpleType>
                <xs:restriction base="xs:string">
                  <xs:enumeration value="LDL"/>
                  <xs:enumeration value="LL"/>
                  <xs:enumeration value="LU"/>
                  <xs:enumeration value="Diag"/>
                  <xs:enumeration value="InvertOnce"/>
                </xs:restriction>
              </xs:simpleType>
            </xs:attribute>

            <xs:attribute ex:importance="expert" ex:unit="" name="DecompPrec" default="dp">
              <xs:annotation>
                <xs:documentation>
                   Precision used during the factorization in ARPACK.
                   Pick either sp or dp.
                </xs:documentation>
              </xs:annotation>
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:enumeration value="sp"/>
                    <xs:enumeration value="dp"/>
                  </xs:restriction>
                </xs:simpleType>
            </xs:attribute>

            <xs:attribute ex:importance="expert" ex:unit="" name="ArpackImproveInverse" type="xs:boolean" default="false">
              <xs:annotation>
                <xs:documentation>
                  Tells whether iterative improvement should be applied during the shift-and-invert procedure.
                  Setting to true may be useful, for instance, when DecompPrec is set to "sp".
                </xs:documentation>
              </xs:annotation>
            </xs:attribute>


            <xs:attribute ex:importance="expert" ex:unit="Hartree" name="evaltol" type="fortrandouble" default="1.0d-14">
              <xs:annotation>
                <xs:documentation>Error tolerance for the first-variational eigenvalues using the
                  LAPACK Solver</xs:documentation>
              </xs:annotation>
            </xs:attribute>

            <xs:attribute ex:importance="expert" ex:unit="" name="ArpackUserDefinedShift" type="xs:boolean" default="false">
              <xs:annotation>
                <xs:documentation>
                  ArpackShift will be used if this flag is set to true, otherwise the energy shift will be determined internally.
                </xs:documentation>
              </xs:annotation>
            </xs:attribute>

            <xs:attribute ex:importance="expert" ex:unit="Hartree" name="ArpackShift" type="fortrandouble" default="-1.0d0">
              <xs:annotation>
                <xs:documentation>
                  Energy shift in the shift-and-invert procedure in the ARPACK solver. 
                </xs:documentation>
              </xs:annotation>
            </xs:attribute>
          </xs:complexType>
        </xs:element>
        <xs:element ex:importance="expert" ex:unit="" name="OEP" minOccurs="0" maxOccurs="1">
          <xs:annotation>
            <!--xs:documentation>If present exact exchange calculation is triggered.
              (experimental)</xs:documentation-->
            <xs:documentation>Necessary, if exact exchange calculation is to be performed.
              </xs:documentation>
          </xs:annotation>
          <xs:complexType>
            <xs:attribute ex:importance="expert" ex:unit="" name="maxitoep" type="xs:integer" default="300">
              <xs:annotation>
                <xs:documentation>Maximum number of iterations when solving the exact exchange
                  integral equations.</xs:documentation>
              </xs:annotation>
            </xs:attribute>
            <xs:attribute ex:importance="expert" ex:unit="" name="tauoep" type="vect3d" default="1.0d0 0.2d0 1.5d0">
              <xs:annotation>
                <xs:documentation> The optimised effective potential is determined using an
                  iterative method. <it>Phys. Rev. Lett.</it>
                <bf>98</bf>, 196405 (2007). At the first iteration
                  the step length is set to tauoep(1). During subsequent iterations, the step
                  length is scaled by tauoep(2) or tauoep(3), when the residual is increasing or
                  decreasing, respectively. See also <attref>maxitoep</attref>. </xs:documentation>
              </xs:annotation>
            </xs:attribute>
            <xs:attribute ex:importance="expert" ex:unit="" name="convoep" type="fortrandouble" default="1e-11">
              <xs:annotation>
                <xs:documentation>Convergence tolerance for OEP residue when solving the exact exchange
                  integral equations.</xs:documentation>
              </xs:annotation>
            </xs:attribute>
          </xs:complexType>
        </xs:element>
        <xs:element ex:importance="experimental" ex:unit="" name="RDMFT" minOccurs="0" maxOccurs="1">
          <xs:annotation>
            <xs:documentation>If present Reduced Density Matrix Funcional Theory calculation is
              triggered</xs:documentation>
          </xs:annotation>
          <xs:complexType>
            <xs:attribute ex:importance="expert" ex:unit="" name="rdmxctype" type="xs:integer" default="2">
              <xs:annotation>
                <xs:documentation>XC functional.</xs:documentation>
              </xs:annotation>
            </xs:attribute>
            <xs:attribute ex:importance="expert" ex:unit="" name="rdmmaxscl" type="xs:integer" default="1">
              <xs:annotation>
                <xs:documentation>maximum number of self-consistent loops.</xs:documentation>
              </xs:annotation>
            </xs:attribute>
            <xs:attribute ex:importance="expert" ex:unit="" name="maxitn" type="xs:integer" default="250">
              <xs:annotation>
                <xs:documentation>maximum number of iteration for occupation number
                  optimization.</xs:documentation>
              </xs:annotation>
            </xs:attribute>
            <xs:attribute ex:importance="expert" ex:unit="" name="maxitc" type="xs:integer" default="10">
              <xs:annotation>
                <xs:documentation>maximum number of iteration for natural orbital
                  optimization.</xs:documentation>
              </xs:annotation>
            </xs:attribute>
            <xs:attribute ex:importance="expert" ex:unit="" name="taurdmn" type="fortrandouble" default="1.0d0">
              <xs:annotation>
                <xs:documentation>step size for occupation numbers.</xs:documentation>
              </xs:annotation>
            </xs:attribute>
            <xs:attribute ex:importance="expert" ex:unit="" name="taurdmc" type="fortrandouble" default="0.5d0">
              <xs:annotation>
                <xs:documentation>Step size for natural orbital coefficients.</xs:documentation>
              </xs:annotation>
            </xs:attribute>
            <xs:attribute ex:importance="expert" ex:unit="" name="rdmalpha" type="fortrandouble" default="0.7d0">
              <xs:annotation>
                <xs:documentation>exponent for the functional.</xs:documentation>
              </xs:annotation>
            </xs:attribute>
            <xs:attribute ex:importance="expert" ex:unit="" name="rdmtemp" type="fortrandouble" default="0.0d0">
              <xs:annotation>
                <xs:documentation>temperature.</xs:documentation>
              </xs:annotation>
            </xs:attribute>
          </xs:complexType>
        </xs:element>
        <xs:element ex:importance="expert" ex:unit="" name="output" minOccurs="0" maxOccurs="1">
          <xs:annotation>
            <xs:documentation>Specifications on the file formats for output
              files.</xs:documentation>
          </xs:annotation>
          <xs:complexType>
            <xs:attribute ex:importance="expert" ex:unit="" name="state" default="binary">
              <xs:annotation>
                <xs:documentation>Selects the file format of the STATE file.</xs:documentation>
              </xs:annotation>
              <xs:simpleType>
                <xs:restriction base="xs:string">
                  <xs:enumeration value="binary"/>
                  <xs:enumeration value="XML"/>
                </xs:restriction>
              </xs:simpleType>
            </xs:attribute>
          </xs:complexType>
        </xs:element>
        <xs:element maxOccurs="1" minOccurs="0" name="libxc">
          <xs:complexType>
            <xs:attribute default="XC_GGA_X_PBE" name="exchange" use="optional">
              <xs:simpleType>
                <xs:restriction base="xs:string">
                  <xs:enumeration value="none">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 0 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> No exchange </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_LDA_X">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 1 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> Exchange in 3D </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_LDA_X_2D">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 19 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> Exchange in 2D </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_LDA_X_1D">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 21 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> Exchange in 1D </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_X_SSB_SW">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 90 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> Swarta, Sola and Bickelhaupt correction to PBE </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_X_SSB">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 91 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> Swarta, Sola and Bickelhaupt </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_X_SSB_D">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 92 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> Swarta, Sola and Bickelhaupt dispersion </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_X_BPCCAC">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 98 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> BPCCAC (GRAC for the energy) </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_X_PBE">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 101 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> Perdew, Burke &amp; Ernzerhof exchange </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_X_PBE_R">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 102 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> Perdew, Burke &amp; Ernzerhof exchange (revised) </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_X_B86">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 103 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> Becke 86 Xalfa,beta,gamma </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_X_HERMAN">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 104 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> Herman et al original GGA </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_X_B86_MGC">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 105 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> Becke 86 Xalfa,beta,gamma (with mod. grad. correction) </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_X_B88">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 106 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> Becke 88 </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_X_G96">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 107 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> Gill 96 </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_X_PW86">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 108 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> Perdew &amp; Wang 86 </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_X_PW91">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 109 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> Perdew &amp; Wang 91 </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_X_OPTX">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 110 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> Handy &amp; Cohen OPTX 01 </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_X_DK87_R1">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 111 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> dePristo &amp; Kress 87 (version R1) </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_X_DK87_R2">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 112 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> dePristo &amp; Kress 87 (version R2) </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_X_LG93">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 113 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> Lacks &amp; Gordon 93 </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_X_FT97_A">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 114 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> Filatov &amp; Thiel 97 (version A) </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_X_FT97_B">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 115 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> Filatov &amp; Thiel 97 (version B) </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_X_PBE_SOL">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 116 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> Perdew, Burke &amp; Ernzerhof exchange (solids) </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_X_RPBE">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 117 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> Hammer, Hansen &amp; Norskov (PBE-like) </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_X_WC">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 118 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> Wu &amp; Cohen </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_X_MPW91">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 119 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> Modified form of PW91 by Adamo &amp; Barone </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_X_AM05">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 120 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> Armiento &amp; Mattsson 05 exchange </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_X_PBEA">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 121 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> Madsen (PBE-like) </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_X_MPBE">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 122 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> Adamo &amp; Barone modification to PBE </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_X_XPBE">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 123 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> xPBE reparametrization by Xu &amp; Goddard </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_X_2D_B86_MGC">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 124 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> Becke 86 MGC for 2D systems </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_X_BAYESIAN">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 125 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> Bayesian best fit for the enhancement factor </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_X_PBE_JSJR">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 126 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> JSJR reparametrization by Pedroza, Silva &amp; Capelle </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_X_2D_B88">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 127 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> Becke 88 in 2D </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_X_2D_B86">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 128 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> Becke 86 Xalfa,beta,gamma </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_X_2D_PBE">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 129 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> Perdew, Burke &amp; Ernzerhof exchange in 2D </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_X_OPTB88_VDW">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 139 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> Becke 88 reoptimized to be used with vdW functional of Dion et </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_X_PBEK1_VDW">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 140 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> PBE reparametrization for vdW </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_X_OPTPBE_VDW">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 141 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> PBE reparametrization for vdW </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_X_RGE2">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 142 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> Regularized PBE </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_X_RPW86">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 144 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> refitted Perdew &amp; Wang 86 </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_X_KT1">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 145 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> Keal and Tozer version 1 </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_X_MB88">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 149 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> Modified Becke 88 for proton transfer </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_X_SOGGA">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 150 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> Second-order generalized gradient approximation </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_X_SOGGA11">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 151 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> Second-order generalized gradient approximation 2011 </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_X_C09X">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 158 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> C09x to be used with the VdW of Rutgers-Chalmers </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_X_LB">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 160 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> van Leeuwen &amp; Baerends </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_X_LBM">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 182 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> van Leeuwen &amp; Baerends modified </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_X_OL2">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 183 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> Exchange form based on Ou-Yang and Levy v.2 </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_X_APBE">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 184 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> mu fixed from the semiclassical neutral atom </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_X_HTBS">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 191 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> Haas, Tran, Blaha, and Schwarz </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_X_AIRY">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 192 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> Constantin et al based on the Airy gas </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_X_LAG">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 193 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> Local Airy Gas </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
		  <!-- Range seperated / screened functionals currently not implemented-->
                  <!--xs:enumeration value="XC_GGA_X_WPBEH">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 524 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> short-range version of the PBE </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_X_HJS_PBE">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 525 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> HJS screened exchange PBE version </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_X_HJS_PBE_SOL">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 526 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> HJS screened exchange PBE_SOL version </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_X_HJS_B88">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 527 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> HJS screened exchange B88 version </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_X_HJS_B97X">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 528 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> HJS screened exchange B97x version </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_X_ITYH">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 529 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> short-range recipe for exchange GGA functionals </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration-->
                  <!--xs:enumeration value="XC_HYB_GGA_X_SOGGA11_X">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 426 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> Hybrid based on SOGGA11 form </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration-->
                </xs:restriction>
              </xs:simpleType>
            </xs:attribute>
            <xs:attribute default="XC_GGA_C_PBE" name="correlation" use="optional">
              <xs:simpleType>
                <xs:restriction base="xs:string">
                   <xs:enumeration value="none">
                     <xs:annotation>
                       <xs:appinfo>
                         <oldnr> 0 </oldnr>
                       </xs:appinfo>
                       <xs:documentation> No correlations </xs:documentation>
                    </xs:annotation>
                   </xs:enumeration>
                   <xs:enumeration value="XC_LDA_C_WIGNER">
                     <xs:annotation>
                       <xs:appinfo>
                         <oldnr> 2 </oldnr>
                       </xs:appinfo>
                       <xs:documentation> Wigner parametrization </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                   <xs:enumeration value="XC_LDA_C_RPA">
                     <xs:annotation>
                       <xs:appinfo>
                         <oldnr> 3 </oldnr>
                       </xs:appinfo>
                       <xs:documentation> Random Phase Approximation </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                   <xs:enumeration value="XC_LDA_C_HL">
                     <xs:annotation>
                       <xs:appinfo>
                         <oldnr> 4 </oldnr>
                       </xs:appinfo>
                       <xs:documentation> Hedin &amp; Lundqvist </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                   <xs:enumeration value="XC_LDA_C_GL">
                     <xs:annotation>
                       <xs:appinfo>
                         <oldnr> 5 </oldnr>
                       </xs:appinfo>
                       <xs:documentation> Gunnarson &amp; Lundqvist </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                   <xs:enumeration value="XC_LDA_C_XALPHA">
                     <xs:annotation>
                       <xs:appinfo>
                         <oldnr> 6 </oldnr>
                       </xs:appinfo>
                       <xs:documentation> Slater Xalpha </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                   <xs:enumeration value="XC_LDA_C_VWN">
                     <xs:annotation>
                       <xs:appinfo>
                         <oldnr> 7 </oldnr>
                       </xs:appinfo>
                       <xs:documentation> Vosko, Wilk, &amp; Nussair (5) </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                   <xs:enumeration value="XC_LDA_C_VWN_RPA">
                     <xs:annotation>
                       <xs:appinfo>
                         <oldnr> 8 </oldnr>
                       </xs:appinfo>
                       <xs:documentation> Vosko, Wilk, &amp; Nussair (RPA) </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                   <xs:enumeration value="XC_LDA_C_PZ">
                     <xs:annotation>
                       <xs:appinfo>
                         <oldnr> 9 </oldnr>
                       </xs:appinfo>
                       <xs:documentation> Perdew &amp; Zunger </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                   <xs:enumeration value="XC_LDA_C_PZ_MOD">
                     <xs:annotation>
                       <xs:appinfo>
                         <oldnr> 10 </oldnr>
                       </xs:appinfo>
                       <xs:documentation> Perdew &amp; Zunger (Modified) </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                   <xs:enumeration value="XC_LDA_C_OB_PZ">
                     <xs:annotation>
                       <xs:appinfo>
                         <oldnr> 11 </oldnr>
                       </xs:appinfo>
                       <xs:documentation> Ortiz &amp; Ballone (PZ) </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                   <xs:enumeration value="XC_LDA_C_PW">
                     <xs:annotation>
                       <xs:appinfo>
                         <oldnr> 12 </oldnr>
                       </xs:appinfo>
                       <xs:documentation> Perdew &amp; Wang </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                   <xs:enumeration value="XC_LDA_C_PW_MOD">
                     <xs:annotation>
                       <xs:appinfo>
                         <oldnr> 13 </oldnr>
                       </xs:appinfo>
                       <xs:documentation> Perdew &amp; Wang (Modified) </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                   <xs:enumeration value="XC_LDA_C_OB_PW">
                     <xs:annotation>
                       <xs:appinfo>
                         <oldnr> 14 </oldnr>
                       </xs:appinfo>
                       <xs:documentation> Ortiz &amp; Ballone (PW) </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                   <xs:enumeration value="XC_LDA_C_2D_AMGB">
                     <xs:annotation>
                       <xs:appinfo>
                         <oldnr> 15 </oldnr>
                       </xs:appinfo>
                       <xs:documentation> Attacalite et al </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                   <xs:enumeration value="XC_LDA_C_2D_PRM">
                     <xs:annotation>
                       <xs:appinfo>
                         <oldnr> 16 </oldnr>
                       </xs:appinfo>
                       <xs:documentation> Pittalis, Rasanen &amp; Marques correlation in 2D </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                   <xs:enumeration value="XC_LDA_C_vBH">
                     <xs:annotation>
                       <xs:appinfo>
                         <oldnr> 17 </oldnr>
                       </xs:appinfo>
                       <xs:documentation> von Barth &amp; Hedin </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                   <xs:enumeration value="XC_LDA_C_1D_CSC">
                     <xs:annotation>
                       <xs:appinfo>
                         <oldnr> 18 </oldnr>
                       </xs:appinfo>
                       <xs:documentation> Casula, Sorella, and Senatore 1D correlation </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                   <xs:enumeration value="XC_LDA_C_ML1">
                     <xs:annotation>
                       <xs:appinfo>
                         <oldnr> 22 </oldnr>
                       </xs:appinfo>
                       <xs:documentation> Modified LSD (version 1) of Proynov and Salahub </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                   <xs:enumeration value="XC_LDA_C_ML2">
                     <xs:annotation>
                       <xs:appinfo>
                         <oldnr> 23 </oldnr>
                       </xs:appinfo>
                       <xs:documentation> Modified LSD (version 2) of Proynov and Salahub </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                   <xs:enumeration value="XC_LDA_C_GOMBAS">
                     <xs:annotation>
                       <xs:appinfo>
                         <oldnr> 24 </oldnr>
                       </xs:appinfo>
                       <xs:documentation> Gombas parametrization </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                   <xs:enumeration value="XC_LDA_C_PW_RPA">
                     <xs:annotation>
                       <xs:appinfo>
                         <oldnr> 25 </oldnr>
                       </xs:appinfo>
                       <xs:documentation> Perdew &amp; Wang fit of the RPA </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                   <xs:enumeration value="XC_LDA_C_1D_LOOS">
                     <xs:annotation>
                       <xs:appinfo>
                         <oldnr> 26 </oldnr>
                       </xs:appinfo>
                       <xs:documentation> P-F Loos correlation LDA </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                   <xs:enumeration value="XC_LDA_C_RC04">
                     <xs:annotation>
                       <xs:appinfo>
                         <oldnr> 27 </oldnr>
                       </xs:appinfo>
                       <xs:documentation> Ragot-Cortona </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                   <xs:enumeration value="XC_LDA_C_VWN_1">
                     <xs:annotation>
                       <xs:appinfo>
                         <oldnr> 28 </oldnr>
                       </xs:appinfo>
                       <xs:documentation> Vosko, Wilk, &amp; Nussair (1) </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                   <xs:enumeration value="XC_LDA_C_VWN_2">
                     <xs:annotation>
                       <xs:appinfo>
                         <oldnr> 29 </oldnr>
                       </xs:appinfo>
                       <xs:documentation> Vosko, Wilk, &amp; Nussair (2) </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                   <xs:enumeration value="XC_LDA_C_VWN_3">
                     <xs:annotation>
                       <xs:appinfo>
                         <oldnr> 30 </oldnr>
                       </xs:appinfo>
                       <xs:documentation> Vosko, Wilk, &amp; Nussair (3) </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                   <xs:enumeration value="XC_LDA_C_VWN_4">
                     <xs:annotation>
                       <xs:appinfo>
                         <oldnr> 31 </oldnr>
                       </xs:appinfo>
                       <xs:documentation> Vosko, Wilk, &amp; Nussair (4) </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                   <xs:enumeration value="XC_GGA_C_OP_XALPHA">
                     <xs:annotation>
                       <xs:appinfo>
                         <oldnr> 84 </oldnr>
                       </xs:appinfo>
                       <xs:documentation> one-parameter progressive functional (G96 version) </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                   <xs:enumeration value="XC_GGA_C_OP_G96">
                     <xs:annotation>
                       <xs:appinfo>
                         <oldnr> 85 </oldnr>
                       </xs:appinfo>
                       <xs:documentation> one-parameter progressive functional (G96 version) </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                   <xs:enumeration value="XC_GGA_C_OP_PBE">
                     <xs:annotation>
                       <xs:appinfo>
                         <oldnr> 86 </oldnr>
                       </xs:appinfo>
                       <xs:documentation> one-parameter progressive functional (PBE version) </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                   <xs:enumeration value="XC_GGA_C_OP_B88">
                     <xs:annotation>
                       <xs:appinfo>
                         <oldnr> 87 </oldnr>
                       </xs:appinfo>
                       <xs:documentation> one-parameter progressive functional (B88 version) </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                   <xs:enumeration value="XC_GGA_C_FT97">
                     <xs:annotation>
                       <xs:appinfo>
                         <oldnr> 88 </oldnr>
                       </xs:appinfo>
                       <xs:documentation> Filatov &amp; Thiel correlation </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                   <xs:enumeration value="XC_GGA_C_SPBE">
                     <xs:annotation>
                       <xs:appinfo>
                         <oldnr> 89 </oldnr>
                       </xs:appinfo>
                       <xs:documentation> PBE correlation to be used with the SSB exchange </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                   <xs:enumeration value="XC_GGA_C_REVTCA">
                     <xs:annotation>
                       <xs:appinfo>
                         <oldnr> 99 </oldnr>
                       </xs:appinfo>
                       <xs:documentation> Tognetti, Cortona, Adamo (revised) </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                   <xs:enumeration value="XC_GGA_C_TCA">
                     <xs:annotation>
                       <xs:appinfo>
                         <oldnr> 100 </oldnr>
                       </xs:appinfo>
                       <xs:documentation> Tognetti, Cortona, Adamo </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                   <xs:enumeration value="XC_GGA_C_PBE">
                     <xs:annotation>
                       <xs:appinfo>
                         <oldnr> 130 </oldnr>
                       </xs:appinfo>
                       <xs:documentation> Perdew, Burke &amp; Ernzerhof correlation </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                   <xs:enumeration value="XC_GGA_C_LYP">
                     <xs:annotation>
                       <xs:appinfo>
                         <oldnr> 131 </oldnr>
                       </xs:appinfo>
                       <xs:documentation> Lee, Yang &amp; Parr </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                   <xs:enumeration value="XC_GGA_C_P86">
                     <xs:annotation>
                       <xs:appinfo>
                         <oldnr> 132 </oldnr>
                       </xs:appinfo>
                       <xs:documentation> Perdew 86 </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                   <xs:enumeration value="XC_GGA_C_PBE_SOL">
                     <xs:annotation>
                       <xs:appinfo>
                         <oldnr> 133 </oldnr>
                       </xs:appinfo>
                       <xs:documentation> Perdew, Burke &amp; Ernzerhof correlation SOL </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                   <xs:enumeration value="XC_GGA_C_PW91">
                     <xs:annotation>
                       <xs:appinfo>
                         <oldnr> 134 </oldnr>
                       </xs:appinfo>
                       <xs:documentation> Perdew &amp; Wang 91 </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                   <xs:enumeration value="XC_GGA_C_AM05">
                     <xs:annotation>
                       <xs:appinfo>
                         <oldnr> 135 </oldnr>
                       </xs:appinfo>
                       <xs:documentation> Armiento &amp; Mattsson 05 correlation </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                   <xs:enumeration value="XC_GGA_C_XPBE">
                     <xs:annotation>
                       <xs:appinfo>
                         <oldnr> 136 </oldnr>
                       </xs:appinfo>
                       <xs:documentation> xPBE reparametrization by Xu &amp; Goddard </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                   <xs:enumeration value="XC_GGA_C_LM">
                     <xs:annotation>
                       <xs:appinfo>
                         <oldnr> 137 </oldnr>
                       </xs:appinfo>
                       <xs:documentation> Langreth and Mehl correlation </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                   <xs:enumeration value="XC_GGA_C_PBE_JRGX">
                     <xs:annotation>
                       <xs:appinfo>
                         <oldnr> 138 </oldnr>
                       </xs:appinfo>
                       <xs:documentation> JRGX reparametrization by Pedroza, Silva &amp; Capelle </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                   <xs:enumeration value="XC_GGA_C_RGE2">
                     <xs:annotation>
                       <xs:appinfo>
                         <oldnr> 143 </oldnr>
                       </xs:appinfo>
                       <xs:documentation> Regularized PBE </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                   <xs:enumeration value="XC_GGA_C_WL">
                     <xs:annotation>
                       <xs:appinfo>
                         <oldnr> 147 </oldnr>
                       </xs:appinfo>
                       <xs:documentation> Wilson &amp; Levy </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                   <xs:enumeration value="XC_GGA_C_WI">
                     <xs:annotation>
                       <xs:appinfo>
                         <oldnr> 148 </oldnr>
                       </xs:appinfo>
                       <xs:documentation> Wilson &amp; Ivanov </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                   <xs:enumeration value="XC_GGA_C_SOGGA11">
                     <xs:annotation>
                       <xs:appinfo>
                         <oldnr> 152 </oldnr>
                       </xs:appinfo>
                       <xs:documentation> Second-order generalized gradient approximation 2011 </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                   <xs:enumeration value="XC_GGA_C_WI0">
                     <xs:annotation>
                       <xs:appinfo>
                         <oldnr> 153 </oldnr>
                       </xs:appinfo>
                       <xs:documentation> Wilson &amp; Ivanov initial version </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                   <xs:enumeration value="XC_GGA_C_SOGGA11_X">
                     <xs:annotation>
                       <xs:appinfo>
                         <oldnr> 159 </oldnr>
                       </xs:appinfo>
                       <xs:documentation> To be used with hyb_gga_x_SOGGA11-X </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                   <xs:enumeration value="XC_GGA_C_APBE">
                     <xs:annotation>
                       <xs:appinfo>
                         <oldnr> 186 </oldnr>
                       </xs:appinfo>
                       <xs:documentation> mu fixed from the semiclassical neutral atom </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                   <xs:enumeration value="XC_GGA_C_OPTC">
                     <xs:annotation>
                       <xs:appinfo>
                         <oldnr> 200 </oldnr>
                       </xs:appinfo>
                       <xs:documentation> Optimized correlation functional of Cohen and Handy </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                </xs:restriction>
              </xs:simpleType>
            </xs:attribute>
            <xs:attribute default="none" name="xc" use="optional">
              <xs:annotation>
                <xs:documentation> Combined functionals. If set it overrides the exchange and the
                  correlation attributes.</xs:documentation>
              </xs:annotation>
              <xs:simpleType>
                <xs:restriction base="xs:string">
                  <xs:enumeration value="none">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr>0</oldnr>
                      </xs:appinfo>
                    </xs:annotation>
                   </xs:enumeration>
                  <xs:enumeration value="XC_LDA_XC_TETER93">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 20 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> Teter 93 parametrization </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_XC_HCTH_407P">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 93 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> HCTH/407+ </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_XC_HCTH_P76">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 94 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> HCTH p=7/6 </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_XC_HCTH_P14">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 95 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> HCTH p=1/4 </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_XC_B97_GGA1">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 96 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> Becke 97 GGA-1 </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_XC_HCTH_A">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 97 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> HCTH-A </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_XC_KT2">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 146 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> Keal and Tozer version 2 </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_XC_TH1">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 154 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> Tozer and Handy v. 1 </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_XC_TH2">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 155 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> Tozer and Handy v. 2 </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_XC_TH3">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 156 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> Tozer and Handy v. 3 </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_XC_TH4">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 157 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> Tozer and Handy v. 4 </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_XC_HCTH_93">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 161 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> HCTH functional fitted to 93 molecules </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_XC_HCTH_120">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 162 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> HCTH functional fitted to 120 molecules </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_XC_HCTH_147">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 163 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> HCTH functional fitted to 147 molecules </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_XC_HCTH_407">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 164 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> HCTH functional fitted to 407 molecules </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_XC_EDF1">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 165 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> Empirical functionals from Adamson, Gill, and Pople </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_XC_XLYP">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 166 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> XLYP functional </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_XC_B97">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 167 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> Becke 97 </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_XC_B97_1">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 168 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> Becke 97-1 </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_XC_B97_2">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 169 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> Becke 97-2 </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_XC_B97_D">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 170 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> Grimme functional to be used with C6 vdW term </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_XC_B97_K">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 171 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> Boese-Martin for Kinetics </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_XC_B97_3">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 172 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> Becke 97-3 </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_XC_PBE1W">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 173 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> Functionals fitted for water </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_XC_MPWLYP1W">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 174 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> Functionals fitted for water </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_XC_PBELYP1W">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 175 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> Functionals fitted for water </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_XC_SB98_1a">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 176 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> Schmider-Becke 98 parameterization 1a </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_XC_SB98_1b">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 177 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> Schmider-Becke 98 parameterization 1b </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_XC_SB98_1c">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 178 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> Schmider-Becke 98 parameterization 1c </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_XC_SB98_2a">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 179 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> Schmider-Becke 98 parameterization 2a </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_XC_SB98_2b">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 180 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> Schmider-Becke 98 parameterization 2b </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_XC_SB98_2c">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 181 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> Schmider-Becke 98 parameterization 2c </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_XC_MOHLYP">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 194 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> Functional for organometallic chemistry </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_XC_MOHLYP2">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 195 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> Functional for barrier heights </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_XC_TH_FL">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 196 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> Tozer and Handy v. FL </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_XC_TH_FC">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 197 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> Tozer and Handy v. FC </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_XC_TH_FCFO">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 198 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> Tozer and Handy v. FCFO </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_GGA_XC_TH_FCO">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 199 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> Tozer and Handy v. FCO </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_HYB_GGA_XC_B3PW91">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 401 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> The original (ACM) hybrid of Becke </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_HYB_GGA_XC_B3LYP">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 402 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> The (in)famous B3LYP </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_HYB_GGA_XC_B3P86">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 403 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> Perdew 86 hybrid similar to B3PW91 </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_HYB_GGA_XC_O3LYP">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 404 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> hybrid using the optx functional </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_HYB_GGA_XC_mPW1K">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 405 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> mixture of mPW91 and PW91 optimized for kinetics </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_HYB_GGA_XC_PBEH">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 406 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> aka PBE0 or PBE1PBE </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_HYB_GGA_XC_B97">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 407 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> Becke 97 </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_HYB_GGA_XC_B97_1">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 408 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> Becke 97-1 </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_HYB_GGA_XC_B97_2">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 410 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> Becke 97-2 </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_HYB_GGA_XC_X3LYP">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 411 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> maybe the best hybrid </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_HYB_GGA_XC_B1WC">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 412 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> Becke 1-parameter mixture of WC and PBE </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_HYB_GGA_XC_B97_K">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 413 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> Boese-Martin for Kinetics </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_HYB_GGA_XC_B97_3">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 414 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> Becke 97-3 </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_HYB_GGA_XC_MPW3PW">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 415 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> mixture with the mPW functional </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_HYB_GGA_XC_B1LYP">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 416 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> Becke 1-parameter mixture of B88 and LYP </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_HYB_GGA_XC_B1PW91">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 417 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> Becke 1-parameter mixture of B88 and PW91 </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_HYB_GGA_XC_mPW1PW">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 418 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> Becke 1-parameter mixture of mPW91 and PW91 </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_HYB_GGA_XC_MPW3LYP">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 419 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> mixture of mPW and LYP </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_HYB_GGA_XC_SB98_1a">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 420 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> Schmider-Becke 98 parameterization 1a </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_HYB_GGA_XC_SB98_1b">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 421 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> Schmider-Becke 98 parameterization 1b </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_HYB_GGA_XC_SB98_1c">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 422 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> Schmider-Becke 98 parameterization 1c </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_HYB_GGA_XC_SB98_2a">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 423 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> Schmider-Becke 98 parameterization 2a </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_HYB_GGA_XC_SB98_2b">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 424 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> Schmider-Becke 98 parameterization 2b </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_HYB_GGA_XC_SB98_2c">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 425 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> Schmider-Becke 98 parameterization 2c </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
		  <!-- Range seperated / screened functionals currently not implemented-->
                  <!--xs:enumeration value="XC_HYB_GGA_XC_HSE03">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 427 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> the 2003 version of the screened hybrid HSE </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_HYB_GGA_XC_HSE06">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 428 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> the 2006 version of the screened hybrid HSE </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_HYB_GGA_XC_HJS_PBE">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 429 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> HJS hybrid screened exchange PBE version </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_HYB_GGA_XC_HJS_PBE_SOL">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 430 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> HJS hybrid screened exchange PBE_SOL version </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_HYB_GGA_XC_HJS_B88">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 431 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> HJS hybrid screened exchange B88 version </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_HYB_GGA_XC_HJS_B97X">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 432 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> HJS hybrid screened exchange B97x version </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_HYB_GGA_XC_CAM_B3LYP">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 433 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> CAM version of B3LYP </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_HYB_GGA_XC_TUNED_CAM_B3LYP">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 434 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> CAM version of B3LYP tunes for excitations </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration-->
                  <xs:enumeration value="XC_HYB_GGA_XC_BHANDH">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 435 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> Becke half-and-half </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_HYB_GGA_XC_BHANDHLYP">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 436 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> Becke half-and-half with B88 exchange </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="XC_HYB_GGA_XC_MB3LYP_RC04">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr> 437 </oldnr>
                      </xs:appinfo>
                      <xs:documentation> B3LYP with RC04 LDA </xs:documentation>
                    </xs:annotation>
                  </xs:enumeration>
                </xs:restriction>
              </xs:simpleType>
            </xs:attribute>
          </xs:complexType>
        </xs:element>

        <xs:element ex:importance="experimental" ex:unit="" name="xsLO" minOccurs="0" maxOccurs="1">
          <xs:annotation><xs:documentation>
            Generate extra local orbitals for accurate description of the unoccupied states.
          </xs:documentation></xs:annotation>                 
          <xs:complexType>
            <xs:attribute ex:importance="expert" ex:unit="Hartree" name="emax" type="fortrandouble" default="30">
              <xs:annotation><xs:documentation>
                Energy cutoff for generating excited-states local orbitals.
              </xs:documentation></xs:annotation>
            </xs:attribute>
            <xs:attribute ex:importance="expert" ex:unit="" name="lmax" type="xs:integer" default="4">
              <xs:annotation><xs:documentation>
                Angular momentum cutoff for generating excited-states local orbitals.
              </xs:documentation></xs:annotation>
            </xs:attribute>
            <xs:attribute ex:importance="expert" ex:unit="" name="maxnodes" type="xs:integer" default="10">
              <xs:annotation><xs:documentation>
                Maximum number of local orbitals per l-channel.
              </xs:documentation></xs:annotation>
            </xs:attribute>
            
          </xs:complexType>
        </xs:element>

      </xs:all>

      <xs:attribute ex:importance="expert" ex:unit="" name="vdWcorrection" default="none">
	<xs:annotation>		
	  <xs:documentation>
	    Adds dispersion (van-der-Waals) correction to total energy after the last SCF iteration. If forces are calculated, an appropriate dispersion correction is applied. Available methods are
	    <list>
	    <li><pre>"DFTD2"</pre>: This is the <bf>DFT-D2</bf> method by Stefan Grimme which is introduced in <it>Semiempirical GGA-type density functional constructed with a long-range dispersion correction</it>, J. Comput. Chem. <bf>27</bf>, 1787-1799 (2006).</li>
	    <li><pre>"TSvdW"</pre>: This is the <bf>TS-vdW</bf> method by Alexandre Tkatchenko and Matthias Scheffler introduced in <it>Accurate molecular van-der-Waals interactions from ground-state electron density and free-atom reference data</it>, Phys. Rev. Lett. <bf>102</bf>, 073005 (2009).</li>
	  </list>
	  Parameters corresponding to each method can be specified using the subelements <elementref>DFTD2parameters</elementref> and <elementref>TSvdWparameters</elementref> inside the element <elementref>groundstate</elementref>.
	  It is also possible to decouple these van-der-Waals corrections from a complete ground-state calculation. In this case, you can use the subelements <elementref>DFTD2</elementref> and <elementref>TSvdW</elementref> inside the element <elementref>properties</elementref>.
	  </xs:documentation>
	</xs:annotation>
	<xs:simpleType>
	  <xs:restriction base="xs:string">
	    <xs:enumeration value="none"/>
	    <xs:enumeration value="DFTD2"/>
	    <xs:enumeration value="TSvdW"/>
	  </xs:restriction>
	</xs:simpleType>
      </xs:attribute>
      
      <xs:attribute ex:importance="expert" ex:unit="" name="do" default="fromscratch">
        <xs:annotation>
          <xs:appinfo>
            <oldname>nonreplace</oldname>
          </xs:appinfo>
          <xs:documentation> Decides if the ground state is calculated starting from scratch, using
            the densities from file, or if its calculation is skipped and only the associated input parameters are
            read in.</xs:documentation>
        </xs:annotation>
        <xs:simpleType>
          <xs:restriction base="xs:string">
            <xs:enumeration value="fromscratch"/>
            <xs:enumeration value="fromfile"/>
            <xs:enumeration value="skip"/>
          </xs:restriction>
        </xs:simpleType>
      </xs:attribute>
      <xs:attribute ex:importance="essential" ex:unit="" name="ngridk" type="integertriple" use="optional" default="1 1 1">
        <xs:annotation>
          <xs:appinfo>
            <oldname>ngridk</oldname>
          </xs:appinfo>
            <xs:documentation>Number of k grid points along the basis vector
            directions. Alternatively give <attref>autokpt</attref> and <attref>radkpt</attref>,
            or <attref>nktot</attref>. In the latter cases any value given for <attref>ngridk</attref>
            is not used. Notes: Phonon calculations using supercells adjust the k-grid
            according to the supercell size; if the element <elementref>xs</elementref>
            is given, the present attribute is overwritten by the value in <elementref>xs</elementref>
            for xs-related groundstate calculations; the values of the present attribute are also
            relevant for calculations related to the element <elementref>gw</elementref>.  </xs:documentation>
        </xs:annotation>
      </xs:attribute>
      <xs:attribute ex:importance="essential" ex:unit="" name="rgkmax" type="fortrandouble" default="7.0d0">
        <xs:annotation>
          <xs:documentation> The parameter <attref>rgkmax</attref> implicitly determines the number of
            basis functions and is one of the crucial parameters for the accuracy of the
            calculation. It represents the product of two quantities: <inlinemath>R_{MT,\,
              Min}</inlinemath>, the smallest of all muffin-tin radii, and <inlinemath>|{ \bf G}+{
              \bf k}|_{max}</inlinemath>, the maximum length for the <inlinemath>{ \bf G}+{ \bf
              k}</inlinemath>  vectors. Because each <inlinemath>{ \bf G}+{ \bf k}</inlinemath> 
            vector represents one basis function, <attref>rgkmax</attref> gives the number of basis
            functions used for solving the Kohn-Sham equations. Typical values of <attref>rgkmax</attref>
            are between 6 and 9. However, for systems with very short bond-lengths, significantly
            smaller values may be sufficient. This may especially be the case for materials
            containing carbon, where <attref>rgkmax</attref> may be 4.5-5, or hydrogen, where even values
            between 3 and 4 may be sufficient. In any case, a convergence check is indispensible for
            a proper choice of this parameter for your system! </xs:documentation>
        </xs:annotation>
      </xs:attribute>
      <xs:attribute ex:importance="essential" ex:unit="" name="epspot" type="fortrandouble" use="optional" default="1.0d-6">
        <xs:annotation>
          <xs:documentation> If the RMS change in the effective potential and magnetic field is
            smaller than <attref>epspot</attref>, then the self-consistent loop is considered converged
            and exited. For structural optimization runs this results in the forces being
            calculated, the atomic positions updated and the loop restarted. See also
              <attref>maxscl</attref>. </xs:documentation>
        </xs:annotation>
      </xs:attribute>
      <xs:attribute ex:importance="expert" ex:unit="Hartree" name="epsengy" type="fortrandouble" use="optional" default="1.0d-6">
        <xs:annotation>
          <xs:documentation>Energy convergence tolerance.</xs:documentation>
        </xs:annotation>
      </xs:attribute>
      <xs:attribute ex:importance="expert" ex:unit="" name="epsforcescf" type="fortrandouble" use="optional" default="5.0d-5">
        <xs:annotation>
          <xs:documentation>Convergence tolerance for forces (not including IBS contribution) 
	    during the SCF run.</xs:documentation>
        </xs:annotation>
      </xs:attribute>
      

      <xs:attribute ex:importance="essential" ex:unit="Hartree" name="swidth" type="fortrandouble" default="0.001d0">
        <xs:annotation>
          <xs:documentation>Width of the smooth approximation to the Dirac delta function (must be
            greater than zero).</xs:documentation>
          <xs:appinfo>
            <olddefault default="0.01d0"/>
          </xs:appinfo>
        </xs:annotation>
      </xs:attribute>
      <xs:attribute ex:importance="essential" ex:unit="" name="stype" default="Gaussian">
        <xs:annotation>
          <xs:documentation> A smooth approximation to the Dirac delta function is needed to compute
            the occupancies of the Kohn-Sham states. The attribute <attref>swidth</attref> determines the
            width of the approximate delta function. </xs:documentation>
        </xs:annotation>
        <xs:simpleType>
          <xs:restriction base="xs:string">
            <xs:enumeration value="Gaussian">
              <xs:annotation>
                <xs:appinfo>
                  <oldnr>0</oldnr>
                </xs:appinfo>
              </xs:annotation>
            </xs:enumeration>
            <xs:enumeration value="Methfessel-Paxton 1">
              <xs:annotation>
                <xs:appinfo>
                  <oldnr>1</oldnr>
                </xs:appinfo>
              </xs:annotation>
            </xs:enumeration>
            <xs:enumeration value="Methfessel-Paxton 2">
              <xs:annotation>
                <xs:appinfo>
                  <oldnr>2</oldnr>
                </xs:appinfo>
              </xs:annotation>
            </xs:enumeration>
            <xs:enumeration value="Fermi Dirac">
              <xs:annotation>
                <xs:appinfo>
                  <oldnr>3</oldnr>
                </xs:appinfo>
              </xs:annotation>
            </xs:enumeration>
            <xs:enumeration value="Square-wave impulse">
              <xs:annotation>
                <xs:appinfo>
                  <oldnr>4</oldnr>
                </xs:appinfo>
              </xs:annotation>
            </xs:enumeration>
            <xs:enumeration value="libbzint">
              <xs:annotation>
              <xs:appinfo>
                <oldnr>-1</oldnr>
              </xs:appinfo>
              <xs:documentation>
              Extended linear tetrahedron method (LIBBZINT library) 
              is used for k-point generation and integration (experimental option).
              </xs:documentation>
              </xs:annotation>
            </xs:enumeration>
          </xs:restriction>
        </xs:simpleType>
      </xs:attribute>
      <xs:attribute ex:importance="expert" ex:unit="" name="findlinentype" default="Wigner_Seitz">
        <xs:annotation>
          <xs:documentation>Select method to determine the linearisation
            energies.</xs:documentation>
          <xs:appinfo>
            <olddefault default="Wigner_Seitz"/>
          </xs:appinfo>
        </xs:annotation>
        <xs:simpleType>
          <xs:restriction base="xs:string">
            <xs:enumeration value="Wigner_Seitz"/>
            <xs:enumeration value="lcharge"/>
            <xs:enumeration value="logderiv"/>
            <xs:enumeration value="no_search"/>
          </xs:restriction>
        </xs:simpleType>
      </xs:attribute>
      <xs:attribute ex:importance="expert" ex:unit="" name="fermilinengy" type="xs:boolean" default="false">
        <xs:annotation>
          <xs:documentation> If <pre>"true"</pre> the linearization energies marked as non-varying
            are set to the Fermi level plus <attref>dlinengyfermi</attref>. </xs:documentation>
        </xs:annotation>
      </xs:attribute>

      <xs:attribute ex:importance="expert" ex:unit="" name="modifiedsv" type="xs:boolean" default="false">
        <xs:annotation>
          <xs:documentation> If <pre>"true"</pre>, the construction of the second-variational 
            hamiltonian involves wavefunctions in the basis representation and wavefunctions
            are not evaluated explicitly. Otherwise, the usual second-variational procedure 
            is used. The first of the two approaches is generally recommended, but it is not
            implemented for non-collinear and LDA+U calculations.
          </xs:documentation>
        </xs:annotation>
      </xs:attribute>

      <xs:attribute ex:importance="expert" ex:unit="" name="isgkmax" type="xs:integer" default="-1">
        <xs:annotation>
          <xs:documentation>Species for which the muffin-tin radius will be used for calculating
            gkmax.</xs:documentation>
        </xs:annotation>
      </xs:attribute>
      <xs:attribute ex:importance="expert" ex:unit="" name="gmaxvr" type="fortrandouble" default="12.0d0">
        <xs:annotation>
          <xs:documentation>Maximum length of |G| for expanding the interstitial density and
            potential.</xs:documentation>
        </xs:annotation>
      </xs:attribute>
      <xs:attribute ex:importance="expert" ex:unit="" name="nempty" type="xs:integer" default="5">
        <xs:annotation>
          <xs:documentation> Defines the number of eigenstates beyond that required for charge
            neutrality. When running metals it is not known <it>a priori</it> how many states will
            be below the Fermi energy for each <bf>k</bf>-point. Setting <attref>nempty</attref> greater
            than zero allows the additional states to act as a buffer in such cases. Furthermore,
            magnetic calculations use the first-variational eigenstates as a basis for setting up
            the second-variational Hamiltonian, and thus <attref>nempty</attref> will determine the size
            of this basis set. Convergence with respect to this quantity should be checked.
          </xs:documentation>
        </xs:annotation>
      </xs:attribute>
      <xs:attribute ex:importance="expert" ex:unit="" name="nosym" type="xs:boolean" default="false">
        <xs:annotation>
          <xs:documentation> When set to <pre>"true"</pre> no symmetries, apart from the identity,
            are used anywhere in the code. </xs:documentation>
        </xs:annotation>
      </xs:attribute>
      <xs:attribute ex:importance="expert" ex:unit="" ref="symmorph" default="false">
        <xs:annotation>
          <xs:documentation> When set to <pre>"true"</pre> only symmorphic space-group operations
            are to be considered, i.e. only symmetries without non-primitive translations are used
            anywhere in the code. </xs:documentation>
        </xs:annotation>
      </xs:attribute>
      <xs:attribute ex:importance="expert" ex:unit="" name="frozencore" type="xs:boolean" default="false">
        <xs:annotation>
          <xs:documentation> When set to <pre>"true"</pre> the frozen core approximation is applied,
            i.e., the core states are fixed to the atomic states. </xs:documentation>
        </xs:annotation>
      </xs:attribute>
      <xs:attribute ex:importance="expert" ex:unit="" name="autokpt" type="xs:boolean" default="false">
        <xs:annotation>
          <xs:documentation>If  <pre>"true"</pre>, the set of <bf>k</bf>-points is determined
          automatically according to <attref>radkpt</attref>.
          </xs:documentation>
        </xs:annotation>
      </xs:attribute>
      <xs:attribute ex:importance="expert" ex:unit="" name="radkpt" type="fortrandouble" default="40.0d0">
        <xs:annotation>
          <xs:documentation> Used for the automatic determination of the <bf>k</bf>-point mesh. If
            <attref>autokpt</attref> is set to <pre>"true"</pre> then the mesh sizes will be determined by
              <inlinemath>n_i=\lambda/|{ \bf A}_i|+1</inlinemath>. </xs:documentation>
        </xs:annotation>
      </xs:attribute>
      <xs:attribute ex:importance="expert" ex:unit="" name="nktot" type="xs:integer" default="0">
        <xs:annotation>
          <xs:documentation> Used for the automatic determination of the <inlinemath>{\mathbf k}</inlinemath>-point mesh from the total
            number of <bf nospace="true">k</bf>-points. If <attref>nktot</attref> is set, then the mesh
            will be determined in such a way that the number of <bf>k</bf>-points is proportional to
            the length of the reciprocal lattice vector in each direction and that the total number
            of <bf nospace="true">k</bf>-points is less than or equal to <attref>nktot</attref>.
          </xs:documentation>
        </xs:annotation>
      </xs:attribute>
      <xs:attribute ex:importance="essential" ex:unit="" name="reducek" type="xs:boolean" default="true">
        <xs:annotation>
          <xs:documentation> If the attribute <attref>reducek</attref> is <pre>"true"</pre> the
              <inlinemath> \bf{k} </inlinemath>-point set is reduced with the crystal symmetries.
          </xs:documentation>
        </xs:annotation>
      </xs:attribute>
      <xs:attribute ex:importance="expert" ex:unit="" ref="tfibs" default="true">
        <xs:annotation>
          <xs:documentation> Because calculation of the incomplete basis set (IBS) correction to the
            force is fairly time- consuming, it can be switched off by setting tfibs to
            <pre>"false"</pre> This correction can then be included only when necessary, i.e. when
            the atoms are close to equilibrium in a structural relaxation run. </xs:documentation>
        </xs:annotation>
      </xs:attribute>
      <xs:attribute ex:importance="essential" ex:unit="" ref="tforce" default="false">
        <xs:annotation>
          <xs:documentation>Decides if the force should be calculated at the end of the
            self-consistent cycle.</xs:documentation>
        </xs:annotation>
      </xs:attribute>
      <xs:attribute ex:importance="expert" ex:unit="" name="lmaxapw" type="xs:integer" default="8">
        <xs:annotation>
          <xs:documentation>Angular momentum cut-off for the APW functions.</xs:documentation>
          <xs:appinfo>
            <olddefault default="8"/>
          </xs:appinfo>
        </xs:annotation>
      </xs:attribute>
      <xs:attribute ex:importance="essential" ex:unit="" name="maxscl" type="xs:integer" default="200">
        <xs:annotation>
          <xs:documentation>Upper limit for the self-consistency loop.</xs:documentation>
        </xs:annotation>
      </xs:attribute>
      <xs:attribute ex:importance="essential" ex:unit="" name="niterconvcheck" type="xs:integer" default="2">
	<xs:annotation>
	  <xs:documentation>Number of self-consistency iterations over which to test convergence. 
	  For example, if <attref>niterconvcheck</attref>=2, then both the second and third to last
	  iterations are compared to the last one to check convergence. The convergence criteria
	  used are those set up by <attref>scfconv</attref>. 
	  </xs:documentation>
        </xs:annotation>
      </xs:attribute>
      <xs:attribute ex:importance="expert" ex:unit="" name="chgexs" type="fortrandouble" default="0.0d0">
        <xs:annotation>
          <xs:documentation> This controls the amount of charge in the unit cell beyond that
            required to maintain neutrality. It can be set positive or negative depending on
            whether electron or hole doping is required.</xs:documentation>
        </xs:annotation>
      </xs:attribute>
      <xs:attribute ex:importance="expert" ex:unit="Hartree" name="deband" type="fortrandouble" default="0.0025d0">
        <xs:annotation>
          <xs:documentation> Initial band energy step size The initial step length used when
            searching for the band energy, which is used as the APW linearisation energy. This is
            done by first searching upwards in energy until the radial wave-function at the
            muffin-tin radius is zero. This is the energy at the top of the band, denoted
              <inlinemath>E_{\rm t}</inlinemath>. A downward search is now performed from
              <inlinemath>E_{\rm t}</inlinemath> until the slope of the radial wave-function at the
            muffin-tin radius is zero. This energy, <inlinemath>E_{\rm b}</inlinemath>, is at the
            bottom of the band. The band energy is taken as <inlinemath>(E_{\rm t}+E_{\rm
              b})/2</inlinemath>. If either <inlinemath>E_{\rm t}</inlinemath> or <inlinemath>E_{\rm
              b}</inlinemath> cannot be found then the band energy is set to the default value.
          </xs:documentation>
        </xs:annotation>
      </xs:attribute>
      <xs:attribute ex:importance="expert" ex:unit="Hartree" name="epsband" type="fortrandouble" default="1.0d-6">
        <xs:annotation>
          <xs:documentation>Energy tolerance for search of linearisation
            energies.</xs:documentation>
          <xs:appinfo>
            <oldname>none</oldname>
            <olddefault default="1.0d-5"/>
          </xs:appinfo>
        </xs:annotation>
      </xs:attribute>
      <xs:attribute ex:importance="expert" ex:unit="Hartree" name="dlinengyfermi" type="fortrandouble" default="-0.1d0">
        <xs:annotation>
          <xs:documentation>Energy difference between linearisation and Fermi
            energy.</xs:documentation>
        </xs:annotation>
      </xs:attribute>
      <xs:attribute ex:importance="expert" ex:unit="" name="epschg" type="fortrandouble" default="1.0d-5">
        <xs:annotation>
          <xs:documentation>Convergence criterion for the maximum allowed error 
           in the calculated total charge beyond which a warning message will be issued.</xs:documentation>
        </xs:annotation>
      </xs:attribute>
      <xs:attribute ex:importance="expert" ex:unit="" name="epsocc" type="fortrandouble" default="1.0d-8">
        <xs:annotation>
          <xs:documentation>smallest occupancy for which a state will contribute to the
            density.</xs:documentation>
        </xs:annotation>
      </xs:attribute>
      <xs:attribute ex:importance="essential" ex:unit="" name="mixer" default="msec">
        <xs:annotation>
          <xs:documentation>
          Select the mixing (relaxation) scheme for the SCF loop. One has the following options:
         <p/>
        <bf>Linear mixer</bf> (<pre>"lin"</pre>):
        <p/>
   Given the input  <inlinemath>\mu^i</inlinemath> and output   <inlinemath>\nu^i</inlinemath> 
   vectors of the <inlinemath>i</inlinemath>th
  iteration,  the next input vector to the
    (<inlinemath>i+1</inlinemath>)th iteration is generated using an adaptive mixing scheme.
    The <inlinemath>j</inlinemath>th component of the output
   vector is mixed with a fraction of the same component of the input vector:
   <displaymath>\mu^{i+1}_j=\beta^i_j\nu^i_j+(1-\beta^i_j)\mu^i_j, </displaymath>
   where <inlinemath>\beta^i_j</inlinemath> is set to <inlinemath>\beta_0</inlinemath> at initialisation and increased by
   scaling with <inlinemath>\beta_{\rm inc}</inlinemath> (<inlinemath>&gt;1</inlinemath>) if <inlinemath>f^i_j\equiv\nu^i_j-\mu^i_j</inlinemath> does
   not change sign between loops. If <inlinemath>f^i_j</inlinemath> does change sign, then <inlinemath>\beta^i_j</inlinemath>
   is scaled by <inlinemath>\beta_{\rm dec}</inlinemath> (<inlinemath>&gt;1</inlinemath>).
          <p/> 
          <bf>Multisecant Broyden potential mixing</bf> (<pre>"msec"</pre>)
          <p/>
          <bf>Pulay mixing</bf> (<pre>"pulay"</pre>):
          <p/>
          Pulay's mixing scheme which uses direct inversion in the iterative subspace (DIIS). See <it>Chem. Phys. Lett.</it> <bf>73</bf>, 393 (1980).
          </xs:documentation>
          <xs:appinfo>
            <oldname>mixtype</oldname>
            <olddefault default="lin"/>
          </xs:appinfo>
        </xs:annotation>
        <xs:simpleType>
          <xs:restriction base="xs:string">
            <xs:enumeration value="lin">
              <xs:annotation>
                <xs:appinfo>
                  <oldnr>1</oldnr>
                </xs:appinfo>
              </xs:annotation>
            </xs:enumeration>
            <xs:enumeration value="msec">
              <xs:annotation>
                <xs:appinfo>
                  <oldnr>2</oldnr>
                </xs:appinfo>
              </xs:annotation>
            </xs:enumeration>
            <xs:enumeration value="pulay">
              <xs:annotation>
                <xs:appinfo>
                  <oldnr>3</oldnr>
                </xs:appinfo>
              </xs:annotation>
            </xs:enumeration>
          </xs:restriction>
        </xs:simpleType>
      </xs:attribute>
      <xs:attribute ex:importance="expert" ex:unit="" name="mixerswitch" type="xs:integer" default="1">
        <xs:annotation>
          <xs:documentation>Switch between potential (1) and density (2) mixing.</xs:documentation>
        </xs:annotation>
      </xs:attribute>
      <xs:attribute ex:importance="expert" ex:unit="" name="msecStoredSteps" type="xs:integer" default="8">
        <xs:annotation>
          <xs:documentation> How many potentials from previous steps to store. 
           Used in msec mixing as choosen with <attref>mixer</attref>.
          </xs:documentation>
        </xs:annotation>
      </xs:attribute>
      <xs:attribute ex:importance="expert" ex:unit="" name="PrelimLinSteps" type="xs:integer" default="2">
        <xs:annotation>
          <xs:documentation> After which SCF iteration is msec mixing supposed to be turned on.
           Until then linear mixing is applied.
           Used in msec mixing as choosen with <attref>mixer</attref>.
          </xs:documentation>
        </xs:annotation>
      </xs:attribute>
      <xs:attribute ex:importance="expert" ex:unit="" name="beta0" type="fortrandouble" default="0.4d0">
        <xs:annotation>
          <xs:documentation>Initial value for mixing parameter. Used in linear
            mixing as choosen with <attref>mixer</attref>.</xs:documentation>
        </xs:annotation>
      </xs:attribute>
      <xs:attribute ex:importance="expert" ex:unit="" name="betainc" type="fortrandouble" default="1.1d0">
        <xs:annotation>
          <xs:documentation>Mixing parameter increase. Used in linear mixing.</xs:documentation>
        </xs:annotation>
      </xs:attribute>
      <xs:attribute ex:importance="expert" ex:unit="" name="betadec" type="fortrandouble" default="0.6d0">
        <xs:annotation>
          <xs:documentation>Mixing parameter decrease. Used in linear mixing.</xs:documentation>
        </xs:annotation>
      </xs:attribute>
      <xs:attribute ex:importance="expert" ex:unit="" name="lradstep" type="xs:integer" default="1">
        <xs:annotation>
          <xs:documentation> Some muffin-tin functions (such as the density) are calculated on a
            coarse radial mesh and then interpolated onto a fine mesh. This is done for the sake of
            efficiency. lradstp defines the step size in going from the fine to the coarse radial
            mesh. If it is too large, loss of precision may occur.</xs:documentation>
          <xs:appinfo>
            <oldname>lradstp</oldname>
          </xs:appinfo>
        </xs:annotation>
      </xs:attribute>
      <xs:attribute ex:importance="expert" ex:unit="" name="lorecommendation" type="xs:boolean" default="false">
        <xs:annotation>
          <xs:documentation> Local orbitals may be used for improving unoccupied states. But what 
                             energy parameters to use? Set this parameter to true, and you will get
                             a list of energies at which the radial wavefunction turns to zero on the 
                             muffin-tin sphere. These energies are calculated using atomic potential, 
                             and to make them transferable to a general system, use the average of two
                             consecutive atomic energies.
          </xs:documentation>
          <xs:appinfo>
            <oldname>lradstp</oldname>
          </xs:appinfo>
        </xs:annotation>
      </xs:attribute>
      <xs:attribute ex:importance="expert" ex:unit="" name="radialgridtype" type="xs:string" default="cubic">
        <xs:annotation>
          <xs:documentation> The parameter defines a functional form how radial-grid points are distributed.
                             Choose from "cubic", "exponential" and "expocubic". "cubic" is the most suitable
                             one for a majority of calculations, but switch to "expocubic" if you set the 
                             innermost grid point very close to a nucleus.
          </xs:documentation>
        </xs:annotation>
      </xs:attribute>
      <xs:attribute ex:importance="expert" ex:unit="" name="nprad" type="xs:integer" default="4">
        <xs:annotation>
          <xs:documentation>(Obsolete) Order of predictor-corrector polynomial.</xs:documentation>
        </xs:annotation>
      </xs:attribute>
      <xs:attribute ex:importance="essential" ex:unit="" name="xctype" default="GGA_PBE">
        <xs:annotation>
          <xs:documentation> Type of exchange-correlation functional to be used <list>
              <li> No exchange-correlation funtional ( <inlinemath>E_{\rm xc}\equiv 0</inlinemath> ) </li>
              <li> LDA, Perdew-Zunger/Ceperley-Alder, <it>Phys. Rev. B</it>
                <bf>23</bf>, 5048 (1981) </li>
              <li> LSDA, Perdew-Wang/Ceperley-Alder, <it>Phys. Rev. B</it>
                <bf>45</bf>, 13244 (1992) </li>
              <li> LDA, X-alpha approximation, J. C. Slater, <it>Phys. Rev.</it>
                <bf>81</bf>, 385 (1951) </li>
              <li> LSDA, von Barth-Hedin, <it>J. Phys. C</it>
                <bf>5</bf>, 1629 (1972) </li>
              <li> GGA, Perdew-Burke-Ernzerhof (PBE), <it>Phys. Rev. Lett.</it>
                <bf>77</bf>, 3865 (1996) </li>
              <li> GGA, Revised PBE, Zhang-Yang, <it>Phys. Rev. Lett.</it>
                <bf>80</bf>, 890 (1998) </li>
              <li> GGA, PBEsol, arXiv:0707.2088v1 (2007) </li>
              <li> GGA, asymptotically corrected PBE  (acPBE), arXiv:1409.4834 (2014) </li> 
              <li> GGA, Wu-Cohen exchange (WC06) with PBE correlation, <it>Phys. Rev. B</it>
                <bf>73</bf>, 235116 (2006) </li>
              <li> GGA, Armiento-Mattsson (AM05) spin-unpolarised functional, <it>Phys. Rev. B</it>
                <bf>72</bf>, 085108 (2005) </li>
              <li> EXX, Exact Exchange, <it>Phys. Rev. Lett.</it>
                <bf>95</bf>, 136402 (2005) </li>
              <li> Hybrid, PBE0, <it>J. Chem. Phys.</it> <bf>110</bf>, 5029 (1999)</li>
            </list>
          </xs:documentation>
        </xs:annotation>
        <xs:simpleType>
          <xs:restriction base="xs:string">
            <xs:enumeration value="LDA_PZ">
              <xs:annotation>
                <xs:appinfo>
                  <oldnr>2</oldnr>
                </xs:appinfo>
              </xs:annotation>
            </xs:enumeration>
            <xs:enumeration value="LDA_PW">
              <xs:annotation>
                <xs:appinfo>
                  <oldnr>3</oldnr>
                </xs:appinfo>
              </xs:annotation>
            </xs:enumeration>
            <xs:enumeration value="LDA_XALPHA">
              <xs:annotation>
                <xs:appinfo>
                  <oldnr>4</oldnr>
                </xs:appinfo>
              </xs:annotation>
            </xs:enumeration>
            <xs:enumeration value="LDA_vBH">
              <xs:annotation>
                <xs:appinfo>
                  <oldnr>5</oldnr>
                </xs:appinfo>
              </xs:annotation>
            </xs:enumeration>
            <xs:enumeration value="GGA_PBE">
              <xs:annotation>
                <xs:appinfo>
                  <oldnr>20</oldnr>
                </xs:appinfo>
              </xs:annotation>
            </xs:enumeration>
            <xs:enumeration value="GGA_PBE_R">
              <xs:annotation>
                <xs:appinfo>
                  <oldnr>21</oldnr>
                </xs:appinfo>
              </xs:annotation>
            </xs:enumeration>
            <xs:enumeration value="GGA_PBE_SOL">
              <xs:annotation>
                <xs:appinfo>
                  <oldnr>22</oldnr>
                </xs:appinfo>
              </xs:annotation>
            </xs:enumeration>
            <xs:enumeration value="GGA_WC">
              <xs:annotation>
                <xs:appinfo>
                  <oldnr>26</oldnr>
                </xs:appinfo>
              </xs:annotation>
            </xs:enumeration>
            <xs:enumeration value="GGA_AM05">
              <xs:annotation>
                <xs:appinfo>
                  <oldnr>30</oldnr>
                </xs:appinfo>
              </xs:annotation>
            </xs:enumeration>
            <xs:enumeration value="GGA_AC_PBE">
              <xs:annotation>
                <xs:appinfo>
                  <oldnr>300</oldnr>
                </xs:appinfo>
              </xs:annotation>
            </xs:enumeration>
            <xs:enumeration value="HYB_PBE0">
               <xs:annotation>
                 <xs:appinfo>
                   <oldnr>406</oldnr>
                 </xs:appinfo>
               </xs:annotation>
            </xs:enumeration>
            <xs:enumeration value="HYB_LDA0">
               <xs:annotation>
                 <xs:appinfo>
                   <oldnr>407</oldnr>
                 </xs:appinfo>
               </xs:annotation>
            </xs:enumeration>
            <xs:enumeration value="EXX">
              <xs:annotation>
                <xs:appinfo><!-- set to "-2" or lower for EXX -->
                  <oldnr>-1</oldnr>
                </xs:appinfo>
              </xs:annotation>
            </xs:enumeration>
            <xs:enumeration value="none">
              <xs:annotation>
                <xs:appinfo>
                  <oldnr>1</oldnr>
                </xs:appinfo>
              </xs:annotation>
            </xs:enumeration>
          </xs:restriction>
        </xs:simpleType>
      </xs:attribute>
      <xs:attribute ex:importance="expert" ex:unit="" name="ldapu" default="none">
        <xs:annotation>
          <xs:documentation>Type of LDA+U method to be used.</xs:documentation>
        </xs:annotation>
        <xs:simpleType>
          <xs:restriction base="xs:string">
            <xs:enumeration value="none">
              <xs:annotation>
                <xs:appinfo>
                  <oldnr>0</oldnr>
                </xs:appinfo>
              </xs:annotation>
            </xs:enumeration>
            <xs:enumeration value="FullyLocalisedLimit">
              <xs:annotation>
                <xs:appinfo>
                  <oldnr>1</oldnr>
                </xs:appinfo>
              </xs:annotation>
            </xs:enumeration>
            <xs:enumeration value="AroundMeanField">
              <xs:annotation>
                <xs:appinfo>
                  <oldnr>2</oldnr>
                </xs:appinfo>
              </xs:annotation>
            </xs:enumeration>
            <xs:enumeration value="FFL-AMF-interpolation">
              <xs:annotation>
                <xs:appinfo>
                  <oldnr>3</oldnr>
                </xs:appinfo>
              </xs:annotation>
            </xs:enumeration>
          </xs:restriction>
        </xs:simpleType>
      </xs:attribute>
      <xs:attribute ex:importance="expert" ex:unit="" name="lmaxvr" type="xs:integer" default="8">
        <xs:annotation>
          <xs:documentation>Angular momentum cut-off for the muffin-tin density and
            potential.</xs:documentation>
          <xs:appinfo>
            <olddefault default="7"/>
          </xs:appinfo>
        </xs:annotation>
      </xs:attribute>
      <xs:attribute ex:importance="expert" ex:unit="" name="fracinr" type="fortrandouble" default="0.02d0">
        <xs:annotation>
          <xs:documentation>Fraction of the muffin-tin radius up to which lmaxinr is used as the
            angular momentum cut-off.</xs:documentation>
        </xs:annotation>
      </xs:attribute>
      <xs:attribute ex:importance="expert" ex:unit="" name="lmaxinr" type="xs:integer" default="2">
        <xs:annotation>
          <xs:documentation> Close to the nucleus, the density and potential is almost spherical and
            therefore the spherical harmonic expansion can be truncated a low angular momentum. See
            also <attref>fracinr</attref>. </xs:documentation>
        </xs:annotation>
      </xs:attribute>
      <xs:attribute ex:importance="expert" ex:unit="" name="lmaxmat" type="xs:integer" default="8">
        <xs:annotation>
          <xs:documentation>Angular momentum cut-off for the outer-most loop in the hamiltonian and
            overlap matrix setup.</xs:documentation>
        </xs:annotation>
      </xs:attribute>

            <xs:attribute ex:importance="expert" ex:unit="" name="ValenceRelativity" default="zora">
              <xs:annotation>
                <xs:documentation>Relativistic Hamiltonian to use in groundstate calculations. 
                <list>
                    <li>none   - solves non-relativistic Schoedinger equation (SE) </li>
                    <li>zora   - solves scalar-relativistic SE within zero-order regular approximation (ZORA) </li>
                    <li>iora*  - solves scalar-relativistic SE within infinite-order regular approximation (IORA), the small component is neglected </li>
                    <li>iora   - solves scalar-relativistic SE within infinite-order regular approximation (IORA), the small component is included  </li>
                    <li>kh*    - solves scalar-relativistic SE for the large component, the small component is neglected  </li> 
                    <li>kh     - solves scalar-relativistic SE for the large component, the small component is included  </li>
                </list>
                       iora, kh* and kh are implemented only for atoms.
                </xs:documentation>
              </xs:annotation>
              <xs:simpleType>
                <xs:restriction base="xs:string">
                  <xs:enumeration value="zora"/>
                  <xs:enumeration value="iora*"/>
                  <xs:enumeration value="iora"/>
                  <xs:enumeration value="kh*"/>
                  <xs:enumeration value="kh"/>
                  <xs:enumeration value="none"/>
                </xs:restriction>
              </xs:simpleType>
            </xs:attribute>
            <xs:attribute ex:importance="expert" ex:unit="" name="CoreRelativity" default="dirac">
              <xs:annotation>
                <xs:documentation>Chooses between relativistic/non-relativistic descriptions for core electrons. Pick either "dirac" or "none".
                </xs:documentation>
              </xs:annotation>
              <xs:simpleType>
                <xs:restriction base="xs:string">
                  <xs:enumeration value="dirac"/>
                  <xs:enumeration value="none"/>
                </xs:restriction>
              </xs:simpleType>
            </xs:attribute>
      <xs:attribute ex:importance="expert" ex:unit="" name="energyref" type="fortrandouble" default="0.0d0">
        <xs:annotation>
          <xs:documentation> Energy reference <inlinemath>\varepsilon_\textrm{ref}</inlinemath> 
                             for the scalar-relativistic ZORA. It enters the kinetic energy expression 
                             <inlinemath>T=\mathbf{p}\frac{c^2}{2c^2+\varepsilon-v(\mathbf{r})}\mathbf{p}</inlinemath>.
          </xs:documentation>
        </xs:annotation>
      </xs:attribute>

      <xs:attribute ex:importance="expert" ex:unit="" name="SymmetricKineticEnergy" type="xs:boolean" default="true">
        <xs:annotation>
          <xs:documentation> If <pre>"true"</pre>, the kinetic-energy matrix elements of muffin-tin functions are calculated by applying gradient to both bra and ket.
           Otherwise, the whole kinetic-energy operator is applied to ket only, and the surface-term correction is applied to make the hamiltonian hermitian.
          </xs:documentation>
        </xs:annotation>
      </xs:attribute>
      <xs:attribute ex:importance="expert" ex:unit="" name="ExplicitKineticEnergy" type="xs:boolean" default="true">
        <xs:annotation>
          <xs:documentation> 
            If true, the kinetic energy expectation values are calculated explicitly and, then, they are used for calculating the total energy.
          </xs:documentation>
        </xs:annotation>
      </xs:attribute>




      <xs:attribute ex:importance="expert" ex:unit="" name="vkloff" type="vect3d" default="0.0d0 0.0d0 0.0d0">
        <xs:annotation>
          <xs:documentation>The <inlinemath>{\mathbf k}</inlinemath>-point offset vector in lattice coordinates.</xs:documentation>
        </xs:annotation>
      </xs:attribute>
      <xs:attribute ex:importance="expert" ex:unit="" name="npsden" type="xs:integer" default="9">
        <xs:annotation>
          <xs:documentation>Order of polynomial for pseudo-charge density.</xs:documentation>
        </xs:annotation>
      </xs:attribute>
      <xs:attribute ex:importance="expert" ex:unit="" name="cfdamp" type="fortrandouble" default="0.0d0">
        <xs:annotation>
          <xs:documentation>Damping coefficient for characteristic function.</xs:documentation>
        </xs:annotation>
      </xs:attribute>
      <xs:attribute ex:importance="expert" ex:unit="" name="nosource" type="xs:boolean" default="false">
        <xs:annotation>
          <xs:documentation> When set to <pre>"true"</pre>, source fields are projected out of the
            exchange-correlation magnetic field. experimental feature. </xs:documentation>
        </xs:annotation>
      </xs:attribute>
      <xs:attribute ex:importance="expert" ex:unit="" name="tevecsv" type="xs:boolean" default="false">
        <xs:annotation>
          <xs:documentation> The attribute tevecsv is <pre>"true"</pre> if second-variational
            eigenvectors are calculated. </xs:documentation>
        </xs:annotation>
      </xs:attribute>
      <xs:attribute ex:importance="expert" ex:unit="" name="tpartcharges" type="xs:boolean" default="false">
        <xs:annotation>
          <xs:documentation> The attribute tpartcharges is <pre>"true"</pre> if partial charges 
          for each state j, atom alpha and for each lm combination are calculated. </xs:documentation>
        </xs:annotation>
      </xs:attribute>   
      <xs:attribute ex:importance="expert" ex:unit="" name="nwrite" type="xs:integer" default="0">
        <xs:annotation>
          <xs:documentation> Normally, the density and potentials are written to the file STATE.OUT
            only after completion of the self-consistent loop. By setting nwrite to a positive
            integer the file will be written during the loop every nwrite
            iterations.</xs:documentation>
        </xs:annotation>
      </xs:attribute>
      <xs:attribute ex:importance="expert" ex:unit="" name="ptnucl" type="xs:boolean" default="true">
        <xs:annotation>
          <xs:documentation> The attrubute ptnucl is <pre>"true"</pre> if the nuclei are to be
            treated as point charges, if <pre>"false"</pre> the nuclei have a finite spherical
            distribution. </xs:documentation>
        </xs:annotation>
      </xs:attribute>
      <xs:attribute ex:importance="essential" ex:unit="" name="scfconv" type="xs:string" use="optional" default="multiple">
         <xs:annotation>
              <xs:documentation>
              Specify the SCF convergence criteria
              <list>
                <li>"energy"    - only the total energy of the system is used as a convergence criterion. 
		     If the calculation of the atomic forces is required 
		     (e.g., in the optimization of the atomic positions) the non-IBS contribution 
		     to the atomic forces is added as a further convergence criterion.</li>
                <li>"potential" - only the Kohn-Sham potential is used as a convergence criterion. 
		     If atomic forces are required the convergence criterion is extended 
		     to include non-IBS forces. </li>
                <li>"multiple"  - total energy, Kohn-Sham potential, and total electronic charge of the system 
		     are used as convergence criteria. 
		     If atomic forces are required the convergence criterion 
		     is extended to include non-IBS forces.</li> 
              </list>
              </xs:documentation>
          </xs:annotation>
       </xs:attribute>
       
      <xs:attribute ex:importance="expert" ex:unit="" name="dipolecorrection" type="xs:boolean" default="false">
        <xs:annotation>
          <xs:documentation> 
            If <pre>"true"</pre>, the dipole correction is applied for slabs oriented 
	    along the <inlinemath>z</inlinemath>-direction.
          </xs:documentation>
        </xs:annotation>
      </xs:attribute>
      
      <xs:attribute ex:importance="expert" ex:unit="" name="dipoleposition" type="fortrandouble" default="1.0d0">
        <xs:annotation>
          <xs:documentation> 
	    The value of this attribute indicates the position of the jump in electrostatic potential, 
	    after the compensating potential (<it>i.e.</it>, the dipole correction) is applied. 
	    The position is given as a fractional coordinate in the vertical direction. 
	    Please note that this jump position should be located within the vacuum region enough 
	    far away from the atomic layers, otherwise the compensating potential cannot be 
	    correctly applied. It is recommended to put the jump position at the middle of 
	    the vacuum layer.
          </xs:documentation>
        </xs:annotation>
      </xs:attribute>
 
          <!--xs:attribute ex:importance="expert" ex:unit="" name="tconvcritenergy" type="xs:boolean" default="true">
            <xs:annotation>
              <xs:documentation> The attribute tconvcritenergy is <pre>"true"</pre> if the value  
              of the total energy of the system is used as a convergence criterion for the 
              self-consistent procedure used to solve the Kohn-Sham equations. By default,
              this is the only used convergence criterion (exception: in LDA+U and OEP calculations,
              the Kohn-Sham potential is automatically chosen instead). </xs:documentation>
            </xs:annotation>
          </xs:attribute>    
          <xs:attribute ex:importance="expert" ex:unit="" name="tconvcritvks" type="xs:boolean" default="false">
            <xs:annotation>
              <xs:documentation> The attribute tconvcritvks is <pre>"true"</pre> if the value  
              of the Kohn-Sham potential ($V_{KS}$) of the system is used as a convergence criterion for the 
              self-consistent procedure used to solve the Kohn-Sham equations. For LDA+U and OEP calculations, this is
              the (automatically chosen) convergence criterion. </xs:documentation>
            </xs:annotation>
          </xs:attribute>  
          <xs:attribute ex:importance="expert" ex:unit="" name="tconvcritcharge" type="xs:boolean" default="false">
            <xs:annotation>
              <xs:documentation> The attribute tconvcritcharge is <pre>"true"</pre> if the value  
              of the total charge of the system is used as a convergence criterion for the 
              self-consistent procedure used to solve the Kohn-Sham equations. (This amount should be
              constant, but it is subject to numerical errors) </xs:documentation>
            </xs:annotation>
          </xs:attribute>  
          <xs:attribute ex:importance="expert" ex:unit="" name="tconvcritforces" type="xs:boolean" default="false">
            <xs:annotation>
              <xs:documentation> The attribute tconvcritforces is <pre>"true"</pre> if the value  
              of the an average of forces on nuclei of the system is used as a convergence criterion for the 
              self-consistent procedure used to solve the Kohn-Sham equations. </xs:documentation>
            </xs:annotation>
          </xs:attribute-->
          
          <xs:attribute ex:importance="expert" ex:unit="" name="outputlevel" default="normal">
            <xs:annotation>
              <xs:documentation> 
                Specify amount of information which is printed to files:
                <list>
                    <li>none   - no output is produced</li>
                    <li>low    - minimal output is produced</li>
                    <li>normal - (default) standard information</li>
                    <li>high   - detailed output</li>
                </list>
              </xs:documentation>
            </xs:annotation>
            <xs:simpleType>
              <xs:restriction base="xs:string">
                <xs:enumeration value="none">
                  <xs:annotation>
                    <xs:appinfo>
                      <oldnr>-1</oldnr>
                    </xs:appinfo>
                  </xs:annotation>
                </xs:enumeration>
                <xs:enumeration value="low">
                  <xs:annotation>
                    <xs:appinfo>
                      <oldnr>0</oldnr>
                    </xs:appinfo>
                  </xs:annotation>
                </xs:enumeration>
                <xs:enumeration value="normal">
                  <xs:annotation>
                    <xs:appinfo>
                      <oldnr>1</oldnr>
                    </xs:appinfo>
                  </xs:annotation>
                </xs:enumeration>
                <xs:enumeration value="high">
                  <xs:annotation>
                    <xs:appinfo>
                      <oldnr>2</oldnr>
                    </xs:appinfo>
                  </xs:annotation>
                </xs:enumeration>
              </xs:restriction>
            </xs:simpleType>
          </xs:attribute>
                   
    </xs:complexType>
  </xs:element>
  <xs:annotation>
        <xs:appinfo>
            <parent>/input</parent>
            <root>relax</root>
        </xs:appinfo>
    </xs:annotation>
  <xs:element ex:importance="essential" ex:unit="" name="relax">
        <xs:annotation>
            <xs:documentation>The element <elementref>relax</elementref> activates the optimization 
            of atomic positions at fixed lattice parameters.</xs:documentation>
        </xs:annotation>
        <xs:complexType>

            <xs:attribute ex:importance="essential" ex:unit="" name="outputlevel" default="normal">
                <xs:annotation>
                    <xs:documentation> 
                    Specify the amount of information which is printed to output files:
                    <list>
                      <li> <pre>"low"</pre> - 
		           Minimal output is produced. For each optimization steps, the main output file 
		           <pre>"INFO.OUT"</pre> contains information on the number of SCF cicles performed,
		    	   the value of the maximum force acting on the atoms, and the calculated total 
		           energy. </li>
		      <li> <pre>"normal"</pre> - 
		           (default) Standard information. In addition to the output level <pre>"low"</pre>,
			   the atomic configuration (in lattice coordinates) and the total forces (in 
			   cartesian coordinates) acting on the atoms are also given. If a constrained 
			   optimization is performed, the constrained (unconstrained) cartesian components 
			   of each atom are labeled by <pre>"T"</pre> (<pre>"F"</pre>). </li>
		      <li> <pre>"high"</pre> - 
		           Detailed output. In addition to the output level <pre>"normal"</pre>, partial 
		           charges and the different force contributions are also specified. </li>
                    </list>
                    </xs:documentation>
                </xs:annotation>
            <xs:simpleType>
              <xs:restriction base="xs:string">
                <xs:enumeration value="low">
                  <xs:annotation>
                    <xs:appinfo>
                      <oldnr>0</oldnr>
                    </xs:appinfo>
                  </xs:annotation>
                </xs:enumeration>
                <xs:enumeration value="normal">
                  <xs:annotation>
                    <xs:appinfo>
                      <oldnr>1</oldnr>
                    </xs:appinfo>
                  </xs:annotation>
                </xs:enumeration>
                <xs:enumeration value="high">
                  <xs:annotation>
                    <xs:appinfo>
                      <oldnr>2</oldnr>
                    </xs:appinfo>
                  </xs:annotation>
                </xs:enumeration>
              </xs:restriction>
            </xs:simpleType>
          </xs:attribute>
            
            <xs:attribute ex:importance="essential" ex:unit="" name="method" type="xs:string" use="optional" default="bfgs">
                <xs:annotation>
                    <xs:documentation>
                    Specify the method used for atomic relaxation: 
                    <list>
                      <li> <pre>"newton"</pre> - 
		           Simple (Newton-like) method. At each step <inlinemath>m</inlinemath> of a 
			   structural optimization run, the atom <inlinemath>\alpha</inlinemath> is 
			   displaced according to
                           <displaymath>
                           {\bf r}_{\alpha}^{(m+1)}={\bf r}_{\alpha}^{(m)}+\tau_{\alpha}^{(m)}
                           \left({ \bf F}_{\alpha}^{(m)}+{ \bf F}_{\alpha}^{(m-1)}\right),
                           </displaymath>
                           i.e., the magnitude of the displacement at the step <inlinemath>m</inlinemath> 
			   is proportional to <inlinemath>\tau_{\alpha}^{(m)}</inlinemath>. 
                           For the initial step, <inlinemath>\tau_{\alpha}^{(0)}</inlinemath> 
                           is set to <attref>taunewton</attref>. 
                           If the forces of two subsequent optimization steps have the same sign,
                           <inlinemath>\tau_{\alpha}^{(m)}</inlinemath> is increased by 
			   <inlinemath>\tau_{\alpha}^{(0)}</inlinemath>. Otherwise, 
			   <inlinemath>\tau_{\alpha}^{(m)}</inlinemath> is reset to 
			   <inlinemath>\tau_{\alpha}^{(0)}</inlinemath>. </li>
                      <li> <pre>"harmonic"</pre> - 
		           Method based on the combination of the <pre>"newton"</pre> method and the 
			   harmonic approximation. Contrary to <pre>"newton"</pre>, all cartesian components 
			   of the position vector of each atom are treated independently. 
			   At the optimization step <inlinemath>m</inlinemath>, each cartesian component of
			   the position vector of each atom is updated using the same algorithm as in 
			   <pre>"newton"</pre> (``newton step") unless the ``harmonic condition", either 
			   <displaymath>
			   \beta\equiv\frac{{ \bf F}_{\alpha}^{(m-1)}}{{ \bf F}_{\alpha}^{(m)}} \in\; ]-\infty,0] 
			   </displaymath>
			   or
			   <displaymath>
			   \beta \in [3,\infty[\:,
			   </displaymath>
			   is fulfilled.
			   In this case (``harmonic step"), atomic positions are updated according to
			   <displaymath>
                           {\bf r}_{\alpha}^{(m+1)}=\frac{ {\bf r}_{\alpha}^{(m-1)}-\beta\,{\bf r}_{\alpha}^{(m)} }
			   { 1-\beta }\:.
                           </displaymath>
			   The <pre>"harmonic"</pre> method is of general validity and  
			   it is particularly efficient when the atomic 
			   configuration is close to the optimized one and the internal degrees of 
		           freedom are weakly coupled. </li>
                      <li> <pre>"bfgs"</pre> - 
		           Limited memory algorithm for bound constrained optimization, see
			   <pre>Byrd,</pre> <pre>et</pre> <pre>al.,</pre> <pre> SIAM J. Scientific Computing 16,
			   1190 (1995)</pre>. 
			   This method requires 
			   high accuracy for the determination of the total energy in dependence of the 
			   maximum allowed for the residual atomic force. For this reason, the 
			   default value of the attribute <attref>epsengy</attref> is decreased in order to be
			   at least equal to the value 
			   of the attribute <attref>epsforce</attref> of the <elementref>relax</elementref> 
			   element multiplied by a factor <pre>0.02</pre>. </li>
                    </list>
                    </xs:documentation>
                </xs:annotation>
            </xs:attribute>

            <xs:attribute ex:importance="expert" name="maxsteps" type="xs:integer" use="optional" default="200">
                <xs:annotation>
                    <xs:documentation>
                    Maximum number of optimization steps.
                    </xs:documentation>
                </xs:annotation>
            </xs:attribute>
	    
            <xs:attribute ex:importance="expert" name="maxbfgs" type="xs:integer" use="optional" default="5">
                <xs:annotation>
                    <xs:documentation>
                    Maximum number of atomic configurations that can be investigated in a single 
		    <pre>"bfgs"</pre> optimization step.
                    </xs:documentation>
                </xs:annotation>
            </xs:attribute>        
            
            <xs:attribute ex:importance="essential" name="epsforce" type="fortrandouble" default="2.0d-4" use="optional">
                <xs:annotation>
                    <xs:documentation>
                    The optimization stops when the maximum amplitude of the force acting on the atoms is 
		    lower then the value specified by <pre>epsforce</pre>. Notice that, in particular 
		    for the <pre>"bfgs"</pre> method, high accuracy in the calculated forces requires high 
		    accuracy in the calculated total energy (see the attribute <attref>epsengy</attref>
		    of the <elementref>groundstate</elementref> element).
                    </xs:documentation>
                </xs:annotation>
            </xs:attribute>
            
            <xs:attribute ex:importance="expert" name="taunewton" type="fortrandouble" default="0.2d0" use="optional">
                <xs:annotation>
                    <xs:documentation> Parameter determining the initial amplitude of atomic displacement 
		    for the <pre>"newton"</pre> method of atomic relaxation.
                    </xs:documentation>
                </xs:annotation>
            </xs:attribute>
            
            <xs:attribute ex:importance="expert" name="taubfgs" type="fortrandouble" default="0.3d0" use="optional">
                <xs:annotation>
                    <xs:documentation>
                    Maximum atomic displacement for atomic relaxation when using the <pre>"bfgs"</pre> method. 
		    At each optimization step, the optimized value of each cartesian coordinate of each atom 
		    is searched in a range of size <inlinemath>2\tau_{\tt BFGS}</inlinemath>
		    centered at the actual value of the coordinate.
                    </xs:documentation>
                </xs:annotation>
            </xs:attribute>
	    
            <xs:attribute ex:importance="expert" name="endbfgs" type="xs:string" default="harmonic" use="optional">
                <xs:annotation>
                    <xs:documentation>
                    When using the <pre>"bfgs"</pre> method, specifies the method employed for the relaxation
		    if the <pre>"bfgs"</pre> scheme fails to converge.
                    <list>
		      <li> <pre>"newton"</pre> - 
		           Simple (Newton-like) method, see also <attref>method</attref>. </li>
		      <li> <pre>"harmonic"</pre> - 
		           Method based on the combination of the <pre>"newton"</pre> method and the harmonic 
			   approximation, see also <attref>method</attref>. </li>
		      <li> <pre>"stop"</pre> - 
		           Stops the <pre>"bfgs"</pre> optimization procedure at the last accepted 
			   configuration. </li>
                    </list>    
                    </xs:documentation>
                </xs:annotation>
            </xs:attribute>
	    
            <xs:attribute ex:importance="expert" name="printtorque" type="xs:boolean" default="false" use="optional">
	        <xs:annotation>
                    <xs:documentation> 
                    If <pre>"true"</pre> the total torque with respect to cartesian axes with origin in 
		    the center of mass is written on the output file <pre>INFO.OUT</pre>. 
		    This option is useful when dealing with isolated molecules when checking if the 
		    molecule is rotating as a whole during the optimization. If <pre>printtorque</pre>
		    is set to <pre>"true"</pre> the cartesian coordinates of the center of mass are also 
		    written. Notice that the definition of a <pre>center of mass</pre> is unique only 
		    for isolated molecules. 
                    </xs:documentation>
                </xs:annotation>
	    </xs:attribute>

            <xs:attribute ex:importance="essential" name="history" type="xs:boolean" default="false" use="optional">
                <xs:annotation>
                    <xs:documentation> 
                    If <pre>"true"</pre> the atomic configuration at each relaxation step is written in a history
		    file which is generated in one of the formats specified in <attref>historyformat</attref>.
                    </xs:documentation>
                </xs:annotation>
            </xs:attribute>

            <xs:attribute ex:importance="essential" name="addtohistory" type="xs:boolean" default="false" use="optional">
                <xs:annotation>
                    <xs:documentation>
                    If <attref>history</attref> is <pre>"true"</pre>, this switch allows newly computed 
		    optimization steps to be appended to a previously generated history file.
                    </xs:documentation>
                </xs:annotation>
            </xs:attribute>

            <xs:attribute ex:importance="essential" name="historyformat" type="xs:string" default="xyz" use="optional">
                <xs:annotation>
                    <xs:documentation> 
                    If <attref>history</attref> is <pre>"true"</pre>, the history file, containig atomic 
		    configurations at each optimization step, is generated in one of the following formats:
                    <list>
                      <li> <pre>"xyz"</pre> 
		           molecular format. The first line of this file the total number of atoms. 
			   The second line is a comment line with total energy in eV. 
			   Finally, starting from line three, one finds 
                           atomic species, cartesian coordinates in Angstrom, and forces in eV/Angstrom. 
			   This format is repeated for each optimization step. </li>
                      <li> <pre>"gulp"</pre> 
		           format, which is useful to visualize crystal structure changes using the 
		           <pre>GDIS</pre> program. </li>
                    </list>
                    </xs:documentation>
                </xs:annotation>
            </xs:attribute>
            
        </xs:complexType>
    </xs:element>
  <xs:annotation>
        <xs:appinfo>
            <parent>/input</parent>
            <root>phonons</root>
        </xs:appinfo>
    </xs:annotation>
  <xs:element ex:importance="expert" ex:unit="" name="phonons">
       <xs:annotation>
           <xs:documentation><p>Compute the dynamical matrix.</p>
             <p>This is done by constructing a supercell (attributes <attref>ngridq</attref> and <attref>reduceq</attref>), displacing atoms in it and 
             obtaining the dynamical matrix from the forces. As all atoms are displaced four times in each direction, and this is done for every <inlinemath>{\bf q}</inlinemath>-point,
             phonon calculations can become quite tedious. If the calculation was done already at an earlier point, and an
             existing dynamical matrix should be reused, the attribute <attref>do</attref> allows to skip a fresh calculation. Note also that the calculation of the dynamical matrix can be run in parallel.</p>
             <p>To obtain phonon eigenvalues and eigenvectors for one
             or more <inlinemath>{\bf q}</inlinemath>-points, add one of the elements 
             <elementref>qpointset</elementref>, <elementref>interpolate</elementref>, <elementref>phonondispplot</elementref> or
              <elementref>phonondos</elementref>.</p></xs:documentation>
       </xs:annotation>
          <xs:complexType>
             <xs:all>
                <xs:element ex:importance="expert" ex:unit="" ref="qpointset" minOccurs="0" maxOccurs="1"/>
                <xs:element ex:importance="expert" ex:unit="" name="phonondos" maxOccurs="1" minOccurs="0">
                    <xs:annotation>
                        <xs:documentation> <p>Compute the phonon density of states (DOS) <inlinemath>g(\omega)</inlinemath> and thermodynamical properties. This is done by calculating the
                        phonon eigenvalues on a dense grid, specified by <attref>ngrdos</attref>. The DOS is output to
                        file <pre>PHDOS.OUT</pre>. Note that <inlinemath>\int\limits_{\omega_{\rm min}}^{\omega_{\rm max}} d\omega\; g(\omega) = 3N_{\rm at}</inlinemath></p>
                        <p>From the DOS <inlinemath>g(\omega)</inlinemath> the following thermodynamical properties are obtained:
                        <list>
                        <li>the zero-point energy <inlinemath>E_{\rm ZP} = \frac{1}{2} \int\limits_{\omega_{\rm min}}^{\omega_{\rm max}}  
                                                                   d\omega\; \omega\, g(\omega)</inlinemath></li>
                        <li>the vibrational internal energy <inlinemath>E_{\rm vib} = \frac{1}{2}
                            \int\limits_{\omega_{\rm min}}^{\omega_{\rm max}} d\omega\; \omega\, g(\omega) \coth\frac{\omega}{2k_B T}</inlinemath></li> 
                        <li>the vibrational free energy <inlinemath>F_{\rm vib} = k_B T
                            \int\limits_{\omega_{\rm min}}^{\omega_{\rm max}} d\omega\; g(\omega) \log\left(2 \sinh \frac{\omega}{2k_B T}\right)</inlinemath></li>
                        <li>the vibrational entropy <inlinemath>S_{\rm vib} = \frac{E_{\rm vib}-F_{\rm vib}}{T}</inlinemath></li>
                        <li>the heat capacity <inlinemath>c = k_B
                            \int\limits_{\omega_{\rm min}}^{\omega_{\rm max}} d\omega\;  g(\omega)  \left(\frac{\omega}{k_B T}\right)^{\!\!\! 2} 
                            {\exp\left(\frac{\omega}{k_B T}\right)}{\left[\exp(\frac{\omega}{k_B T})-1\right]^{-2}}</inlinemath></li>
                        </list> 
                        where <inlinemath>N_{\rm at}</inlinemath> is the number of atoms in the unit cell. These quantities are computed for
                        the temperatures, specified by <attref>ntemp</attref> and written to files <pre>THERMO.OUT</pre> and
                        <pre>thermo.xml</pre>.</p>
                        </xs:documentation>
                    </xs:annotation>
                    <xs:complexType>
                        <xs:attribute ex:importance="essential" ex:unit="" ref="nwdos" default="500"> 
                           <xs:annotation>
                              <xs:documentation>
                              Number of steps between the lowest and highest phonon frequency for the DOS.
                              </xs:documentation>
                           </xs:annotation>
                        </xs:attribute>
                        <xs:attribute ex:importance="essential" ex:unit="" ref="ngrdos" default="100"> 
                        <xs:annotation>
                              <xs:documentation>
                              Number of grid points in each lattice direction on which the eigenvalues are interpolated.
                              </xs:documentation>
                           </xs:annotation>
                        </xs:attribute>
                        <xs:attribute ex:importance="expert" ex:unit="" ref="nsmdos" default="0">
                        <xs:annotation>
                              <xs:documentation>
                              Number of 3-point averaging runs to smoothen the DOS. One run corresponds to setting the DOS value for
                              one frequency <inlinemath>g(\omega_i)</inlinemath> to the average <inlinemath>1/3\:\left[g(\omega_{i-1})+g(\omega_{i})+g(\omega_{i+1})\right]</inlinemath>.
                              </xs:documentation>
                           </xs:annotation>
                        </xs:attribute>
                        <xs:attribute ex:importance="expert" ex:unit="" name="ntemp" type="xs:integer" default="200">
                            <xs:annotation>
                                <xs:documentation>Number of temperatures in the range up to
                                    the maximal temperature <inlinemath>T_{\rm max}</inlinemath> for the calculation
                                    of the thermodynamical properties from the phonon DOS
                                    This corresponds to the maximal phonon frequency <inlinemath>\omega_{\rm max}</inlinemath> by 
                                    <inlinemath>T_{\rm max} = \omega_{\rm max} / k_B</inlinemath>. 
                                </xs:documentation>
                            </xs:annotation>
                        </xs:attribute>
                    </xs:complexType>
                </xs:element>
                <xs:element ex:importance="expert" ex:unit="" name="phonondispplot" maxOccurs="1" minOccurs="0">
                    <xs:annotation>
                        <xs:documentation>Produce a phonon dispersion plot by interpolating phonon frequencies for points on
                        a path through the Brillouin zone. The frequencies for all phonon modes along the path are written to file
                        <pre>PHDISP.OUT</pre>, vertex lines are written to file <pre>PHDLINES.OUT</pre>. Use the element <elementref>plot1d</elementref>
                        to specify the path in reciprocal lattice vectors.</xs:documentation>
                    </xs:annotation>
                    <xs:complexType>
                        <xs:sequence>
                            <xs:element ex:importance="expert" ex:unit="" ref="plot1d"/>
                        </xs:sequence>
                    </xs:complexType>
                </xs:element>
                <xs:element ex:importance="expert" ex:unit="" name="reformatdynmat" maxOccurs="1" minOccurs="0">
                    <xs:annotation>
                        <xs:documentation><p>Reads in the dynamical matrix rows from the corresponding
                            files and outputs them as <inlinemath>3\times 3</inlinemath> blocks for
                            each atom combination to the file <pre>DYNMAT.OUT</pre>.
                            A corrected dynamical matrix which fulfills the accoustic sumrule is output to the
                            file <pre>DYNMAT_SUMRULE.OUT</pre>.  
                            It is obtained by subtracting the three lowest eigenvectors from the original matrix:
                            <inlinemath>D_{ij}^{\bf q}\rightarrow D_{ij}^{\bf q}-\sum_{k=1}^3 \omega_k^0 v_{k;i}^0 v_{k;j}^0</inlinemath>
                            for all <inlinemath>{\bf q}</inlinemath>, where <inlinemath>\omega_k^0</inlinemath> 
                            is the <inlinemath>k</inlinemath>th eigenvalue of the <inlinemath>{\bf q}=0</inlinemath> dynamical matrix 
                            and <inlinemath>v_{k;i}^0</inlinemath> the <inlinemath>i</inlinemath>th component of its eigenvector.</p>
                            <p>Symmetrized forms are written to the files
                            <pre>DYNMAT_SYM.OUT</pre> and <pre>DYNMAT_SYM_SUMRULE.OUT</pre>.</p></xs:documentation>
                    </xs:annotation>
                </xs:element>
                <xs:element ex:importance="expert" ex:unit="" name="interpolate" maxOccurs="1" minOccurs="0">
                    <xs:annotation>
                        <xs:documentation>Interpolates the phonon frequencies, and optionally eigenvectors, on a given <inlinemath>{\bf q}</inlinemath>-point
                            grid and outputs them to file <pre>PHONON_INTERPOLATE.OUT</pre>.</xs:documentation>
                    </xs:annotation>
                    <xs:complexType>
                        <xs:attribute ex:importance="essential" ex:unit="" name="ngridq" type="integertriple" use="required">
                            <xs:annotation>
                                <xs:documentation><inlinemath>{\bf q}</inlinemath>-point grid for interpolation.</xs:documentation>
                            </xs:annotation>
                        </xs:attribute>
                        <xs:attribute ex:importance="expert" ex:unit="" name="vqloff" type="vect3d" default="0.0d0 0.0d0 0.0d0">
                            <xs:annotation>
                                <xs:documentation>The <inlinemath>{\bf q}</inlinemath>-point offset vector in lattice
                                    coordinates.</xs:documentation>
                            </xs:annotation>
                        </xs:attribute>
                        <xs:attribute ex:importance="expert" ex:unit="" name="writeeigenvectors" type="xs:boolean" default="false">
                            <xs:annotation>
                                <xs:documentation> Set to <pre>true</pre> if the phonon eigenvectors
                                    are to be interpolated and output in addition to the phonon
                                    frequencies. </xs:documentation>
                            </xs:annotation>
                        </xs:attribute>
                    </xs:complexType>
                </xs:element>
                <xs:element ex:importance="expert" ex:unit="" ref="parts" minOccurs="0" maxOccurs="1"/>
            </xs:all>
            <xs:attribute ex:importance="experimental" ex:unit="" name="phonontype" default="supercell">
                <xs:annotation>
                    <xs:appinfo>
                        <oldname>nonreplace</oldname>
                    </xs:appinfo>
                    <xs:documentation> Decides which method (supercell or linear response) is used
                        to perform the phonon calculation.</xs:documentation>
                </xs:annotation>
                <xs:simpleType>
                    <xs:restriction base="xs:string">
                        <xs:enumeration value="supercell"/>
                        <xs:enumeration value="linearresponse"/>
                    </xs:restriction>
                </xs:simpleType>
            </xs:attribute>
            <xs:attribute ex:importance="expert" ex:unit="" name="do" default="fromscratch">
                <xs:annotation>
                    <xs:appinfo>
                        <oldname>nonreplace</oldname>
                    </xs:appinfo>
                    <xs:documentation> Specify if the phonon calculation is performed (value <pre>fromscratch</pre>)
                        or skipped (value <pre>skip</pre>.) In the latter case the dynamical matrix is read from files produced in a previous
                        run with the same parameters. The value <pre>fromscratch</pre> can also be used to continue an
                        incomplete calculation.</xs:documentation>
                </xs:annotation>
                <xs:simpleType>
                    <xs:restriction base="xs:string">
                        <xs:enumeration value="fromscratch"/>
                        <xs:enumeration value="skip"/>
                    </xs:restriction>
                </xs:simpleType>
            </xs:attribute>
            <xs:attribute ex:importance="expert" ex:unit="" name="ngridq" type="integertriple" default="1 1 1">
                <xs:annotation>
                    <xs:appinfo>
                        <oldname>ngridq</oldname>
                    </xs:appinfo>
                    <xs:documentation>Number of <inlinemath>{\bf q}</inlinemath> grid points along the basis vector
                        directions. This determines the size of the supercell.</xs:documentation>
                </xs:annotation>
            </xs:attribute>
            <xs:attribute ex:importance="expert" ex:unit="" name="reduceq" type="xs:boolean" default="true">
                <xs:annotation>
                    <xs:documentation> The attribute <pre>reduceq</pre> is set to <pre>"true"</pre>
                        if the <inlinemath>{\bf q}</inlinemath>-point set is to be reduced with the crystal symmetries.
                    </xs:documentation>
                </xs:annotation>
            </xs:attribute>
            <xs:attribute ex:importance="expert" ex:unit="" name="deltaph" type="fortrandouble" default="0.03d0">
                <xs:annotation>
                    <xs:documentation><p>Phonon calculations are performed by constructing a supercell
                        corresponding to a particular <inlinemath>{\bf q}</inlinemath>-vector and
                        making small periodic sin- and cos-like displacements of the atoms. The amplitude of this
                        displacement, in cartesian coordinates for each component, is given by <pre>deltaph</pre> (in units of Bohr).
                        Additionally a displacement of <pre>2*deltaph</pre> is done, so in general each atom is displaced four times.</p>
                        <p><pre>deltaph</pre> should not be made too large, as
                        anharmonic terms could then become significant, neither should it be too
                        small as this can introduce a numerical error.</p> </xs:documentation>
                </xs:annotation>
            </xs:attribute>
            <xs:attribute ex:importance="expert" ex:unit="" name="gamma" default="twostep">
                <xs:annotation>
                    <xs:documentation>
                       Determines how force constants at the <inlinemath>\Gamma</inlinemath>-point are computed. The numerical
                       differentiation is done from (a) a displacement by <pre>deltaphi</pre> and the equilibirum
                       (<pre>onestep</pre>), 
                       (b) displacements by <inlinemath>\pm</inlinemath><pre>deltaphi</pre> 
                       (<pre>twostep</pre>), or (c) displacements by 
                       <pre>deltaphi</pre> and 2<pre>deltaphi</pre> (<pre>standard</pre>) for each atom in each cartesian direction.
                       Note that options (a) requires <inlinemath>3N+1</inlinemath> computations, whereas option (b) and (c)
                       require <inlinemath>6N</inlinemath> for <inlinemath>N</inlinemath> atoms.
                       In particular if only the <inlinemath>\Gamma</inlinemath>-point is to be computed, option (b) is more accurate and
                       yields better eigenvectors than (a).
                    </xs:documentation>
                </xs:annotation>
                <xs:simpleType>
                    <xs:restriction base="xs:string">
                       <xs:enumeration value="onestep"/>
                       <xs:enumeration value="twostep"/>
                       <xs:enumeration value="standard"/>
                    </xs:restriction>
                </xs:simpleType>
            </xs:attribute>
        </xs:complexType>
    </xs:element>
  <xs:annotation>
    <xs:appinfo>
      <parent>/input</parent>
      <root>properties</root>
    </xs:appinfo>
  </xs:annotation>
  <xs:element ex:importance="essential" ex:unit="" name="properties">
    <xs:annotation>
      <xs:documentation> Properties listed in this element can be calculated from the groundstate. It works also from a saved state from a previous run. </xs:documentation>
    </xs:annotation>
    <xs:complexType>
      <xs:all>
        <xs:element ex:importance="essential" ex:unit="" name="bandstructure" maxOccurs="1" minOccurs="0">
          <xs:annotation>
            <xs:documentation>If present a banstructure is calculated.</xs:documentation>
          </xs:annotation>
          <xs:complexType>
            <xs:annotation>
              <xs:documentation>Create a bandstructure. Must contain plot1d element for bandstructure path.</xs:documentation>
            </xs:annotation>
            <xs:all>
              <xs:element ex:importance="essential" ex:unit="" ref="plot1d"/>
            </xs:all>
            <xs:attribute ex:importance="essential" ex:unit="Hartree" ref="scissor" default="0.0d0">
              <xs:annotation>
                <xs:documentation>Value to shift bandgap.</xs:documentation>
              </xs:annotation>
            </xs:attribute>
            <xs:attribute ex:importance="expert" ex:unit="" name="character" type="xs:boolean" default="false">
              <xs:annotation>
                <xs:documentation>Band structure plot which includes angular momentum characters for
                  every atom.</xs:documentation>
              </xs:annotation>
            </xs:attribute>
          </xs:complexType>
        </xs:element>
        <xs:element ex:importance="expert" ex:unit="" name="stm" minOccurs="0" maxOccurs="1">
          <xs:complexType>
            <xs:all>
              <xs:element ex:importance="expert" ex:unit="" ref="plot2d" minOccurs="0"/>
	      <xs:element ex:importance="essential" ex:unit="" name="region" maxOccurs="1" minOccurs="0">
		<xs:complexType>
		  <xs:attribute ex:importance="expert" ex:unit="Bohr" name="height" default="0.0d0" type="fortrandouble">
		    <xs:annotation>
		      <xs:documentation>Height (z-coordinate) of the STM tip in Bohr radius, measured from the absolute origin of the unit cell as 
		      defined in the structure element. Assumes the surface is in xy plane.</xs:documentation>
		    </xs:annotation>
		  </xs:attribute>
		  <xs:attribute ex:importance="essential" ex:unit="" name="grid2d" default="10 10" type="integerpair">
		    <xs:annotation>
		      <xs:documentation>Number of grid points along first and second unit cell vectors, respectively.</xs:documentation>
		    </xs:annotation>
		  </xs:attribute>
	  	  <xs:attribute ex:importance="expert" ex:unit="Bohr" name="zrange" default="0.0 0.0" type="vect2d">
		    <xs:annotation>
		      <xs:documentation>Pair of floats giving the minimum and maximum z coordinate of the volumetric 
		      region for sampling the differential-conductance or integrated-LDOS in topographic mode.</xs:documentation>
		    </xs:annotation>
		  </xs:attribute>
		  <xs:attribute ex:importance="essential" ex:unit="" name="grid3d" default="10 10 10" type="integertriple">
		    <xs:annotation>
		      <xs:documentation>Number of grid points along first and second unit cell vectors and along the segment between zmin and zmax along the third cell vector.</xs:documentation>
		    </xs:annotation>
		  </xs:attribute>
		</xs:complexType>
	      </xs:element>
            </xs:all>
            <xs:attribute ex:importance="expert" ex:unit="Hartree" name="bias" default="0.0d0" type="fortrandouble">
              <xs:annotation>
                <xs:documentation>Value of the STM bias voltage in Hartree. A positive value gives an empty states STM image while a negative bias gives a filled states images.</xs:documentation>
              </xs:annotation>
            </xs:attribute>
            <xs:attribute ex:importance="expert" ex:unit="" name="stmtype" default="differentialConductance">
              <xs:annotation>
                <xs:documentation>Specifies the type of STM calculation.
		<list>
		  <li> differentialConductance (default): calculation of the LDOS at an energy Ef+bias. </li>
		  <li> integratedLDOS: integrates the LDOS in the range [Ef,Ef+bias] for positive bias and in the range [Ef+bias, Ef] for negative bias.</li>
		</list>
                </xs:documentation>
              </xs:annotation>
              <xs:simpleType>
		<xs:restriction base="xs:string">
            	  <xs:enumeration value="differentialConductance">
            	  </xs:enumeration>
            	  <xs:enumeration value="integratedLDOS">
            	  </xs:enumeration>
          	</xs:restriction>
              </xs:simpleType>
            </xs:attribute>
            <xs:attribute ex:importance="expert" ex:unit="" name="stmmode" default="constantHeight">
              <xs:annotation>
                <xs:documentation>Specifies the STM mode of operation to be simulated.
		<list>
		  <li> constantHeight (default): Calculates the property defined in the "stmtype" attribute on a two-dimensional mesh defined by the plot2d element. </li>
		  <li> topographic: (to be implemented) Calculates the iso-surface of the property defined in the "stmtype" attribute.</li>
		</list>
                </xs:documentation>
              </xs:annotation>
              <xs:simpleType>
		<xs:restriction base="xs:string">
            	  <xs:enumeration value="constantHeight">
            	  </xs:enumeration>
            	  <xs:enumeration value="topographic">
            	  </xs:enumeration>
          	</xs:restriction>
              </xs:simpleType>
            </xs:attribute>
          </xs:complexType>
        </xs:element>
        <xs:element ex:importance="expert" ex:unit="" name="wfplot" maxOccurs="1" minOccurs="0">
          <xs:annotation>
            <xs:documentation>Wavefunction plot.</xs:documentation>
          </xs:annotation>
          <xs:complexType>
            <xs:annotation>
              <xs:documentation>Plot the wave function at a set of kpoints</xs:documentation>
            </xs:annotation>
            <xs:all>
              <xs:element ex:importance="expert" ex:unit="" ref="kstlist" minOccurs="1">
                <xs:annotation>
                  <xs:documentation><inlinemath>{\mathbf k}</inlinemath>-point and state index for which the wave function should be
                    plotted.</xs:documentation>
                </xs:annotation>
              </xs:element>
              <xs:element ex:importance="expert" ex:unit="" ref="plot1d" minOccurs="0"/>
              <xs:element ex:importance="expert" ex:unit="" ref="plot2d" minOccurs="0"/>
              <xs:element ex:importance="expert" ex:unit="" ref="plot3d" minOccurs="0"/>
            </xs:all>
            <xs:attribute ex:importance="expert" ex:unit="" name="version" default="old" type="xs:string">
              <xs:annotation>
                <xs:documentation> (Temporal solution) 'old' and 'new' version of the visualization subroutine. All tutorials are currently supporting only 'old' version.</xs:documentation>
              </xs:annotation>
            </xs:attribute>
          </xs:complexType>
        </xs:element>
        <xs:element ex:importance="essential" ex:unit="" name="dos" maxOccurs="1" minOccurs="0">
          <xs:annotation>
            <xs:documentation> If present a DOS calculation is started. <p/> DOS and optics plots
              require integrals of the kind
                <displaymath>g(\omega_i)=\frac{\Omega}{(2\pi)^3}\int_{\rm BZ} f({ \bf k})
                \delta(\omega_i-e({\bf k}))d{ \bf k}.</displaymath> These are calculated by first
              interpolating the functions <inlinemath>e({ \bf k})</inlinemath> and <inlinemath>f({
                \bf k})</inlinemath> with the trilinear method on a much finer mesh whose size is
              determined by <attref>ngrdos</attref>. Then the <inlinemath>\omega</inlinemath>-dependent
              histogram of the integrand is accumulated over the fine mesh. If the output function
              is noisy then either <attref>ngrdos</attref> should be increased or <attref>nwdos</attref>
              decreased. Alternatively, the output function can be artificially smoothed up to a
              level given by <attref>nsmdos</attref>. This is the number of successive 3-point averages to
              be applied to the function <inlinemath>g</inlinemath>. </xs:documentation>
          </xs:annotation>
          <xs:complexType>
            <xs:attribute ex:importance="expert" ex:unit="" name="sqados" default="0.0d0 0.0d0 1.0d0" type="vect3d">
              <xs:annotation>
                <xs:documentation> Spin-quantization axis in Cartesian coordinates used when
                  plotting the spin-resolved DOS (z-axis by default). </xs:documentation>
              </xs:annotation>
            </xs:attribute>
            <xs:attribute ex:importance="expert" ex:unit="" name="lmirep" type="xs:boolean" default="false">
              <xs:annotation>
                <xs:documentation> When lmirep is set to <pre>"true"</pre>, the spherical harmonic
                  basis is transformed into one in which the site symmetries are block diagonal.
                  Band characters determined from the density matrix expressed in this basis
                  correspond to irreducible representations, and allow the partial DOS to be
                  resolved into physically relevant contributions, for example eg and t2g.
                </xs:documentation>
              </xs:annotation>
            </xs:attribute>
            <xs:attribute ex:importance="essential" ex:unit="" ref="nwdos" default="500"> </xs:attribute>
            <xs:attribute ex:importance="essential" ex:unit="" ref="ngrdos" default="100"> </xs:attribute>
            <xs:attribute ex:importance="expert" ex:unit="" ref="nsmdos" default="0"> 
              <xs:annotation>
                <xs:documentation>This attribute indicates the type of smearing for the resulting DOS. In particular, the value 0 means no smearing at all, 1 that a three nearest point averaging is performed, 2 that two such consecutive averagings are done, etc. 
                </xs:documentation>
              </xs:annotation>
            </xs:attribute>
            <xs:attribute ex:importance="expert" ex:unit="Hartree" name="winddos" default="-0.5d0 0.5d0" type="vect2d">
              <xs:annotation>
                <xs:documentation>Frequency/energy window for the DOS or optics
                  plot.</xs:documentation>
                <xs:appinfo>
                  <oldname>wdos</oldname>
                </xs:appinfo>
              </xs:annotation>
            </xs:attribute>
            <xs:attribute ex:importance="essential" ex:unit="Hartree" ref="scissor" default="0.0d0"/>
            <xs:attribute ex:importance="expert" ex:unit="" name="jdos" type="xs:boolean" default="false"/>
          </xs:complexType>
        </xs:element>
        <xs:element ex:importance="expert" ex:unit="" name="LSJ" maxOccurs="1" minOccurs="0">
          <xs:annotation>
            <xs:documentation>Output L, S and J expectation values.</xs:documentation>
          </xs:annotation>
          <xs:complexType>
            <xs:all>
              <xs:element ex:importance="expert" ex:unit="" ref="kstlist" minOccurs="0">
                <xs:annotation>
                  <xs:documentation> List of <inlinemath>{ \bf k}</inlinemath>-point and state
                    pairs. Referenced by their index. </xs:documentation>
                </xs:annotation>
              </xs:element>
            </xs:all>
          </xs:complexType>
        </xs:element>
        <xs:element ex:importance="expert" ex:unit="" name="masstensor" maxOccurs="1" minOccurs="0">
          <xs:annotation>
            <xs:documentation> Compute the effective mass tensor at the <inlinemath>{\mathbf k}</inlinemath>-point given by
              vklem. </xs:documentation>
          </xs:annotation>
          <xs:complexType>
            <xs:attribute ex:importance="expert" ex:unit="" name="deltaem" type="fortrandouble" default="0.025d0">
              <xs:annotation>
                <xs:documentation> The size of the <inlinemath>{\mathbf k}</inlinemath>-vector displacement used when calculating
                  numerical derivatives for the effective mass tensor. </xs:documentation>
              </xs:annotation>
            </xs:attribute>
            <xs:attribute ex:importance="expert" ex:unit="" name="ndspem" type="xs:integer" default="1">
              <xs:annotation>
                <xs:documentation> The number of <inlinemath>{\mathbf k}</inlinemath>-vector displacements in each direction around
                  vklem when computing the numerical derivatives for the effective mass
                  tensor.</xs:documentation>
              </xs:annotation>
            </xs:attribute>
            <xs:attribute ex:importance="expert" ex:unit="" name="vklem" type="vect3d" default="0.0d0 0.0d0 0.0d0">
              <xs:annotation>
                <xs:documentation>The <inlinemath>{\mathbf k}</inlinemath>-point in lattice coordinates at which to compute the
                  effective mass tensors.</xs:documentation>
              </xs:annotation>
            </xs:attribute>
          </xs:complexType>
        </xs:element>
        <xs:element ex:importance="essential" ex:unit="" name="chargedensityplot" maxOccurs="1" minOccurs="0">
          <xs:annotation>
            <xs:documentation>Plot the charge density</xs:documentation>
          </xs:annotation>
          <xs:complexType>
            <xs:all>
              <xs:element ex:importance="essential" ex:unit="" ref="plot1d" minOccurs="0"/>
              <xs:element ex:importance="essential" ex:unit="" ref="plot2d" minOccurs="0"/>
              <xs:element ex:importance="essential" ex:unit="" ref="plot3d" minOccurs="0"/>
            </xs:all>
            <xs:attribute name="nocore" type="xs:boolean" default="false">
              <xs:annotation>
                <xs:documentation>
                  Visualize only the density of valence electrons.
                </xs:documentation>
              </xs:annotation>
            </xs:attribute>
          </xs:complexType>
        </xs:element>

        <xs:element ex:importance="essential" ex:unit="" name="TSvdW" maxOccurs="1" minOccurs="0">
          <xs:annotation>
            <xs:documentation> If the subelement <elementref>TSvdW</elementref> is specified inside the element <elementref>properties</elementref>, the <bf>TS-vdW</bf> method (find reference here: <attref>vdWcorrection</attref>) for van-der-Waals correction to the total energy is used. The energy correction is written to a file called <pre>TSvdW.OUT</pre>. Since this method makes use of the electron density of the specific system under investigation, the <bf>TS-vdW</bf> correction can only be obtained in combination with a standard DFT ground-state calculation. In case you skip the ground-state calculation (<attref>do</attref>=<pre>"skip"</pre>), you should make sure that a <pre>STATE.OUT</pre>-file from a previous calculation is contained in your working directory. The electron density will then be read in from this file. If you are interested in changing any of the <bf>TS-vdW</bf> parameters, you can use the element <elementref>TSvdWparameters</elementref> to do so.
	    </xs:documentation>
          </xs:annotation>
          <xs:complexType>
          </xs:complexType>
        </xs:element>

        <xs:element ex:importance="essential" ex:unit="" name="DFTD2" maxOccurs="1" minOccurs="0">
          <xs:annotation>
            <xs:documentation> If the subelement <elementref>DFTD2</elementref> is specified inside the element <elementref>properties</elementref>, the <bf>DFT-D2</bf> method (find reference here: <attref>vdWcorrection</attref>) for van-der-Waals correction to the total energy is used. The energy correction is written to a file called <pre>DFTD2.OUT</pre>. It is not necessary to perform a ground-state calculation, so you could choose <attref>do</attref>=<pre>"skip"</pre> and only calculate the van-der-Waals correction. Only the input file <pre>input.xml</pre> with the declaration of the structure of interest must be provided. If you are interested in changing any of the <bf>DFT-D2</bf> parameters, you can use the element <elementref>DFTD2parameters</elementref> to do so.
	    </xs:documentation>
          </xs:annotation>
          <xs:complexType>
          </xs:complexType>
        </xs:element>

        <xs:element ex:importance="expert" ex:unit="" name="exccplot" maxOccurs="1" minOccurs="0">
          <xs:annotation>
            <xs:documentation>Exchange-correlation and Coulomb potential plots.</xs:documentation>
          </xs:annotation>
          <xs:complexType>
            <xs:all>
              <xs:element ex:importance="expert" ex:unit="" ref="plot1d" minOccurs="0"/>
              <xs:element ex:importance="expert" ex:unit="" ref="plot2d" minOccurs="0"/>
              <xs:element ex:importance="expert" ex:unit="" ref="plot3d" minOccurs="0"/>
            </xs:all>
          </xs:complexType>
        </xs:element>
        <xs:element ex:importance="expert" ex:unit="" name="elfplot" maxOccurs="1" minOccurs="0">
          <xs:annotation>
            <xs:documentation>Electron localization function (ELF).</xs:documentation>
          </xs:annotation>
          <xs:complexType>
            <xs:all>
              <xs:element ex:importance="expert" ex:unit="" ref="plot1d" minOccurs="0"/>
              <xs:element ex:importance="expert" ex:unit="" ref="plot2d" minOccurs="0"/>
              <xs:element ex:importance="expert" ex:unit="" ref="plot3d" minOccurs="0"/>
            </xs:all>
          </xs:complexType>
        </xs:element>
        <xs:element ex:importance="expert" ex:unit="" name="mvecfield" maxOccurs="1" minOccurs="0">
          <xs:annotation>
            <xs:documentation>Plot of magnetization vector field.</xs:documentation>
          </xs:annotation>
          <xs:complexType>
            <xs:all>
              <xs:element ex:importance="expert" ex:unit="" ref="plot2d" minOccurs="0"/>
              <xs:element ex:importance="expert" ex:unit="" ref="plot3d" minOccurs="0"/>
            </xs:all>
          </xs:complexType>
        </xs:element>
        <xs:element ex:importance="expert" ex:unit="" name="xcmvecfield" maxOccurs="1" minOccurs="0">
          <xs:annotation>
            <xs:documentation>Plot of exchange-correlation magnetic vector field.</xs:documentation>
          </xs:annotation>
          <xs:complexType>
            <xs:all>
              <xs:element ex:importance="expert" ex:unit="" ref="plot2d" minOccurs="0"/>
              <xs:element ex:importance="expert" ex:unit="" ref="plot3d" minOccurs="0"/>
            </xs:all>
          </xs:complexType>
        </xs:element>
        <xs:element ex:importance="expert" ex:unit="" name="electricfield" minOccurs="0" maxOccurs="1">
          <xs:annotation>
            <xs:documentation>Writes the electric field to file.</xs:documentation>
          </xs:annotation>
          <xs:complexType>
            <xs:all>
              <xs:element ex:importance="expert" ex:unit="" ref="plot2d" minOccurs="0"/>
              <xs:element ex:importance="expert" ex:unit="" ref="plot3d" minOccurs="0"/>
            </xs:all>
          </xs:complexType>
        </xs:element>
        <xs:element ex:importance="expert" ex:unit="" name="gradmvecfield" maxOccurs="1" minOccurs="0">
          <xs:annotation>
            <xs:documentation>Plot of he gradient of the magnetic vector field.</xs:documentation>
          </xs:annotation>
          <xs:complexType>
            <xs:all>
              <xs:element ex:importance="expert" ex:unit="" ref="plot1d" minOccurs="0"/>
              <xs:element ex:importance="expert" ex:unit="" ref="plot2d" minOccurs="0"/>
              <xs:element ex:importance="expert" ex:unit="" ref="plot3d" minOccurs="0"/>
            </xs:all>
          </xs:complexType>
        </xs:element>
        <xs:element ex:importance="essential" ex:unit="" name="fermisurfaceplot" maxOccurs="1" minOccurs="0">
          <xs:annotation>
            <xs:documentation>Writes Fermi surface data to file.</xs:documentation>
          </xs:annotation>
          <xs:complexType>
            <xs:all>
              <xs:element ex:importance="essential" ex:unit="" ref="plot2d" minOccurs="0"/>
              <xs:element ex:importance="essential" ex:unit="" ref="plot3d" minOccurs="0"/>
            </xs:all>
            <xs:attribute ex:importance="essential" ex:unit="" name="nstfsp" type="xs:integer" default="6">
              <xs:annotation>
                <xs:documentation>Number of states to be included in the Fermi surface plot
                  file.</xs:documentation>
              </xs:annotation>
            </xs:attribute>
          </xs:complexType>
        </xs:element>
        <xs:element ex:importance="expert" ex:unit="" name="EFG" maxOccurs="1" minOccurs="0">
          <xs:annotation>
            <xs:documentation>Calculation of electric field gradient (EFG), contact
              charge.</xs:documentation>
          </xs:annotation>
          <xs:complexType/>
        </xs:element>
        <xs:element ex:importance="expert" ex:unit="" name="mossbauer" minOccurs="0">
          <xs:complexType/>
        </xs:element>

        <xs:element ex:importance="expert" ex:unit="" name="expiqr" minOccurs="0">
          <xs:complexType>
            <xs:annotation>
              <xs:documentation>Write out matrix elements of plane wave for given list of <inlinemath>{\mathbf k}</inlinemath>-points
                and states</xs:documentation>
            </xs:annotation>
            <xs:all>
              <xs:element ex:importance="expert" ex:unit="" ref="kstlist" minOccurs="0">
                <xs:annotation>
                  <xs:documentation><inlinemath>{\mathbf k}</inlinemath>-point list (all states are considered) for which the matrix
                    elements are written out.</xs:documentation>
                </xs:annotation>
              </xs:element>
            </xs:all>
          </xs:complexType>
        </xs:element>
        <xs:element ex:importance="expert" ex:unit="" name="elnes" minOccurs="0">
          <xs:complexType>
            <xs:attribute ex:importance="expert" ex:unit="" name="vecql" type="vect3d" default="0.0d0 0.0d0 0.0d0">
              <xs:annotation>
                <xs:documentation>Gives the q-vector in lattice coordinates for calculating ELNES.</xs:documentation>
              </xs:annotation>
            </xs:attribute>
            <xs:attribute ex:importance="essential" ex:unit="" name="wgrid" type="xs:integer" default="100">
              <xs:annotation>
                <xs:documentation>Number of grid points inside [wmin,wmax] interval.</xs:documentation>
              </xs:annotation>
            </xs:attribute>
            <xs:attribute ex:importance="essential" ex:unit="" name="wmin" type="fortrandouble" default="0.0">
              <xs:annotation>
                <xs:documentation>Lower energy limit.</xs:documentation>
              </xs:annotation>
            </xs:attribute>
            <xs:attribute ex:importance="essential" ex:unit="" name="wmax" type="fortrandouble" default="0.5">
              <xs:annotation>
                <xs:documentation>Upper energy limit.</xs:documentation>
              </xs:annotation>
            </xs:attribute>
            <xs:attribute ex:importance="essential" ex:unit="" name="ngrid" type="xs:integer" default="100"> </xs:attribute>
          </xs:complexType>
        </xs:element>
        <xs:element ex:importance="expert" ex:unit="" name="eliashberg" minOccurs="0">
          <xs:complexType>
            <xs:attribute ex:importance="expert" ex:unit="" name="mustar" type="fortrandouble" default="0.15d0">
              <xs:annotation>
                <xs:documentation>Coulomb pseudopotential, <inlinemath>\mu*</inlinemath>, used in the McMillan-Allen-Dynes
                  equation.</xs:documentation>
              </xs:annotation>
            </xs:attribute>
          </xs:complexType>
        </xs:element>
        
        <xs:element ex:importance="expert" ex:unit="" name="momentummatrix" minOccurs="0" maxOccurs="1">
          <xs:annotation>
            <xs:documentation>
              Generate matrix elements of the momentum operator and store them in PMAT.OUT.
            </xs:documentation>
          </xs:annotation>
          <xs:complexType>
            <xs:attribute ex:importance="expert" ex:unit="" ref="fastpmat" default="true">
              <xs:annotation>
                <xs:documentation>apply generalised DFT correction of L. Fritsche and Y. M. Gu,
                  Phys. Rev. B 48, 4250 (1993)</xs:documentation>
              </xs:annotation>
            </xs:attribute>
          </xs:complexType>
        </xs:element>

        <xs:element ex:importance="expert" ex:unit="" name="dielmat" minOccurs="0" maxOccurs="1">
          <xs:annotation>
            <xs:documentation>
              Calculate the dielectric tensor in IP-RPA (without local-field effect) for q=0.
            </xs:documentation>
          </xs:annotation>          
          <xs:complexType>
            <xs:sequence>
              <xs:element ex:importance="expert" ex:unit="" name="epscomp" type="integerpair" minOccurs="0" maxOccurs="9">
                <xs:annotation>
                  <xs:documentation>Components of the dielectric tensor to be calculated.</xs:documentation>
                </xs:annotation>
              </xs:element>
            </xs:sequence>
            
            <xs:attribute ex:importance="essential" ex:unit="" name="wmax" type="fortrandouble" default="0.30">
              <xs:annotation>
                <xs:documentation>Upper energy limit for the dielectric matrix calculations.</xs:documentation>
              </xs:annotation>
            </xs:attribute>
            
            <xs:attribute ex:importance="essential" ex:unit="" name="wgrid" type="xs:integer" default="400">
              <xs:annotation>
                <xs:documentation>Number of grid points inside [0,wmax] interval.</xs:documentation>
              </xs:annotation>
            </xs:attribute>

            <xs:attribute ex:importance="expert" ex:unit="" name="swidth" type="fortrandouble" default="0.01d0">
              <xs:annotation>
                <xs:documentation>Broadening factor to fit the experimental resolution.</xs:documentation>
              </xs:annotation>
            </xs:attribute>
            
            <xs:attribute ex:importance="expert" ex:unit="" name="scissor" type="fortrandouble" default="0.0d0">
              <xs:annotation>
                <xs:documentation>Value of the "scissor" correction.</xs:documentation>
              </xs:annotation>
            </xs:attribute>

            <xs:attribute ex:importance="expert" ex:unit="" ref="intraband" default="false">
              <xs:annotation>
                <xs:documentation> The intraband attribute is <pre>"true"</pre> if the intraband
                  term is to be added to the optical matrix.</xs:documentation>
              </xs:annotation>
            </xs:attribute>            

            <xs:attribute ex:importance="expert" ex:unit="" name="drude" type="vect2d" default="0.0d0 0.0d0">
              <xs:annotation>
                  <xs:documentation>
                  Parameters for the Drude term used for calculating the intraband contribution:
                  First value determines the plasma frequency, second - the lifetime broadening.
                  </xs:documentation>
              </xs:annotation>
            </xs:attribute>

          
            <xs:attribute ex:importance="expert" ex:unit="" name="tevout" type="xs:boolean" default="false">
              <xs:annotation>
                <xs:documentation><pre>"true"</pre> if energy outputs are in eV.</xs:documentation>
              </xs:annotation>
            </xs:attribute>            

          </xs:complexType>
        </xs:element>

        <xs:element ex:importance="expert" ex:unit="" name="raman" minOccurs="0" maxOccurs="1">
            <xs:annotation>
               <xs:documentation>Compute first order Raman spectra.
               </xs:documentation>
            </xs:annotation>
            <xs:complexType>
               <xs:sequence>
                    <xs:element ex:importance="expert" ex:unit="" name="eigvec" minOccurs="0" maxOccurs="unbounded">
                      <xs:annotation>
                        <xs:documentation>
                        Input manually the eigenvector of a normal mode. Note: Not normalized eigenvectors are
                        renormalized by <pre>exciting</pre>.
                        </xs:documentation>
                      </xs:annotation>
                      <xs:complexType>
                        <xs:attribute ex:importance="expert" ex:unit="" name="comp" type="vect2d" use="required">
                          <xs:annotation>
                            <xs:documentation>A component of the phonon eigenvector. The order of the given
                            components must correspond to the order of the atoms given in <elementref>structure</elementref>,
                            and consist of three times the element <elementref>eigvec</elementref> for each atom 
                            (for <inlinemath>x</inlinemath>, <inlinemath>y</inlinemath> 
                            and <inlinemath>z</inlinemath>). Each time specify two floating point numbers, which are
                            the real and imaginary part of the component.
                            </xs:documentation>
                          </xs:annotation>
                        </xs:attribute>
                      </xs:complexType>
                    </xs:element>
                    <xs:element ex:importance="expert" ex:unit="" ref="energywindow" minOccurs="1" maxOccurs="1">
                       <xs:annotation>
                          <xs:documentation>Use this element to specify the energy range of the Raman spectrum in Ha.
                          </xs:documentation>
                       </xs:annotation>
                    </xs:element>
               </xs:sequence>

               <xs:attribute ex:importance="expert" ex:unit="" name="getphonon" default="fromscratch">
                    <xs:annotation>
                        <xs:documentation>
                        Prior to the calculation of Raman intensities, the normal coordinates of the phonon modes have to be
                        ready. Four choices are available: <pre>fromscratch</pre> triggers a supercell phonon calculation for
                        the <inlinemath>\Gamma</inlinemath>-point (i.e. the supercell is just the unit cell), note that the relevant attributes
                        given with the element <elementref>phonons</elementref> will be overwritten by suitable values; <pre>fromfile</pre>
                        reads the dynamical matrix from <pre>DYN_*.OUT</pre> files produced in a previous phonon calculation;
                        <pre>readinput</pre> enables you to input a phonon eigenvector manually; and <pre>symvec</pre> constructs
                        symmetry vectors from the crystal symmetries and uses them instead of eigenvectors (this is not generally
                        meaningful, as the symmetry vectors are obtained as linear combinations of eigenvectors in case several phonon modes
                        which belong to the same irreducible representation occur, so check the output carefully). 
                        <pre>symveccheck</pre> solely produces the symmetry vectors and stops. 
                        </xs:documentation>
                    </xs:annotation>
                    <xs:simpleType>
                        <xs:restriction base="xs:string">
                            <xs:enumeration value="fromscratch"/>
                            <xs:enumeration value="fromfile"/>
                            <xs:enumeration value="symvec"/>
                            <xs:enumeration value="symveccheck"/>
                            <xs:enumeration value="readinput"/>
                        </xs:restriction>
                    </xs:simpleType>
               </xs:attribute>
               <xs:attribute ex:importance="expert" ex:unit="" name="mode" type="xs:integer" default="0">
                    <xs:annotation>
                        <xs:documentation>Optionally choose a phonon mode to compute
                        (<inlinemath>4 \leq </inlinemath><pre>mode</pre><inlinemath> \leq 3N_{\mathrm{atm}}</inlinemath>).
                        The default of 0 means compute spectra of all Raman active modes present.
                        </xs:documentation>
                    </xs:annotation>
               </xs:attribute>
               <xs:attribute ex:importance="expert" ex:unit="" name="nstate" type="xs:integer" default="5">
                    <xs:annotation>
                        <xs:documentation>Number of vibrational states to solve for.
                        </xs:documentation>
                    </xs:annotation>
               </xs:attribute>
               <xs:attribute ex:importance="expert" ex:unit="" name="xmin" type="fortrandouble" default="-3.0d0">
                    <xs:annotation>
                        <xs:documentation>Lower boundary of the oscillator problem, give a distance along
                                          the normal coordinate, <inlinemath>|{\bf u}_i |</inlinemath> in Bohr.
                        </xs:documentation>
                    </xs:annotation>
               </xs:attribute>
               <xs:attribute ex:importance="expert" ex:unit="" name="xmax" type="fortrandouble" default="3.0d0">
                    <xs:annotation>
                        <xs:documentation>Upper boundary of the oscillator problem, give a distance along
                                          the normal coordinate, <inlinemath>|{\bf u}_i |</inlinemath> in Bohr.
                        </xs:documentation>
                    </xs:annotation>
               </xs:attribute>
               <xs:attribute ex:importance="expert" ex:unit="" name="ninter" type="xs:integer" default="500">
                    <xs:annotation>
                        <xs:documentation>Number of intervals in numerical (FE) solution of the oscillator problem.
                        </xs:documentation>
                    </xs:annotation>
               </xs:attribute>
               <xs:attribute ex:importance="expert" ex:unit="" name="writefunc" type="xs:boolean" default="false">
                    <xs:annotation>
                        <xs:documentation>If <pre>true</pre> output eigenfunctions of oscillator problem to files.
                        </xs:documentation>
                    </xs:annotation>
               </xs:attribute>
               <xs:attribute ex:importance="expert" ex:unit="" name="nstep" type="xs:integer" default="5">
                    <xs:annotation>
                        <xs:documentation>Create <pre>nstep</pre> distorted geometries
                        to sample the potential and dielectric function.
                        The distortion is done by displacing atoms along normal coordinate by 
                        <inlinemath>n*</inlinemath><attref>displ</attref> with 
                        <inlinemath>-1/2</inlinemath><attref>nstep</attref><inlinemath>\le n\le 1/2</inlinemath><attref>nstep</attref>.
                        </xs:documentation>
                    </xs:annotation>
               </xs:attribute>
               <xs:attribute ex:importance="expert" ex:unit="" name="displ" type="fortrandouble" default="0.02d0">
                    <xs:annotation>
                        <xs:documentation>Step length for each displacement along normal coordinate, <inlinemath>|{\bf u}_i |</inlinemath> in Bohr.
                        For solids, a value of 0.01-0.02 times the number of atoms in the unit cell is often a good choice. In any case
                        check the obtained potential and dielectric functions carefully.
                        </xs:documentation>
                    </xs:annotation>
               </xs:attribute>
               <xs:attribute ex:importance="expert" ex:unit="" name="degree" type="xs:integer" default="2">
                    <xs:annotation>
                        <xs:documentation>Degree of fitting polynomial for the potential. The default of <inlinemath>2</inlinemath>
                        results in a harmonic oscillator.
                        For the dielectric function also a polynomial of degree <attref>degree</attref> is fitted, but
                        only the first derivative used.
                        </xs:documentation>
                    </xs:annotation>
               </xs:attribute>
               <xs:attribute ex:importance="expert" ex:unit="" name="molecule" type="xs:boolean" default="false">
                    <xs:annotation>
                        <xs:documentation>
                        If <pre>true</pre>, an isolated molecule is assumed and some additional output created. 
                        The default of <pre>false</pre> means the
                        calculation is done for the solid state limit.
                        </xs:documentation>
                    </xs:annotation>
               </xs:attribute>
               <xs:attribute ex:importance="expert" ex:unit="" name="usesym" type="xs:boolean" default="true">
                    <xs:annotation>
                        <xs:documentation>
                        Flag wether to use symmetry to analyze the Raman activity of phonon modes prior to
                        running through all computation steps.
                        </xs:documentation>
                    </xs:annotation>
               </xs:attribute>
               <xs:attribute ex:importance="expert" ex:unit="" name="useforces" type="xs:boolean" default="true">
                    <xs:annotation>
                        <xs:documentation>
                        Request the use forces to fit the potential along normal coordinates (if set to <pre>true</pre>),
                        otherwise the total energy will be used (if set to <pre>false</pre>).
                        </xs:documentation>
                    </xs:annotation>
               </xs:attribute>
               <xs:attribute ex:importance="expert" ex:unit="" name="doequilibrium" type="xs:boolean" default="false">
                    <xs:annotation>
                        <xs:documentation>
                        Specifiy whether the true equilibirum geometry should be included in the frozen phonon calculations.
                        On one hand the symmetry of the equilibrium might be higher and the properties slightly changed; 
                        on the other hand the same equilibrium structure is used for all active modes and thus some computer time
                        can be saved. The default is <pre>false</pre>, which means that a close-to-equilibrium structure with the
                        same symmetry as the mode is used. For every mode this is a slightly different structure.
                        </xs:documentation>
                    </xs:annotation>
               </xs:attribute>
               <xs:attribute ex:importance="essential" ex:unit="" name="elaser" type="fortrandouble" default="0.0">
                    <xs:annotation>
                        <xs:documentation>Energy of the incident laser beam. Specify it in units of <attref>elaserunit</attref>
                        </xs:documentation>
                    </xs:annotation>
               </xs:attribute>
               <xs:attribute ex:importance="essential" ex:unit="" name="elaserunit" default="nm">
                    <xs:annotation>
                        <xs:documentation>Units of <pre>elaser</pre>: electron volts, photon wave length in nm, reciprocal centimeters
                        or Hartree.
                        </xs:documentation>
                    </xs:annotation>
                    <xs:simpleType>
                        <xs:restriction base="xs:string">
                            <xs:enumeration value="eV"/>
                            <xs:enumeration value="nm"/>
                            <xs:enumeration value="cm-1"/>
                            <xs:enumeration value="Ha"/>
                        </xs:restriction>
                    </xs:simpleType>
               </xs:attribute>
               <xs:attribute ex:importance="essential" ex:unit="" name="broad" type="fortrandouble" default="10.0d0">
                    <xs:annotation>
                        <xs:documentation>Lorentzian broadening in cm<inlinemath>^{-1}</inlinemath> for simulation of experimental spectra.
                        </xs:documentation>
                    </xs:annotation>
               </xs:attribute>
               <xs:attribute ex:importance="essential" ex:unit="" name="temp" type="fortrandouble" default="298.15">
                    <xs:annotation>
                        <xs:documentation>Temperature in K for which the Raman spectrum is computed. This affects the 
                        occupation of vibrational states.
                        </xs:documentation>
                    </xs:annotation>
               </xs:attribute>
            </xs:complexType>
        </xs:element>

        <xs:element ex:importance="expert" ex:unit="" name="moke" minOccurs="0" maxOccurs="1">
          <xs:complexType>

            <xs:attribute ex:importance="expert" ex:unit="" ref="intraband" default="false">
              <xs:annotation>
                <xs:documentation> Use the intraband term in calculations if the dielectric matrix.</xs:documentation>
              </xs:annotation>
            </xs:attribute>
            
            <xs:attribute ex:importance="essential" ex:unit="" name="wmax" type="fortrandouble" default="0.30">
              <xs:annotation>
                <xs:documentation>Upper energy limit for the Kerr angle calculation.</xs:documentation>
              </xs:annotation>
            </xs:attribute>
            
            <xs:attribute ex:importance="essential" ex:unit="" name="wgrid" type="xs:integer" default="400">
              <xs:annotation>
                <xs:documentation>Number of grid points inside [0,wmax] interval.</xs:documentation>
              </xs:annotation>
            </xs:attribute>

            <xs:attribute ex:importance="expert" ex:unit="" name="swidth" type="fortrandouble" default="0.01d0">
              <xs:annotation>
                <xs:documentation>Broadening factor.</xs:documentation>
              </xs:annotation>
            </xs:attribute>
            
            <xs:attribute ex:importance="expert" ex:unit="" name="scissor" type="fortrandouble" default="0.0d0">
              <xs:annotation>
                <xs:documentation>Scissors operator.</xs:documentation>
              </xs:annotation>
            </xs:attribute>
            
            <xs:attribute ex:importance="expert" ex:unit="" name="drude" type="vect2d" default="0.0d0 0.0d0">
              <xs:annotation>
                  <xs:documentation>
                  Parameters for the Drude term used for calculating the intraband contribution:
                  First value determines the plasma frequency, second - the lifetime broadening.
                  </xs:documentation>
              </xs:annotation>
            </xs:attribute>

            <xs:attribute ex:importance="expert" ex:unit="" name="tevout" type="xs:boolean" default="false">
              <xs:annotation>
                <xs:documentation><pre>"true"</pre> if energy outputs are in eV.</xs:documentation>
              </xs:annotation>
            </xs:attribute>
            
          </xs:complexType>
        </xs:element>        

        <xs:element ex:importance="expert" ex:unit="" name="shg" minOccurs="0">
          <xs:complexType>
            <xs:sequence>
              <xs:element ex:importance="expert" ex:unit="" name="chicomp" type="integertriple" default="1 2 3" maxOccurs="27">
                <xs:annotation>
                  <xs:documentation>The components of the second-order optical tensor Chi(-2w,w,w) to
                    be calculated.</xs:documentation>
                </xs:annotation>
              </xs:element>
            </xs:sequence>
            
            <xs:attribute ex:importance="essential" ex:unit="" name="wmax" type="fortrandouble" default="0.3">
              <xs:annotation>
                <xs:documentation>Upper energy limit for SHG calculations.</xs:documentation>
              </xs:annotation>
            </xs:attribute>
            
            <xs:attribute ex:importance="essential" ex:unit="" name="wgrid" type="xs:integer" default="400">
              <xs:annotation>
                <xs:documentation>Number of grid points inside [0,emax] interval.</xs:documentation>
              </xs:annotation>
            </xs:attribute>

            <xs:attribute ex:importance="expert" ex:unit="" name="swidth" type="fortrandouble" default="0.01d0">
              <xs:annotation>
                <xs:documentation>Broadening factor.</xs:documentation>
              </xs:annotation>
            </xs:attribute>
            
            <xs:attribute ex:importance="expert" ex:unit="" name="scissor" type="fortrandouble" default="0.0d0">
              <xs:annotation>
                <xs:documentation>Scissors operator.</xs:documentation>
              </xs:annotation>
            </xs:attribute>
            
            <xs:attribute ex:importance="expert" ex:unit="" name="etol" type="fortrandouble" default="0.004d0">
              <xs:annotation>
                <xs:documentation>Tolerence factor (to avoid singularities).</xs:documentation>
              </xs:annotation>
            </xs:attribute>
            
         
            <xs:attribute ex:importance="expert" ex:unit="" name="tevout" type="xs:boolean" default="false">
              <xs:annotation>
                <xs:documentation><pre>"true"</pre> if energy outputs are in eV.</xs:documentation>
              </xs:annotation>
            </xs:attribute>

          </xs:complexType>
        </xs:element>

      </xs:all>
    </xs:complexType>
  </xs:element>
  <xs:annotation>
    <xs:appinfo>
      <parent>/input</parent>
      <root>xs</root>
    </xs:appinfo>
  </xs:annotation>
  <xs:element ex:importance="expert" ex:unit="" name="xs">
    <xs:annotation>
      <xs:documentation> If this element is present with valid configuration, the macroscopic
        dielectric function and related spectroscopic quantities in the linear regime are calculated
        through either time-dependent DFT (TDDFT) or the Bethe-Salpeter equation
        (BSE).</xs:documentation>
    </xs:annotation>
    <xs:complexType>
      <xs:all>
	<xs:element ex:importance="expert" ex:unit="" name="storeexcitons" minOccurs="0" maxOccurs="1">
	  <xs:annotation>
            <xs:documentation>When present this element allows to store the exciton components (BSE eigenvectors).
	    The number of stored excitons starting from the lowest energy one is given by the attribute
	    <attref>MaxNumberExcitons</attref>.</xs:documentation>
          </xs:annotation>
          <xs:complexType>
	    <xs:attribute ex:importance="expert" ex:unit="" name="MinNumberExcitons" type="xs:integer" default="1">
	      <xs:annotation>
	        <xs:documentation>It represents the lower limit of the number of stored excitons.</xs:documentation>
	      </xs:annotation>
            </xs:attribute>
            <xs:attribute ex:importance="expert" ex:unit="" name="MaxNumberExcitons" type="xs:integer" default="10">
	      <xs:annotation>
	        <xs:documentation>It represents the upper limit of the number of stored excitons.</xs:documentation>
	      </xs:annotation>
            </xs:attribute>
          </xs:complexType>
        </xs:element>

        <xs:element ex:importance="expert" ex:unit="" name="writeexcitons" minOccurs="0" maxOccurs="1">
          <xs:annotation>
            <xs:documentation>When present this element allows to write the stored exciton components (BSE eigenvectors) 
            to ASCII files. The range of excitons must lie within the stored range given by the attributes in the 
            element storeexcitons. 
            </xs:documentation>
          </xs:annotation>
          <xs:complexType>
            <xs:attribute ex:importance="expert" ex:unit="" name="MinNumberExcitons" type="xs:integer" default="1">
              <xs:annotation>
                <xs:documentation>It represents the lower limit of the number of written excitons.
                </xs:documentation>
              </xs:annotation>
            </xs:attribute>
            <xs:attribute ex:importance="expert" ex:unit="" name="MaxNumberExcitons" type="xs:integer" default="10">
              <xs:annotation>
                <xs:documentation>It represents the upper limit of the number of written excitons.
                </xs:documentation>
              </xs:annotation>
            </xs:attribute>
          </xs:complexType>
        </xs:element>


        <xs:element ex:importance="expert" ex:unit="" name="excitonPlot" minOccurs="0" maxOccurs="1">
          <xs:annotation>
            <xs:documentation>Parameters for the electron-hole visualization.</xs:documentation>
          </xs:annotation>
          <xs:complexType>
            <xs:sequence>

              <xs:element ex:importance="expert" ex:unit="" name="exciton" minOccurs="0" maxOccurs="unbounded">
                <xs:annotation>
                  <xs:documentation>Electron-hole pair descriptor.</xs:documentation>
                </xs:annotation>
                <xs:complexType>
                  <xs:attribute ex:importance="essential" ex:unit="" name="lambda" type="xs:integer" default="1">
                    <xs:annotation>
                    <xs:documentation>
                      The index of the stored exciton.
                    </xs:documentation>
                    </xs:annotation>
                  </xs:attribute>
                  <xs:attribute ex:importance="essential" ex:unit="" name="fix" type="xs:string" default="hole">
                    <xs:annotation>
                    <xs:documentation>
                      Fix position (in lattice coordinates) either of the "hole" or "electron".
                    </xs:documentation>
                    </xs:annotation>
                  </xs:attribute>
                </xs:complexType>
              </xs:element>

              <xs:element ex:importance="expert" ex:unit="" name="hole" minOccurs="1" maxOccurs="1">
                <xs:annotation>
                <xs:documentation>
                  For the exciton wavefunction visualization: Real space grid for the hole distribution.
                </xs:documentation>
                </xs:annotation>
                <xs:complexType>
                <xs:all>
                  <xs:element ex:importance="expert" ex:unit="" ref="plot1d" minOccurs="0" maxOccurs="1"/>
                  <xs:element ex:importance="expert" ex:unit="" ref="plot2d" minOccurs="0" maxOccurs="1"/>
                  <xs:element ex:importance="expert" ex:unit="" ref="plot3d" minOccurs="0" maxOccurs="1"/>
                </xs:all>
                </xs:complexType>
              </xs:element>

              <xs:element ex:importance="expert" ex:unit="" name="electron" minOccurs="1" maxOccurs="1">
                <xs:annotation>
                <xs:documentation>
                  For the exciton wavefunction visualization: Real space grid for the electron distribution.
                </xs:documentation>
                </xs:annotation>
                <xs:complexType>
                <xs:all>
                  <xs:element ex:importance="expert" ex:unit="" ref="plot1d" minOccurs="0" maxOccurs="1"/>
                  <xs:element ex:importance="expert" ex:unit="" ref="plot2d" minOccurs="0" maxOccurs="1"/>
                  <xs:element ex:importance="expert" ex:unit="" ref="plot3d" minOccurs="0" maxOccurs="1"/>
                </xs:all>
                </xs:complexType>
              </xs:element>

            </xs:sequence>
            
            <xs:attribute ex:importance="expert" ex:unit="" name="epstol" type="fortrandouble" default="1.0d-4">
              <xs:annotation>
                <xs:documentation>Threshold value for selecting states which contribute to the exciton.</xs:documentation>
              </xs:annotation>
            </xs:attribute>
            
          </xs:complexType>
        </xs:element>

        <xs:element ex:importance="expert" ex:unit="" name="tddft" minOccurs="0" maxOccurs="1">
          <xs:complexType>
            <xs:attribute ex:importance="expert" ex:unit="" name="ahc" type="xs:boolean" default="false">
              <xs:annotation>
                <xs:documentation> By setting it to <pre>"true"</pre>, the anomalous Hall conductivity (AHC)
                  term is included in the calculation of the dielectric tensor [see PRB 86, 125139 (2012)]. 
		  In this case, the MOKE.OUT output file is generated, containing the MOKE spectrum. 
		  This attribute only has effect when local field effects are neglected (gqmax=0) and q=0. 
		</xs:documentation>
              </xs:annotation>
            </xs:attribute>
            <xs:attribute ex:importance="expert" ex:unit="" ref="intraband" default="false">
              <xs:annotation>
                <xs:documentation> By setting it to <pre>"true"</pre>, the intraband
                  contribution is included in the calculation for the finite q. 
		</xs:documentation>
              </xs:annotation>
            </xs:attribute>
            <xs:attribute ex:importance="expert" ex:unit="" name="drude" type="vect2d" default="0.0d0 0.0d0">
              <xs:annotation>
                  <xs:documentation>
		    Parameters defining semiclassical Drude approximation to intraband term. The first
		    value determines the plasma frequency <inlinemath>\omega_p</inlinemath> and the second the inverse relaxation time
		    <inlinemath>\omega_{\tau}</inlinemath>:<inlinemath>\chi_0^D=\frac{1}{\omega}\frac{\omega_p^2}{\omega+i\omega_{\tau}}</inlinemath>
                  </xs:documentation>
              </xs:annotation>
            </xs:attribute>
            <xs:attribute ex:importance="expert" ex:unit="" name="torddf" type="xs:boolean" default="false">
              <xs:annotation>
                <xs:documentation> Set to <pre>"true"</pre> if to consider the time-ordered version
                  of the dielectric function. </xs:documentation>
              </xs:annotation>
            </xs:attribute>
            <xs:attribute ex:importance="expert" ex:unit="" name="tordfxc" type="xs:boolean" default="false">
              <xs:annotation>
                <xs:documentation> Set to <pre>"true"</pre> if to consider the time-ordered version
                  of xc kernel (MBPT derived kernels only). </xs:documentation>
              </xs:annotation>
            </xs:attribute>
            <xs:attribute ex:importance="expert" ex:unit="" name="aresdf" type="xs:boolean" default="true">
              <xs:annotation>
                <xs:documentation> Set to <pre>"true"</pre> if to consider the anti-resonant part
                  for the dielectric function. </xs:documentation>
              </xs:annotation>
            </xs:attribute>
            <xs:attribute ex:importance="expert" ex:unit="" name="aresfxc" type="xs:boolean" default="true">
              <xs:annotation>
                <xs:documentation> Set to <pre>"true"</pre> if to consider the anti-resonant part
                  for the MBPT derived xc-kernels. </xs:documentation>
              </xs:annotation>
            </xs:attribute>
            <xs:attribute ex:importance="expert" ex:unit="Hartree" name="fxcbsesplit" type="fortrandouble" default="1.0d-5">
              <xs:annotation>
                <xs:documentation>Split parameter for degeneracy in energy differences of MBPT
                  derived xc kernels. See A. Marini, Phys. Rev. Lett., 91, (2003)
                  256402.</xs:documentation>
              </xs:annotation>
            </xs:attribute>
            <xs:attribute ex:importance="expert" ex:unit="" name="acont" type="xs:boolean" default="false">
              <xs:annotation>
                <xs:documentation>Set to <pre>"true"</pre> if analytic continuation from the
                  imaginary axis to the real axis is to be performed.</xs:documentation>
              </xs:annotation>
            </xs:attribute>
            <xs:attribute ex:importance="expert" ex:unit="" name="nwacont" type="xs:integer" default="0">
              <xs:annotation>
                <xs:documentation>Number of energy intervals (on imaginary axis) for analytic
                  continuation.</xs:documentation>
              </xs:annotation>
            </xs:attribute>
            <xs:attribute ex:importance="expert" ex:unit="" name="lindhard" type="xs:boolean" default="false">
              <xs:annotation>
                <xs:documentation> Set to <pre>"true"</pre> if Lindhard-like function is to be
                  calculated. </xs:documentation>
              </xs:annotation>
            </xs:attribute>
            <xs:attribute ex:importance="expert" ex:unit="" name="kerndiag" type="xs:boolean" default="false">
              <xs:annotation>
                <xs:documentation> Set to <pre>"true"</pre> if only diagonal part of xc-kernel is to
                  be used. </xs:documentation>
              </xs:annotation>
            </xs:attribute>
            <xs:attribute ex:importance="expert" ex:unit="" name="lmaxalda" type="xs:integer" default="3">
              <xs:annotation>
                <xs:documentation>Angular momentum cutoff for Rayleigh expansion of exponential
                  factor for ALDA-kernel.</xs:documentation>
              </xs:annotation>
            </xs:attribute>
            <xs:attribute ex:importance="expert" ex:unit="" name="alphalrc" type="fortrandouble" default="0.0d0">
              <xs:annotation>
                <xs:documentation><inlinemath>\alpha</inlinemath>-parameter for the static long
                  range contribution (LRC) model xc kernel.</xs:documentation>
              </xs:annotation>
            </xs:attribute>
            <xs:attribute ex:importance="expert" ex:unit="" name="alphalrcdyn" type="fortrandouble" default="0.0d0">
              <xs:annotation>
                <xs:documentation><inlinemath>\alpha</inlinemath>-parameter for the dynamical long
                  range contribution (LRC) model xc kernel.</xs:documentation>
              </xs:annotation>
            </xs:attribute>
            <xs:attribute ex:importance="expert" ex:unit="" name="betalrcdyn" type="fortrandouble" fixed="0.0d0">
              <xs:annotation>
                <xs:documentation><inlinemath>\beta</inlinemath>-parameter for the dynamical long
                  range contribution (LRC) model xc kernel.</xs:documentation>
              </xs:annotation>
            </xs:attribute>
            <xs:attribute ex:importance="expert" ex:unit="" name="mdfqtype" type="xs:integer" default="0">
              <xs:annotation>
                <xs:documentation> Treatment of macroscopic dielectric function for <inlinemath>{\bf
                    Q}</inlinemath>-point outside of Brillouin zone. A value of 0 uses the full
                    <inlinemath>{\bf Q}</inlinemath> and the <inlinemath>({\bf 0},{\bf
                    0})</inlinemath> component of the microscopic dielectric matrix is used. A
                  value of 1 invokes a decomposition <inlinemath>{\bf Q}={\bf q}+{\bf G}_{\bf
                    q}</inlinemath> and the <inlinemath>({\bf Q}_{\bf q},{\bf Q}_{\bf
                    q})</inlinemath> component of the microscopic dielectric matrix is used.
                </xs:documentation>
              </xs:annotation>
            </xs:attribute>
            <xs:attribute ex:importance="expert" ex:unit="" name="fxctype" default="RPA">
              <xs:annotation>
                <xs:documentation>Defines which xc kernel is to be used. Examples on the use of the
		different kernels can be found online on the Tutorial "TDDFT Calculations with Different Kernels"
		on www.exciting-code.org.
		In the options indicated below, if the suffix <pre>"_NLF"</pre> is present, then 
		local-field effects are neglected (scalar kernel). Otherwise the kernel 
		is a matrix of the size of the number of <inlinemath>\mathbf{G}</inlinemath>-vectors, 
		whose diagonal elements are all equal. The available kernels <inlinemath>f_{xc}</inlinemath> are:
		<list>
		  <li><pre>"RPA"</pre> -
		  Random-phase approximation kernel. <inlinemath>f_{xc}=0</inlinemath>
		  </li>
		  <li><pre>"LRCstatic[_NLF]"</pre> -
		  Long-range correction kernel. 
		  <displaymath>
		    f_{xc}=-\frac{\alpha}{\mathbf{q}^2}.
		  </displaymath>
		  See S. Botti et al., Phys. Rev. B 69, 155112 (2004)
		  </li>
		  <li><pre>"LRCdyn[_NLF]"</pre> -
		  Dynamical long-range correction kernel. 
		  <displaymath>
		    f_{xc}=-\frac{\alpha+\beta \omega^2}{\mathbf{q}^2}
		  </displaymath>
		  with <inlinemath>\alpha</inlinemath> given by the value of <attref>alphalrcdyn</attref>
		  and <inlinemath>\beta</inlinemath> given by the value of <attref>betalrcdyn</attref>.
		  See S. Botti et al., Phys. Rev. B 72, 125203 (2005)
		  </li>
		  <li><pre>"ALDA"</pre> -
		  Adiabatic LDA kernel. 
		  <displaymath>
		    f_{xc}(\mathbf{r},\mathbf{r}',t-t')=\frac{\delta V_{xc}(\mathbf{r})}{\delta n(\mathbf{r}')}\delta(t-t').
		  </displaymath>
		  In this implementation, <inlinemath>V_{xc}(\mathbf{r})</inlinemath> is the spin-unpolarised 
		  exchange-correlation potential corresponding to the Perdew-Wang parameterisation 
		  of Ceperley-Alder's Monte-Carlo data (see Phys. Rev. B 45, 13244 (1992) and Phys. Rev. Lett. 45, 566 (1980)).
		  </li>
		  <li><pre>"MB1[_NLF]"</pre> -
		  BSE derived xc kernel. See L. Reining et al., Phys. Rev. Lett. 88, 066404 (2002) 
		  and A. Marini et al., Phys. Rev. Lett. 91, 256402 (2003).
		  </li>
		  <li><pre>"BO"</pre> -
		  Bootstrap kernel.   
		  <displaymath>
		    f_{xc}=\frac{\varepsilon^{-1}(\omega=0)}{\chi_{00}(\omega=0)}.
		  </displaymath>
		  See S. Sharma et al., Phys. Rev. Lett. 107, 186401 (2011).
		  </li>
		  <li><pre>"BO_SCALAR"</pre> -
		  Scalar version of the bootstrap kernel. <inlinemath>
		    f_{xc}=\left[\varepsilon_M(\omega=0)\chi_{00}(\omega=0)\right]^{-1}
		  </inlinemath>. See S. Sharma et al., Phys. Rev. Lett. 107, 186401 (2011).
		  </li>
		  <li><pre>"RBO"</pre> -
		  RPA bootstrap kernel. <inlinemath>
		    f_{xc}=\left[\varepsilon^{RPA}_M(\omega=0)\overline{\chi}_{00}^{RPA}(\omega=0)\right]^{-1}
		  </inlinemath>. See S. Rigamonti et al., Phys. Rev. Lett. 114, 146402 (2015).
		  </li>
		</list>
		</xs:documentation>
              </xs:annotation>
              <xs:simpleType>
                <xs:restriction base="xs:string">
                  <xs:enumeration value="RPA">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr>0</oldnr>
                      </xs:appinfo>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="LRCstatic_NLF">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr>1</oldnr>
                      </xs:appinfo>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="LRCstatic">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr>2</oldnr>
                      </xs:appinfo>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="LRCdyn_NLF">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr>3</oldnr>
                      </xs:appinfo>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="LRCdyn">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr>4</oldnr>
                      </xs:appinfo>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="ALDA">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr>5</oldnr>
                      </xs:appinfo>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="MB1_NLF">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr>7</oldnr>
                      </xs:appinfo>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="MB1">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr>8</oldnr>
                      </xs:appinfo>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="BO">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr>9</oldnr>
                      </xs:appinfo>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="BO_SCALAR">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr>10</oldnr>
                      </xs:appinfo>
                    </xs:annotation>
                  </xs:enumeration>
                  <xs:enumeration value="RBO">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldnr>11</oldnr>
                      </xs:appinfo>
                    </xs:annotation>
                  </xs:enumeration>
                </xs:restriction>
              </xs:simpleType>
            </xs:attribute>
            <xs:attribute ex:importance="expert" ex:unit="" name="do" default="fromscratch">
              <xs:annotation>
                <xs:appinfo>
                  <oldname>nonreplace</oldname>
                </xs:appinfo>
                <xs:documentation> Decides if the TDDFT calculation is to be resumed starting from a
                  new xc kernel or is to be skipped. </xs:documentation>
              </xs:annotation>
              <xs:simpleType>
                <xs:restriction base="xs:string">
                  <xs:enumeration value="fromscratch"/>
                  <xs:enumeration value="fromkernel"/>
                </xs:restriction>
              </xs:simpleType>
            </xs:attribute>
          </xs:complexType>
        </xs:element>
        <xs:element ex:importance="expert" ex:unit="" name="screening" minOccurs="0" maxOccurs="1">
          <xs:complexType>
            <xs:attribute ex:importance="expert" ex:unit="" name="do" default="fromscratch">
              <xs:annotation>
                <xs:appinfo>
                  <oldname>nonreplace</oldname>
                </xs:appinfo>
                <xs:documentation> Decides if the calculation of the screening is done from scratch
                  or is to be skipped.</xs:documentation>
              </xs:annotation>
              <xs:simpleType>
                <xs:restriction base="xs:string">
                  <xs:enumeration value="fromscratch"/>
                  <xs:enumeration value="skip"/>
                </xs:restriction>
              </xs:simpleType>
            </xs:attribute>
            <xs:attribute ex:importance="expert" ex:unit="" name="nosym" type="xs:boolean" default="false">
              <xs:annotation>
                <xs:appinfo>
                  <oldname>nosymscr</oldname>
                </xs:appinfo>
                <xs:documentation>
                  <attref>nosym</attref> is <pre>"true"</pre> if no symmetry information should be used
                  for screening. </xs:documentation>
              </xs:annotation>
            </xs:attribute>
            <xs:attribute ex:importance="expert" ex:unit="" name="ngridk" type="integertriple" default="0 0 0">
              <xs:annotation>
                <xs:appinfo>
                  <oldname>ngridkscr</oldname>
                </xs:appinfo>
                <xs:documentation><inlinemath>{\mathbf k}</inlinemath>-point grid sizes for screening.</xs:documentation>
              </xs:annotation>
            </xs:attribute>
            <xs:attribute ex:importance="expert" ex:unit="" name="reducek" type="xs:boolean" default="false">
              <xs:annotation>
                <xs:appinfo>
                  <oldname>reducekscr</oldname>
                </xs:appinfo>
                <xs:documentation>
                  <attref>reducek</attref> is <pre>"true"</pre> if <inlinemath>{\mathbf k}</inlinemath>-points are to be reduced with crystal
                  symmetries for screening. </xs:documentation>
              </xs:annotation>
            </xs:attribute>
            <xs:attribute ex:importance="expert" ex:unit="" name="vkloff" type="vect3d" default="-1.0d0 -1.0d0 -1.0d0">
              <xs:annotation>
                <xs:appinfo>
                  <oldname>vkloffscr</oldname>
                </xs:appinfo>
                <xs:documentation><inlinemath>{\mathbf k}</inlinemath>-point offset for screening.</xs:documentation>
              </xs:annotation>
            </xs:attribute>
            <xs:attribute ex:importance="expert" ex:unit="" name="rgkmax" type="fortrandouble" default="0.0d0">
              <xs:annotation>
                <xs:appinfo>
                  <oldname>rgkmaxscr</oldname>
                </xs:appinfo>
                <xs:documentation>The smallest muffin-tin radius times <pre>gkmax</pre> for
                  screening.</xs:documentation>
              </xs:annotation>
            </xs:attribute>
            <xs:attribute ex:importance="expert" ex:unit="" name="nempty" type="xs:integer" default="0">
              <xs:annotation>
                <xs:appinfo>
                  <oldname>nemptyscr</oldname>
                </xs:appinfo>
                <xs:documentation>Number of empty states.</xs:documentation>
              </xs:annotation>
            </xs:attribute>
            <xs:attribute ex:importance="expert" ex:unit="" name="screentype" default="full">
              <xs:annotation>
                <xs:documentation>Defines which type of screening is to be used.</xs:documentation>
              </xs:annotation>
              <xs:simpleType>
                <xs:restriction base="xs:string">
                  <xs:enumeration value="full"/>
                  <xs:enumeration value="diag"/>
                  <xs:enumeration value="noinvdiag"/>
                  <xs:enumeration value="longrange"/>
                </xs:restriction>
              </xs:simpleType>
            </xs:attribute>
          </xs:complexType>
        </xs:element>
        <xs:element ex:importance="expert" ex:unit="" name="BSE" minOccurs="0" maxOccurs="1">
          <xs:complexType>
            <xs:attribute ex:importance="expert" ex:unit="" name="nosym" type="xs:boolean" default="false">
              <xs:annotation>
                <xs:appinfo>
                  <oldname>nosymbse</oldname>
                </xs:appinfo>
                <xs:documentation> Set to <pre>"true"</pre> if no symmetry information should be
                  used for BSE. </xs:documentation>
              </xs:annotation>
            </xs:attribute>
            <xs:attribute ex:importance="expert" ex:unit="" name="xas" type="xs:boolean" default="false">
              <xs:annotation>
                <xs:documentation> Set to <pre>"true"</pre> to perform BSE X-rasy absorption spectroscopy (XAS) calculation </xs:documentation>
              </xs:annotation>
            </xs:attribute>
            <xs:attribute ex:importance="expert" ex:unit="" name="xasspecies" type="xs:integer" default="0">
              <xs:annotation>
                <xs:documentation>Species number for which the XAS is calculated.</xs:documentation>
              </xs:annotation>
            </xs:attribute>
            <xs:attribute ex:importance="expert" ex:unit="" name="xasatom" type="xs:integer" default="0">
              <xs:annotation>
                <xs:documentation>Atom number for which the XAS is calculated.</xs:documentation>
              </xs:annotation>
            </xs:attribute>
            <xs:attribute ex:importance="expert" ex:unit="" name="xasedge" default="K">
              <xs:annotation>
                <xs:documentation>Defines the initial states of the XAS calculation.</xs:documentation>
              </xs:annotation>
              <xs:simpleType>
                <xs:restriction base="xs:string">
                  <xs:enumeration value="K"/>
                  <xs:enumeration value="L1"/>
                  <xs:enumeration value="L2"/>
                  <xs:enumeration value="L3"/>
                  <xs:enumeration value="L23"/>
                  <xs:enumeration value="M1"/>
                  <xs:enumeration value="M2"/>
                  <xs:enumeration value="M3"/>
                  <xs:enumeration value="M23"/>
                  <xs:enumeration value="M4"/>
                  <xs:enumeration value="M5"/>
                  <xs:enumeration value="M45"/>
                </xs:restriction>
              </xs:simpleType>
            </xs:attribute>

            <xs:attribute ex:importance="expert" ex:unit="" name="reducek" type="xs:boolean" default="false">
              <xs:annotation>
                <xs:appinfo>
                  <oldname>reducekbse</oldname>
                </xs:appinfo>
                <xs:documentation>
                  <attref>reducek</attref> is <pre>"true"</pre> if <inlinemath>{\mathbf k}</inlinemath>-points are to be reduced with crystal
                  symmetries for BSE. </xs:documentation>
              </xs:annotation>
            </xs:attribute>
            <xs:attribute ex:importance="expert" ex:unit="" name="vkloff" type="vect3d" default="-1.0d0 -1.0d0 -1.0d0">
              <xs:annotation>
                <xs:appinfo>
                  <oldname>vkloffbse</oldname>
                </xs:appinfo>
                <xs:documentation><inlinemath>{\mathbf k}</inlinemath>-point offset for BSE.</xs:documentation>
              </xs:annotation>
            </xs:attribute>
            <xs:attribute ex:importance="expert" ex:unit="" name="rgkmax" type="fortrandouble" default="0.0d0">
              <xs:annotation>
                <xs:appinfo>
                  <oldname>rgkmaxbse</oldname>
                </xs:appinfo>
                <xs:documentation>Smallest muffin-tin radius times
                  <pre>gkmax</pre>.</xs:documentation>
              </xs:annotation>
            </xs:attribute>
            <xs:attribute ex:importance="expert" ex:unit="" name="scrherm" type="xs:integer" default="0">
              <xs:annotation>
                <xs:documentation> Method of how an almost Hermitian matrix is inverted. A value of
                  0: invert full matrix (matrix is allowed to be not strictly Hermitian); a value of
                  1: take the Hermitian average for inversion; a value of 2: assume Hermitian and
                  use the upper triangle; a value of 3: assume Hermitian and use the lower
                  triangle.</xs:documentation>
              </xs:annotation>
            </xs:attribute>
            <xs:attribute ex:importance="expert" ex:unit="" name="fbzq" type="xs:boolean" default="false">
              <xs:annotation>
                <xs:documentation>Set to <pre>"true"</pre> if q-point set is to be taken from the
                  first Brillouin zone.</xs:documentation>
              </xs:annotation>
            </xs:attribute>
            <xs:attribute ex:importance="expert" ex:unit="" name="sciavtype" default="spherical">
              <xs:annotation>
                <xs:documentation> Defines how the screened Coulomb interaction matrix is to be
                  averaged (important for the singular terms). </xs:documentation>
              </xs:annotation>
              <xs:simpleType>
                <xs:restriction base="xs:string">
                  <xs:enumeration value="spherical"/>
                  <xs:enumeration value="screendiag"/>
                  <xs:enumeration value="invscreendiag"/>
                </xs:restriction>
              </xs:simpleType>
            </xs:attribute>
            <xs:attribute ex:importance="expert" ex:unit="" name="sciavbd" type="xs:boolean" default="true">
              <xs:annotation>
                <xs:documentation>
                  <pre>"true"</pre> if the body of the screened Coulomb interaction is to be
                  averaged (q=0). </xs:documentation>
              </xs:annotation>
            </xs:attribute>
            <xs:attribute ex:importance="expert" ex:unit="" name="sciavqhd" type="xs:boolean" default="false">
              <xs:annotation>
                <xs:documentation>
                  <pre>"true"</pre> if the head of the screened Coulomb interaction is to be
                  averaged (q!=0). </xs:documentation>
              </xs:annotation>
            </xs:attribute>
            <xs:attribute ex:importance="expert" ex:unit="" name="sciavqwg" type="xs:boolean" default="false">
              <xs:annotation>
                <xs:documentation>
                  <pre>"true"</pre> if the wings of the screened Coulomb interaction are to be
                  averaged (q!=0). </xs:documentation>
              </xs:annotation>
            </xs:attribute>
            <xs:attribute ex:importance="expert" ex:unit="" name="sciavqbd" type="xs:boolean" default="false">
              <xs:annotation>
                <xs:documentation>
                  <pre>"true"</pre> if the body of the screened Coulomb interaction is to be
                  averaged (q!=0). </xs:documentation>
              </xs:annotation>
            </xs:attribute>
            <xs:attribute ex:importance="expert" ex:unit="" name="bsedirsing" type="xs:boolean" default="false">
              <xs:annotation>
                <xs:documentation><pre>"true"</pre> if effective singular part of direct term of BSE
                  Hamiltonian is to be used.</xs:documentation>
              </xs:annotation>
            </xs:attribute>
            <xs:attribute ex:importance="expert" ex:unit="" name="lmaxdielt" type="xs:integer" default="14">
              <xs:annotation>
                <xs:documentation>Angular momentum cutoff of the spherical harmonics expansion of
                  the dielectric matrix.</xs:documentation>
              </xs:annotation>
            </xs:attribute>
            <xs:attribute ex:importance="expert" ex:unit="" name="nleblaik" type="xs:integer" default="5810">
              <xs:annotation>
                <xs:documentation>Number of points used for the Lebedev-Laikov grids must be
                  selected according to V.I. Lebedev, and D.N. Laikov, Doklady Mathematics, 59
                  (1999) 477.</xs:documentation>
              </xs:annotation>
            </xs:attribute>
            <xs:attribute ex:importance="expert" ex:unit="" name="nexcitmax" type="xs:integer" default="100">
              <xs:annotation>
                <xs:documentation>Maximum number of excitons to be considered in a BSE
                  calculation.</xs:documentation>
              </xs:annotation>
            </xs:attribute>
            <xs:attribute ex:importance="expert" ex:unit="" name="nstlbse" type="integerquadrupel" default="0 0 0 0">
              <xs:annotation>
                <xs:appinfo>
                  <oldname>nbfbse,nafbse</oldname>
                </xs:appinfo>
                <xs:documentation>Range of bands included for the BSE calculation. The first pair of
                  numbers corresponds to the band index for local orbitals and valence states
                  (counted from the lowest eigenenergy), the second pair corresponds to the band
                  index of the conduction states (counted from the Fermi level).</xs:documentation>
              </xs:annotation>
            </xs:attribute>
            <xs:attribute ex:importance="expert" ex:unit="" name="nstlxas" type="integerpair" default="0 0">
              <xs:annotation>
                <xs:appinfo>
                  <oldname>nbfbse,nafbse</oldname>
                </xs:appinfo>
                <xs:documentation>Range of bands included for the BSE calculation. The pair corresponds to the band
                  index of the conduction states (counted from the Fermi level).</xs:documentation>
              </xs:annotation>
            </xs:attribute>

            <xs:attribute ex:importance="expert" ex:unit="" name="aresbse" type="xs:boolean" default="true">
              <xs:annotation>
                <xs:documentation> Is set to <pre>"true"</pre> if to consider the anti-resonant part
                  for the BSE spectrum. </xs:documentation>
              </xs:annotation>
            </xs:attribute>
            <xs:attribute ex:importance="expert" ex:unit="" name="bsetype" default="singlet">
              <xs:annotation>
                <xs:documentation>Defines which parts of the BSE Hamiltonian are to be
                  considered.</xs:documentation>
              </xs:annotation>
              <xs:simpleType>
                <xs:restriction base="xs:string">
                  <xs:enumeration value="IP"/>
                  <xs:enumeration value="RPA"/>
                  <xs:enumeration value="singlet"/>
                  <xs:enumeration value="triplet"/>
                </xs:restriction>
              </xs:simpleType>
            </xs:attribute>
            <xs:attribute ex:importance="expert" ex:unit="" name="ngridksub" type="integertriple" default="1 1 1">
              <xs:annotation>
                <xs:documentation> The sub-grid of a BSE double grid run. Any value larger than
                1 triggers a computation following this scheme: the BSE is solved several times on coarse
                grids, as given by <attref>ngridk</attref> and <attref>ngridq</attref>, which are shifted
                to all symmetry non-equivalent points of the sub-grid. The latter are distributed
                uniformly between the k-points of the coarse grid. The final results are obtained by
                averaging all the spectra yielded in this way, what is expected to be almost as good as
                solving the BSE on the fine grid, at much less computational cost. 
                </xs:documentation>
              </xs:annotation>
            </xs:attribute>
          </xs:complexType>
        </xs:element>
        <xs:element ex:importance="expert" ex:unit="" name="transitions" minOccurs="0" maxOccurs="1">
          <xs:annotation>
            <xs:documentation>Describe transitions between Kohn-Sham states for the calculation of
              the Kohn-Sham response function (and screening) here. Individual transitions as well
              as a range (or a list) of initial and final states can be defined.</xs:documentation>
          </xs:annotation>
          <xs:complexType>
            <xs:all>
              <xs:element ex:importance="expert" ex:unit="" name="individual" minOccurs="0" maxOccurs="1">
                <xs:annotation>
                  <xs:documentation>A list of individual transitions consisting of an initial state
                    a final state and a <inlinemath>{\mathbf k}</inlinemath>-point is given here. If the list is empty, no transitions
                    are considered.</xs:documentation>
                </xs:annotation>
                <xs:complexType>
                  <xs:sequence>
                    <xs:element ex:importance="expert" ex:unit="" name="trans" minOccurs="0" maxOccurs="unbounded">
                      <xs:annotation>
                        <xs:documentation> An individual transition consisting of an initial state a
                          final state and a <inlinemath>{\mathbf k}</inlinemath>-point is given here. Values of zero correspond to the
                          inclusion of all initial and final states and all <inlinemath>{\mathbf k}</inlinemath>-points and can be used
                          as "wildcards" (default). Therefore, an empty element amounts to include
                          all transitions.</xs:documentation>
                      </xs:annotation>
                      <xs:complexType>
                        <xs:attribute ex:importance="expert" ex:unit="" ref="action" use="optional" default="include">
                          <xs:annotation>
                            <xs:documentation>Select to include or exclude states. If a state is
                              included as well as excluded several times the last definition (in the
                              sequence of individual transitions) counts.</xs:documentation>
                          </xs:annotation>
                        </xs:attribute>
                        <xs:attribute ex:importance="expert" ex:unit="" name="kpointnumber" type="xs:integer" default="0">
                          <xs:annotation>
                            <xs:documentation>Number of <inlinemath>{\mathbf k}</inlinemath>-points to be considered. A value of zero
                              (default) means to include all <inlinemath>{\mathbf k}</inlinemath>-points. </xs:documentation>
                          </xs:annotation>
                        </xs:attribute>
                        <xs:attribute ex:importance="expert" ex:unit="" name="initial" type="xs:integer" default="0">
                          <xs:annotation>
                            <xs:documentation>Initial state of individual transition. A value of
                              zero (default) means to include all states. </xs:documentation>
                          </xs:annotation>
                        </xs:attribute>
                        <xs:attribute ex:importance="expert" ex:unit="" name="final" type="xs:integer" default="0">
                          <xs:annotation>
                            <xs:documentation>Final state of individual transition. A value of zero
                              (default) means to include all states. </xs:documentation>
                          </xs:annotation>
                        </xs:attribute>
                      </xs:complexType>
                    </xs:element>
                  </xs:sequence>
                </xs:complexType>
              </xs:element>
              <xs:element ex:importance="expert" ex:unit="" name="ranges" minOccurs="0" maxOccurs="1">
                <xs:annotation>
                  <xs:documentation>A list of ranges of transitions (initial state as well as final
                    state ranges) and a <inlinemath>{\mathbf k}</inlinemath>-point are given here. An empty list amounts to no
                    transitions at all.</xs:documentation>
                </xs:annotation>
                <xs:complexType>
                  <xs:sequence>
                    <xs:element ex:importance="expert" ex:unit="" name="range" minOccurs="0" maxOccurs="unbounded">
                      <xs:annotation>
                        <xs:documentation>A range of transitions (for initial as well as final
                          states) is given here. A range consists of a "start" and a "stop" values
                          as well as a <inlinemath>{\mathbf k}</inlinemath>-point. Values of zero correspond to starting at the first
                          state and stopping at the last state and considering all <inlinemath>{\mathbf k}</inlinemath>-points. They
                          can be used as "wildcards" (default). Therefore, an empty element
                          corresponds to the full initial/final state range for all
                          <inlinemath>{\mathbf k}</inlinemath>-points.</xs:documentation>
                      </xs:annotation>
                      <xs:complexType>
                        <xs:attribute ex:importance="expert" ex:unit="" ref="action" use="optional" default="include">
                          <xs:annotation>
                            <xs:documentation>Select to include or exclude states. If a state is
                              included as well as excluded several times the last definition (in the
                              sequence of individual transitions) counts.</xs:documentation>
                          </xs:annotation>
                        </xs:attribute>
                        <xs:attribute ex:importance="expert" ex:unit="" ref="statestype" use="required">
                          <xs:annotation>
                            <xs:documentation>Select for initial or final state
                              range.</xs:documentation>
                          </xs:annotation>
                        </xs:attribute>
                        <xs:attribute ex:importance="expert" ex:unit="" name="kpointnumber" type="xs:integer" default="0">
                          <xs:annotation>
                            <xs:documentation>Number of <inlinemath>{\mathbf k}</inlinemath>-point to be considered. A value of zero
                              (default) means to include all <inlinemath>{\mathbf k}</inlinemath>-point. </xs:documentation>
                          </xs:annotation>
                        </xs:attribute>
                        <xs:attribute ex:importance="expert" ex:unit="" name="start" type="xs:integer" default="0">
                          <xs:annotation>
                            <xs:documentation>Start value (first state) for range. A value of zero
                              (default) means to start from the first state. </xs:documentation>
                          </xs:annotation>
                        </xs:attribute>
                        <xs:attribute ex:importance="expert" ex:unit="" name="stop" type="xs:integer" default="0">
                          <xs:annotation>
                            <xs:documentation>Stop value (last state) for range. A value of zero
                              (default) means to stop at the last state (no upper
                              limit).</xs:documentation>
                          </xs:annotation>
                        </xs:attribute>
                      </xs:complexType>
                    </xs:element>
                  </xs:sequence>
                </xs:complexType>
              </xs:element>
              <xs:element ex:importance="expert" ex:unit="" name="lists" minOccurs="0" maxOccurs="1">
                <xs:annotation>
                  <xs:documentation>A list of initial and final state entries to be considered for
                    transitions. An empty list amounts to no transitions at all.</xs:documentation>
                </xs:annotation>
                <xs:complexType>
                  <xs:sequence>
                    <xs:element ex:importance="expert" ex:unit="" name="istate" minOccurs="0" maxOccurs="unbounded">
                      <xs:annotation>
                        <xs:documentation>An initial or final state and corresponding <inlinemath>{\mathbf k}</inlinemath>-point is
                          given here. Values of zero correspond to considering all initial/final
                          states for all <inlinemath>{\mathbf k}</inlinemath>-points. They can be used as "wildcards" (default).
                          Therefore, an empty element corresponds to the full initial/final state
                          set for all <inlinemath>{\mathbf k}</inlinemath>-points.</xs:documentation>
                      </xs:annotation>
                      <xs:complexType>
                        <xs:attribute ex:importance="expert" ex:unit="" ref="action" use="optional" default="include">
                          <xs:annotation>
                            <xs:documentation>Select to include or exclude states. If a state is
                              included as well as excluded several times the last definition (in the
                              sequence of individual transitions) counts.</xs:documentation>
                          </xs:annotation>
                        </xs:attribute>
                        <xs:attribute ex:importance="expert" ex:unit="" ref="statestype" use="required">
                          <xs:annotation>
                            <xs:documentation>Select for initial or final state
                              list.</xs:documentation>
                          </xs:annotation>
                        </xs:attribute>
                        <xs:attribute ex:importance="expert" ex:unit="" name="kpointnumber" type="xs:integer" default="0">
                          <xs:annotation>
                            <xs:documentation>Number of <inlinemath>{\mathbf k}</inlinemath>-point to be consider. A value of zero
                              (default) means to include all <inlinemath>{\mathbf k}</inlinemath>-point. </xs:documentation>
                          </xs:annotation>
                        </xs:attribute>
                        <xs:attribute ex:importance="expert" ex:unit="" name="state" type="xs:integer" default="0">
                          <xs:annotation>
                            <xs:documentation>The state to be considered. A value of zero (default)
                              means to include all states.</xs:documentation>
                          </xs:annotation>
                        </xs:attribute>
                      </xs:complexType>
                    </xs:element>
                  </xs:sequence>
                </xs:complexType>
              </xs:element>
            </xs:all>
          </xs:complexType>
        </xs:element>
        <xs:element ex:importance="expert" ex:unit="" ref="qpointset" minOccurs="1" maxOccurs="1">
          <xs:annotation>
            <xs:documentation> Finite momentum transfer <inlinemath>{ \bf G}+{ \bf q}</inlinemath>\
              vector. </xs:documentation>
            <xs:appinfo>
              <oldname>vgqlmt,nqptmt</oldname>
            </xs:appinfo>
          </xs:annotation>
        </xs:element>
        <xs:element ex:importance="expert" ex:unit="" name="tetra" maxOccurs="1" minOccurs="0">
          <xs:complexType>
            <xs:attribute ex:importance="expert" ex:unit="" name="tetraocc" type="xs:boolean" default="false"/>
            <xs:attribute ex:importance="expert" ex:unit="" name="tetradf" type="xs:boolean" default="false">
              <xs:annotation>
                <xs:documentation>
                  <pre>"true"</pre> if tetrahedron method is used for the <inlinemath>{\mathbf k}</inlinemath>-space integration in the
                  Kohn-Sham response function. </xs:documentation>
              </xs:annotation>
            </xs:attribute>
            <xs:attribute ex:importance="expert" ex:unit="" name="kordexc" type="xs:boolean" default="false">
              <xs:annotation>
                <xs:appinfo>
                  <oldname>tetrakordexc</oldname>
                </xs:appinfo>
              </xs:annotation>
            </xs:attribute>
            <xs:attribute ex:importance="expert" ex:unit="" name="cw1k" type="xs:boolean" default="false">
              <xs:annotation>
                <xs:appinfo>
                  <oldname>tetracw1k</oldname>
                </xs:appinfo>
              </xs:annotation>
            </xs:attribute>
            <xs:attribute ex:importance="expert" ex:unit="" name="qweights" type="xs:integer" default="1">
              <xs:annotation>
                <xs:appinfo>
                  <oldname>tetraqweights</oldname>
                </xs:appinfo>
                <xs:documentation>Choice of weights and nodes for the tetrahedron method and
                  non-zero Q-point.</xs:documentation>
              </xs:annotation>
            </xs:attribute>
          </xs:complexType>
        </xs:element>
        <xs:element ex:importance="expert" ex:unit="" ref="energywindow" maxOccurs="1" minOccurs="1"> </xs:element>
	<xs:element ex:importance="expert" ex:unit="" name="plan" minOccurs="0" maxOccurs="1">
          <xs:complexType>
            <xs:sequence>
              <xs:element ex:importance="expert" ex:unit="" name="doonly" minOccurs="0" maxOccurs="unbounded">
                <xs:complexType>
                  <xs:attribute ex:importance="expert" ex:unit="" name="task" use="required">
                    <xs:annotation>
                      <xs:appinfo>
                        <oldname>noreplace</oldname>
                      </xs:appinfo>
                    </xs:annotation>
                    <xs:simpleType>
                      <xs:restriction base="xs:string">
                        <!-- required workflow tasks below -->
                        <xs:enumeration value="xsgeneigvec">
                          <xs:annotation>
                            <xs:appinfo>
                              <oldnr>301</oldnr>
                            </xs:appinfo>
                            <xs:documentation>Calculate eigenvectors, values and
                              occupancies.</xs:documentation>
                          </xs:annotation>
                        </xs:enumeration>
                        <xs:enumeration value="tetcalccw">
                          <xs:annotation>
                            <xs:appinfo>
                              <oldnr>310</oldnr>
                            </xs:appinfo>
                            <xs:documentation>Calculate frequency-dependent weights for convolutions
                              using the linear tetrahedron method. </xs:documentation>
                          </xs:annotation>
                        </xs:enumeration>
                        <xs:enumeration value="writepmatxs">
                          <xs:annotation>
                            <xs:appinfo>
                              <oldnr>320</oldnr>
                            </xs:appinfo>
                            <xs:documentation>Calculate momentum matrix elements.</xs:documentation>
                          </xs:annotation>
                        </xs:enumeration>
                        <xs:enumeration value="writeemat">
                          <xs:annotation>
                            <xs:appinfo>
                              <oldnr>330</oldnr>
                            </xs:appinfo>
                            <xs:documentation>Calculate q-dependent matrix
                              elements.</xs:documentation>
                          </xs:annotation>
                        </xs:enumeration>
                        <xs:enumeration value="df">
                          <xs:annotation>
                            <xs:appinfo>
                              <oldnr>340</oldnr>
                            </xs:appinfo>
                            <xs:documentation>Calculate the Kohn-Sham response function checked in
                              the code.</xs:documentation>
                          </xs:annotation>
                        </xs:enumeration>
                        <xs:enumeration value="df2">
                          <xs:annotation>
                            <xs:appinfo>
                              <oldnr>345</oldnr>
                            </xs:appinfo>
                            <xs:documentation>Calculate the Kohn-Sham response function taking into
                              account the rigid shift of the BSE diagonal. ??? This is not a
                              duplicate task, as the task-Nr. is referenced. checked in the code
                              !</xs:documentation>
                          </xs:annotation>
                        </xs:enumeration>
                        <xs:enumeration value="idf">
                          <xs:annotation>
                            <xs:appinfo>
                              <oldnr>350</oldnr>
                            </xs:appinfo>
                            <xs:documentation> Set up simple xc-kernels, solve Dyson's equation for
                              the full polarizability and determine the macroscopic dielectric
                              function and other spectroscopic quantities.</xs:documentation>
                          </xs:annotation>
                        </xs:enumeration>
                        <xs:enumeration value="scrgeneigvec">
                          <xs:annotation>
                            <xs:appinfo>
                              <oldnr>401</oldnr>
                            </xs:appinfo>
                            <xs:documentation>Calculate eigenvectors, -values and occupancies for
                              screening</xs:documentation>
                          </xs:annotation>
                        </xs:enumeration>
                        <xs:enumeration value="scrtetcalccw">
                          <xs:annotation>
                            <xs:appinfo>
                              <oldnr>410</oldnr>
                            </xs:appinfo>
                            <xs:documentation>Calculate frequency-dependent weights for convolutions
                              using the linear tetrahedron method for screening. </xs:documentation>
                          </xs:annotation>
                        </xs:enumeration>
                        <xs:enumeration value="scrwritepmat">
                          <xs:annotation>
                            <xs:appinfo>
                              <oldnr>420</oldnr>
                            </xs:appinfo>
                            <xs:documentation>Calculate momentum matrix elements for
                              screening.</xs:documentation>
                          </xs:annotation>
                        </xs:enumeration>
                        <xs:enumeration value="screen">
                          <xs:annotation>
                            <xs:appinfo>
                              <oldnr>430</oldnr>
                            </xs:appinfo>
                            <xs:documentation>Calculate RPA screening (ignoring scissor's
                              shift).</xs:documentation>
                          </xs:annotation>
                        </xs:enumeration>
                        <xs:enumeration value="scrcoulint">
                          <xs:annotation>
                            <xs:appinfo>
                              <oldnr>440</oldnr>
                            </xs:appinfo>
                            <xs:documentation>Calculate direct term of BSE
                              Hamiltonian.</xs:documentation>
                          </xs:annotation>
                        </xs:enumeration>
                        <xs:enumeration value="exccoulint">
                          <xs:annotation>
                            <xs:appinfo>
                              <oldnr>441</oldnr>
                            </xs:appinfo>
                            <xs:documentation>Calculate exchange term of BSE
                              Hamiltonian.</xs:documentation>
                          </xs:annotation>
                        </xs:enumeration>
                        <xs:enumeration value="bse">
                          <xs:annotation>
                            <xs:appinfo>
                              <oldnr>445</oldnr>
                            </xs:appinfo>
                            <xs:documentation>Bethe-Salpeter equation.</xs:documentation>
                          </xs:annotation>
                        </xs:enumeration>
                        <xs:enumeration value="bsegenspec">
                          <xs:annotation>
                            <xs:appinfo>
                              <oldnr>446</oldnr>
                            </xs:appinfo>
                            <xs:documentation>Read BSE eigenvalues and regenerate dielectric and loss functions.</xs:documentation>
                          </xs:annotation>
                        </xs:enumeration>
                        <xs:enumeration value="writebevec">
                          <xs:annotation>
                            <xs:appinfo>
                              <oldnr>447</oldnr>
                            </xs:appinfo>
                            <xs:documentation>ASCII output of BSE eigenvalus.</xs:documentation>
                          </xs:annotation>
                        </xs:enumeration>
                        <xs:enumeration value="kernxc_bse">
                          <xs:annotation>
                            <xs:appinfo>
                              <oldnr>450</oldnr>
                            </xs:appinfo>
                            <xs:documentation> Calculate frequency dependent xc-kernel drived from
                              the Bethe-Salpeter equation in first order. </xs:documentation>
                          </xs:annotation>
                        </xs:enumeration>
                        <!-- experimental and debugging tasks below -->
                        <xs:enumeration value="writebandgapgrid">
                          <xs:annotation>
                            <xs:appinfo>
                              <oldnr>23</oldnr>
                            </xs:appinfo>
                            <xs:documentation>Estimate bandgap from regular grid.</xs:documentation>
                          </xs:annotation>
                        </xs:enumeration>
                        <xs:enumeration value="writepmat">
                          <xs:annotation>
                            <xs:appinfo>
                              <oldnr>120</oldnr>
                            </xs:appinfo>
                            <xs:documentation>Calculate momentum matrix elements
                              (legacy).</xs:documentation>
                          </xs:annotation>
                        </xs:enumeration>
                        <xs:enumeration value="dielectric">
                          <xs:annotation>
                            <xs:appinfo>
                              <oldnr>121</oldnr>
                            </xs:appinfo>
                            <xs:documentation>Linear optics (legacy).</xs:documentation>
                          </xs:annotation>
                        </xs:enumeration>
                        <xs:enumeration value="writepmatasc">
                          <xs:annotation>
                            <xs:appinfo>
                              <oldnr>321</oldnr>
                            </xs:appinfo>
                            <xs:documentation>ASCII output of momentum matrix
                              elements.</xs:documentation>
                          </xs:annotation>
                        </xs:enumeration>
                        <xs:enumeration value="pmatxs2orig">
                          <xs:annotation>
                            <xs:appinfo>
                              <oldnr>322</oldnr>
                            </xs:appinfo>
                            <xs:documentation>Convert momentum matrix elements file to old
                              format.</xs:documentation>
                          </xs:annotation>
                        </xs:enumeration>
                        <xs:enumeration value="writeematasc">
                          <xs:annotation>
                            <xs:appinfo>
                              <oldnr>331</oldnr>
                            </xs:appinfo>
                            <xs:documentation>ASCII output of q-dependent matrix
                              elements.</xs:documentation>
                          </xs:annotation>
                        </xs:enumeration>
                        <xs:enumeration value="writepwmat">
                          <xs:annotation>
                            <xs:appinfo>
                              <oldnr>335</oldnr>
                            </xs:appinfo>
                            <xs:documentation>Calculate matrix elements of the plane wave (simple
                              version for checking).</xs:documentation>
                          </xs:annotation>
                        </xs:enumeration>
                        <xs:enumeration value="emattest">
                          <xs:annotation>
                            <xs:appinfo>
                              <oldnr>339</oldnr>
                            </xs:appinfo>
                            <xs:documentation>Check relation between matr. el. of exp. and mom.
                              matr. el.</xs:documentation>
                          </xs:annotation>
                        </xs:enumeration>
                        <xs:enumeration value="x0toasc">
                          <xs:annotation>
                            <xs:appinfo>
                              <oldnr>341</oldnr>
                            </xs:appinfo>
                            <xs:documentation>ASCII output of Kohn Sham response
                              function.</xs:documentation>
                          </xs:annotation>
                        </xs:enumeration>
                        <xs:enumeration value="x0tobin">
                          <xs:annotation>
                            <xs:appinfo>
                              <oldnr>342</oldnr>
                            </xs:appinfo>
                            <xs:documentation>Binary output of Kohn Sham response
                              function.</xs:documentation>
                          </xs:annotation>
                        </xs:enumeration>
                        <xs:enumeration value="fxc_alda_check">
                          <xs:annotation>
                            <xs:appinfo>
                              <oldnr>398</oldnr>
                            </xs:appinfo>
                            <xs:documentation>Check ALDA kernel.</xs:documentation>
                          </xs:annotation>
                        </xs:enumeration>
                        <xs:enumeration value="kernxc_bse3">
                          <xs:annotation>
                            <xs:appinfo>
                              <oldnr>451</oldnr>
                            </xs:appinfo>
                            <xs:documentation>BSE-kernel, straight-forward
                              version.</xs:documentation>
                          </xs:annotation>
                        </xs:enumeration>
                        <xs:enumeration value="testxs">
                          <xs:annotation>
                            <xs:appinfo>
                              <oldnr>499</oldnr>
                            </xs:appinfo>
                            <xs:documentation>Debug routine of xs-part.</xs:documentation>
                          </xs:annotation>
                        </xs:enumeration>
                        <xs:enumeration value="xsestimate">
                          <xs:annotation>
                            <xs:appinfo>
                              <oldnr>700</oldnr>
                            </xs:appinfo>
                            <xs:documentation>Estimate disk-space, cpu-time and memory
                              requirements.</xs:documentation>
                          </xs:annotation>
                        </xs:enumeration>
                        <xs:enumeration value="xstiming">
                          <xs:annotation>
                            <xs:appinfo>
                              <oldnr>701</oldnr>
                            </xs:appinfo>
                            <xs:documentation>Test timing.</xs:documentation>
                          </xs:annotation>
                        </xs:enumeration>
                        <!-- debugging main part -->
                        <xs:enumeration value="testmain">
                          <xs:annotation>
                            <xs:appinfo>
                              <oldnr>999</oldnr>
                            </xs:appinfo>
                            <xs:documentation>Debug routine of main part of code.</xs:documentation>
                          </xs:annotation>
                        </xs:enumeration>

                        <!-- Visualize BSE exciton wavefunction -->
                        <xs:enumeration value="excitonWavefunction">
                          <xs:annotation>
                            <xs:appinfo>
                              <oldnr>710</oldnr>
                            </xs:appinfo>
                            <xs:documentation>
                              Generate data to visualize the 6-d electron-hole wavefunction.
                            </xs:documentation>
                          </xs:annotation>
                        </xs:enumeration>

                        <!-- import/export tasks below -->
                        <xs:enumeration value="portstate(1)">
                          <xs:annotation>
                            <xs:appinfo>
                              <oldnr>900</oldnr>
                            </xs:appinfo>
                            <xs:documentation>Generate STATE.xml file from STATE.OUT
                              file.</xs:documentation>
                          </xs:annotation>
                        </xs:enumeration>
                        <xs:enumeration value="portstate(2)">
                          <xs:annotation>
                            <xs:appinfo>
                              <oldnr>901</oldnr>
                            </xs:appinfo>
                            <xs:documentation>Generate STATE.OUT file from STATE.xml
                              file.</xs:documentation>
                          </xs:annotation>
                        </xs:enumeration>
                        <xs:enumeration value="portstate(-1)">
                          <xs:annotation>
                            <xs:appinfo>
                              <oldnr>910</oldnr>
                            </xs:appinfo>
                            <xs:documentation>Display information about STATE.OUT
                              file.</xs:documentation>
                          </xs:annotation>
                        </xs:enumeration>
                        <xs:enumeration value="portstate(-2)">
                          <xs:annotation>
                            <xs:appinfo>
                              <oldnr>911</oldnr>
                            </xs:appinfo>
                            <xs:documentation>Display information about STATE.xml
                              file.</xs:documentation>
                          </xs:annotation>
                        </xs:enumeration>
                      </xs:restriction>
                    </xs:simpleType>
                  </xs:attribute>
                </xs:complexType>
              </xs:element>
            </xs:sequence>
          </xs:complexType>
        </xs:element>
      </xs:all>
      <xs:attribute ex:importance="essential" ex:unit="" name="bfieldc" type="vect3d" default="0.0d0 0.0d0 0.0d0 ">
	<xs:annotation>
	  <xs:documentation> 
	    This attribute overrides the homonym attribute from the groundstate/spin element.
	  </xs:documentation>
	</xs:annotation>
      </xs:attribute>
      <xs:attribute ex:importance="expert" ex:unit="" name="dogroundstate" default="fromfile">
	<xs:annotation>
	  <xs:appinfo>
	    <oldname>nonreplace</oldname>
	  </xs:appinfo>
          <xs:documentation> Decides if the ground state is calculated starting from scratch or using
	  the densities from file.</xs:documentation>
	</xs:annotation>
	<xs:simpleType>
	  <xs:restriction base="xs:string">
	    <xs:enumeration value="fromscratch"/>
	    <xs:enumeration value="fromfile"/>
	  </xs:restriction>
	</xs:simpleType>
      </xs:attribute>
      <xs:attribute ex:importance="expert" ex:unit="" name="maxscl" type="xs:integer" default="1">
	<xs:annotation>
	  <xs:documentation>Upper limit of the self-consistency loop for the calculation of eigenvectors and eigenvalues
	  from an existing ground-state calculation.</xs:documentation>
	</xs:annotation>
      </xs:attribute>
      <xs:attribute ex:importance="expert" ex:unit="" name="emattype" type="xs:integer" default="1">
        <xs:annotation>
          <xs:documentation>Type of matrix element generation (band-combinations). Should only be
            referenced for experimental features. </xs:documentation>
        </xs:annotation>
      </xs:attribute>
      <xs:attribute ex:importance="expert" ex:unit="" name="dfoffdiag" type="xs:boolean" default="false">
        <xs:annotation>
          <xs:documentation>
            <pre>"true"</pre> if also off-diagonal tensor elements for the interacting response
            function are to be calculated. </xs:documentation>
        </xs:annotation>
      </xs:attribute>
      <xs:attribute ex:importance="expert" ex:unit="" name="lmaxapwwf" type="xs:integer" default="-1">
        <xs:annotation>
          <xs:documentation>Maximum angular momentum for APW functions for q-dependent matrix
            elements.</xs:documentation>
        </xs:annotation>
      </xs:attribute>
      <xs:attribute ex:importance="expert" ex:unit="" name="lmaxemat" type="xs:integer" default="3">
        <xs:annotation>
          <xs:documentation> Maximum angular momentum for Rayleigh expansion of <inlinemath>{\bf
              q}</inlinemath>-dependent plane wave factor. </xs:documentation>
        </xs:annotation>
      </xs:attribute>
      <xs:attribute ex:importance="expert" ex:unit="" name="emaxdf" type="fortrandouble" default="1.0d10">
        <xs:annotation>
          <xs:documentation>Energy cutoff for the unoccupied states in the Kohn-Sham response
            function and screening. This parameter ensures a cutoff at the specified energy and is
            defined in addition to the <attref>nempty</attref> parameter.</xs:documentation>
        </xs:annotation>
      </xs:attribute>
      <xs:attribute ex:importance="expert" ex:unit="Hartree" name="broad" type="fortrandouble" default="0.01d0">
        <xs:annotation>
          <xs:documentation>Lorentzian broadening for all spectra</xs:documentation>
        </xs:annotation>
      </xs:attribute>
      <xs:attribute ex:importance="expert" ex:unit="Hartree" name="epsdfde" type="fortrandouble" default="1.0d-8">
        <xs:annotation>
          <xs:documentation>The smallest energy difference for which the square of its inverse will
            be considered in the Kohn-Sham response function. </xs:documentation>
        </xs:annotation>
      </xs:attribute>
      <xs:attribute ex:importance="expert" ex:unit="" name="tevout" type="xs:boolean" default="false">
        <xs:annotation>
          <xs:documentation>
            <pre>"true"</pre> if energy outputs are in eV. </xs:documentation>
        </xs:annotation>
      </xs:attribute>
      <xs:attribute ex:importance="expert" ex:unit="" name="xstype" use="required">
        <xs:annotation>
          <xs:documentation>Should TDDFT be used or BSE.</xs:documentation>
        </xs:annotation>
        <xs:simpleType>
          <xs:restriction base="xs:string">
            <xs:enumeration value="TDDFT"/>
            <xs:enumeration value="BSE"/>
          </xs:restriction>
        </xs:simpleType>
      </xs:attribute>
      <!-- Here are experimental parameters -->
      <xs:attribute ex:importance="expert" ex:unit="" name="skipgnd" type="xs:boolean" default="false">
        <xs:annotation>
          <xs:documentation>
	    If set to <pre>"true"</pre>, recalculation of KS eigenvalues and eigenvectors is skipped.
	  </xs:documentation>
        </xs:annotation>
      </xs:attribute>
      <xs:attribute ex:importance="expert" ex:unit="" ref="fastpmat" default="true">
        <xs:annotation>
          <xs:documentation> If set to <pre>"true"</pre>, a fast method to calculate APW-lo, lo-APW
            and lo-lo parts of the momentum matrix elements in the muffin-tin is used.
          </xs:documentation>
        </xs:annotation>
      </xs:attribute>

      <xs:attribute ex:importance="expert" ex:unit="" name="pwmat" default="mm">
        <xs:annotation>
          <xs:documentation> Algorithm for calculating matrix elements of plane waves.
             Matrix multiplications (mm) are better suited for small systems, while
             fast Fourier transforms (fft) are appropriate for large systems.
          </xs:documentation>
        </xs:annotation>
        <xs:simpleType>
          <xs:restriction base="xs:string">
            <xs:enumeration value="mm"/>
            <xs:enumeration value="fft"/>
          </xs:restriction>
        </xs:simpleType>
      </xs:attribute>

      <xs:attribute ex:importance="expert" ex:unit="" name="tappinfo" type="xs:boolean" default="false">
        <xs:annotation>
          <xs:documentation><pre>"true"</pre> to append info to output file.</xs:documentation>
        </xs:annotation>
      </xs:attribute>
      <xs:attribute ex:importance="expert" ex:unit="" name="dbglev" type="xs:integer" default="0">
        <xs:annotation>
          <xs:documentation>Debugging level. Any value <inlinemath>{ &gt; 0 }</inlinemath>  will
            produce additional debug output. The large the value, the more information is
            output.</xs:documentation>
        </xs:annotation>
      </xs:attribute>
      <xs:attribute ex:importance="expert" ex:unit="" name="gqmaxtype" default="|G+q|">
        <xs:annotation>
          <xs:documentation>Defines the way the gqmax cutoff is applied for the selection of the
            G-vectors. For <inlinemath>"|G+q|"</inlinemath> G vectors are selected such that
              <inlinemath>{\bf G+q}</inlinemath> lies within the <attref>gqmax</attref> cutoff. For
              <inlinemath>"|G|"</inlinemath> G vectors are selected such that <inlinemath>{\bf
              G}</inlinemath> lies within the <pre>gqmax</pre> cutoff. </xs:documentation>
        </xs:annotation>
        <xs:simpleType>
          <xs:restriction base="xs:string">
            <xs:enumeration value="|G+q|"> </xs:enumeration>
            <xs:enumeration value="|G|"> </xs:enumeration>
          </xs:restriction>
        </xs:simpleType>
      </xs:attribute>
      <xs:attribute ex:importance="expert" ex:unit="" name="gqmax" type="fortrandouble" default="0.0d0">
        <xs:annotation>
          <xs:documentation><inlinemath>{\bf |G+q|}</inlinemath> cutoff for Kohn-Sham response
            function, screening and for expansion of Coulomb potential</xs:documentation>
        </xs:annotation>
      </xs:attribute>
      <!-- section of parameters from groundstate which are allowed to be different from the ones of the ground state run -->
      <xs:attribute ex:importance="expert" ex:unit="" name="nosym" type="xs:boolean" default="false">
        <xs:annotation>
          <xs:appinfo>
            <oldname>nosymxs</oldname>
          </xs:appinfo>
          <xs:documentation>
            <attref>nosym</attref> is <pre>"true"</pre> if no symmetry information should be used
          </xs:documentation>
        </xs:annotation>
      </xs:attribute>
      <xs:attribute ex:importance="expert" ex:unit="" name="ngridk" type="integertriple" default="1 1 1">
        <xs:annotation>
          <xs:appinfo>
            <oldname>ngridkxs</oldname>
          </xs:appinfo>
          <xs:documentation><inlinemath>{\mathbf k}</inlinemath>-point grid sizes.</xs:documentation>
        </xs:annotation>
      </xs:attribute>
      <xs:attribute ex:importance="expert" ex:unit="" name="vkloff" type="vect3d" default="0.0d0 0.0d0 0.0d0 ">
        <xs:annotation>
          <xs:appinfo>
            <oldname>vkloffxs</oldname>
          </xs:appinfo>
          <xs:documentation> The <inlinemath>{\mathbf k}</inlinemath>-point set offset. All <inlinemath>{\mathbf k}</inlinemath>-points of a regular <inlinemath>{\mathbf k}</inlinemath>-mesh (a mesh
            containing the Gamma point) are shifted by a constant vector given by <inlinemath>({\rm
              vkloff}_1/N_1, {\rm vkloff}_2/N_2, {\rm vkloff}_3/N_3)</inlinemath>, where
              <inlinemath> (N_1,N_2,N_3) </inlinemath> is the division of the <inlinemath>{\mathbf k}</inlinemath>-point mesh. It
            should be selected such that all symmetries among the <inlinemath>{\mathbf k}</inlinemath>-points from the regular
            (non-shifted) mesh are broken. An exception is the case of optical spectra without local
            field effects where symmetries among <inlinemath>{\mathbf k}</inlinemath>-points are explicitly taken into account.
          </xs:documentation>
        </xs:annotation>
      </xs:attribute>
      <xs:attribute ex:importance="expert" ex:unit="" name="reducek" type="xs:boolean" default="false">
        <xs:annotation>
          <xs:appinfo>
            <oldname>reducekxs</oldname>
          </xs:appinfo>
          <xs:documentation>
            <attref>reducek</attref> is <pre>"true"</pre> if <inlinemath>{\mathbf k}</inlinemath>-points are to be reduced (with crystal
            symmetries). </xs:documentation>
        </xs:annotation>
      </xs:attribute>
      <xs:attribute ex:importance="expert" ex:unit="" name="ngridq" type="integertriple" default="1 1 1">
        <xs:annotation>
          <xs:appinfo>
            <oldname>ngridqxs</oldname>
          </xs:appinfo>
          <xs:documentation>q-point grid sizes.</xs:documentation>
        </xs:annotation>
      </xs:attribute>
      <xs:attribute ex:importance="expert" ex:unit="" name="reduceq" type="xs:boolean" default="true">
        <xs:annotation>
          <xs:appinfo>
            <oldname>reduceqxs</oldname>
          </xs:appinfo>
          <xs:documentation>
            <attref>reducek</attref> is <pre>"true"</pre> if q-points are to be reduced (with crystal
            symmetries). </xs:documentation>
        </xs:annotation>
      </xs:attribute>
      <xs:attribute ex:importance="expert" ex:unit="" name="rgkmax" type="fortrandouble" default="0.0d0">
        <xs:annotation>
          <xs:appinfo>
            <oldname>rgkmaxxs</oldname>
          </xs:appinfo>
 	  <xs:documentation>Smallest muffin-tin radius times <pre>gkmax</pre>. If set to zero (the default), this value defaults to the rgkmax set in the groundstate element.</xs:documentation>
        </xs:annotation>
      </xs:attribute>      
      <xs:attribute ex:importance="expert" ex:unit="Hartree" name="swidth" type="fortrandouble" default="0.001d0">
        <xs:annotation>
          <xs:appinfo>
            <oldname>swidthxs</oldname>
            <olddefault default="0.01d0"/>
          </xs:appinfo>
          <xs:documentation>Width of the smooth approximation to the Dirac delta function (must be &gt;
            0).</xs:documentation>
        </xs:annotation>
      </xs:attribute>
      <xs:attribute ex:importance="expert" ex:unit="" name="lmaxapw" type="xs:integer" default="10">
        <xs:annotation>
          <xs:appinfo>
            <oldname>lmaxapwxs</oldname>
            <olddefault default="8"/>
          </xs:appinfo>
          <xs:documentation>Angular momentum cut-off for the APW functions.</xs:documentation>
        </xs:annotation>
      </xs:attribute>
      <xs:attribute ex:importance="expert" ex:unit="" name="lmaxmat" type="xs:integer" default="5">
        <xs:annotation>
          <xs:appinfo>
            <oldname>lmaxmatxs</oldname>
          </xs:appinfo>
          <xs:documentation>Angular momentum cut-off for the outer-most loop in the hamiltonian and
            overlap matrix setup.</xs:documentation>
        </xs:annotation>
      </xs:attribute>
      <xs:attribute ex:importance="expert" ex:unit="" name="nempty" type="xs:integer" default="5">
        <xs:annotation>
          <xs:appinfo>
            <oldname>nemptyxs</oldname>
          </xs:appinfo>
          <xs:documentation> Number of empty states. This parameter determines the energy cutoff for
            the excitation spectra. For determining the number of states related to an energy
            cutoff, perform one iteration of a SCF calculation, setting <attref>nempty</attref> to a
            higher value and check the <filename>EIGVAL.OUT</filename>. </xs:documentation>
        </xs:annotation>
      </xs:attribute>
      <xs:attribute ex:importance="essential" ex:unit="Hartree" ref="scissor" default="0.0d0">
        <xs:annotation>
          <xs:documentation>Scissors correction to correct the conduction band
            energies.</xs:documentation>
        </xs:annotation>
      </xs:attribute>
    </xs:complexType>
  </xs:element>
  <xs:annotation>
        <xs:appinfo>
            <parent>/input</parent>
            <root>gw</root>
        </xs:appinfo>
    </xs:annotation>
  <xs:element ex:importance="expert" ex:unit="" name="gw">
        <xs:annotation>
            <xs:documentation>G0W0 calculation setup.</xs:documentation>
        </xs:annotation>
        <xs:complexType>
          <xs:all>
          
            <xs:element ex:importance="essential" ex:unit="" ref="plot1d"/>

            <xs:element ex:importance="expert" ex:unit="" name="freqgrid" maxOccurs="1" minOccurs="0">
              <xs:annotation>
                <xs:documentation>
                   Frequecy grid parameters.
                </xs:documentation>
              </xs:annotation>
              <xs:complexType>
                <xs:attribute ex:importance="expert" type="xs:string" ex:unit="" name="fconv" default="imfreq"> 
                  <xs:annotation><xs:documentation>
                  Frequency convolution type:
                    'nofreq' - no frequecy dependence of the weights;
                    'refreq' - weights calculated for real frequecies;
                    'imfreq' - weights calculated for imaginary frequecies.
                  </xs:documentation></xs:annotation>
                </xs:attribute>
                <xs:attribute ex:importance="expert" type="xs:string" ex:unit="" name="fgrid" default="gaule2"> 
                  <xs:annotation><xs:documentation>
                  Frequency integration grid type:
                    'eqdis'  - equidistant frequencies from 0 to freqmax;
                    'gaulag' - Gauss-Laguerre quadrature from 0 to infinity;
                    'gauleg' - Gauss-Legendre quadrature from 0 to freqmax;
                    'gaule2' (default) - double Gauss-Legendre quadrature from 0 to freqmax and from freqmax to infinity.
                  </xs:documentation></xs:annotation>
                </xs:attribute>
                <xs:attribute ex:importance="expert" type="xs:integer" ex:unit="" name="nomeg" default="16"> 
                  <xs:annotation><xs:documentation>
                  Number of frequency (grid) points.
                  </xs:documentation></xs:annotation>
                </xs:attribute>
                <xs:attribute ex:importance="expert" type="fortrandouble" ex:unit="" name="freqmax" default="1.0d0">
                  <xs:annotation><xs:documentation>
                  Parameter of the double frequency grid technique.
                  </xs:documentation></xs:annotation>
                </xs:attribute>
              </xs:complexType>
            </xs:element>
 
            <xs:element ex:importance="expert" ex:unit="" name="selfenergy" maxOccurs="1" minOccurs="0">
              <xs:annotation>
                <xs:documentation>
                   Options related to the calculations of the correlation self-energy.
                </xs:documentation>
              </xs:annotation>
              <xs:complexType>

                <xs:all>
                  <xs:element ex:importance="expert" ex:unit="" name="SpectralFunctionPlot" maxOccurs="1" minOccurs="0">
                    <xs:annotation>
                    <xs:documentation>
                    Parameters for the self-energy and spectral function visualization.
                    </xs:documentation>
                    </xs:annotation>
                    <xs:complexType>
                      <xs:attribute ex:importance="expert" type="xs:string" ex:unit="" name="axis" default="real"> 
                        <xs:annotation><xs:documentation>
                        Real ("real") or imaginary ("imag") frequency axis for visialization.
                        </xs:documentation></xs:annotation>
                      </xs:attribute>
                      <xs:attribute ex:importance="expert" type="xs:integer" ex:unit="" name="nwgrid" default="1001"> 
                        <xs:annotation><xs:documentation>
                        Number of grid points within the visualization interval.
                        </xs:documentation></xs:annotation>
                      </xs:attribute>
                      <xs:attribute ex:importance="expert" type="fortrandouble" ex:unit="Hartree" name="wmin" default="-10"> 
                        <xs:annotation><xs:documentation>
                        Lower bound for the visualization frequency interval.
                        </xs:documentation></xs:annotation>
                      </xs:attribute>
                      <xs:attribute ex:importance="expert" type="fortrandouble" ex:unit="Hartree" name="wmax" default="10"> 
                        <xs:annotation><xs:documentation>
                        Upper bound for the visualization frequency interval.
                        </xs:documentation></xs:annotation>
                      </xs:attribute>
                      <xs:attribute ex:importance="expert" type="fortrandouble" ex:unit="Hartree" name="eta" default="1.0d-4"> 
                        <xs:annotation><xs:documentation>
                        Smearing parameter (small number).
                        </xs:documentation></xs:annotation>
                      </xs:attribute>
                    </xs:complexType>
                  </xs:element>
                </xs:all>

                <xs:attribute ex:importance="expert" type="xs:integer" ex:unit="" name="nempty" default="0"> 
                  <xs:annotation><xs:documentation>
                    Number of empty states to be used to calculate the correlation self energy.
                 </xs:documentation></xs:annotation>
                </xs:attribute>
                
                <xs:attribute ex:importance="expert" type="xs:integer" ex:unit="" name="iopes" default="0"> 
                  <xs:annotation><xs:documentation>
                    Solution of the quasiparticle equation:
                    0 : perturbative G0W0 without energy shift;
                    1 : perturbative G0W0 with energy shift
                    2 - iterative G0W0 with energy shift;
                    3 - iterative G0W0 without energy shift.
                  </xs:documentation></xs:annotation>
                </xs:attribute>
                
                <xs:attribute ex:importance="expert" type="xs:string" ex:unit="" name="actype" default="pade"> 
                  <xs:annotation><xs:documentation>
                    Analytical continuation scheme:
                    'pade': Pade's approximant (by H. J. Vidberg and J. W. Serence, J. Low Temp. Phys. 29, 179 (1977))
                    'mpf':  Multi-Pole Fitting (by H. N Rojas, R. W. Godby and R. J. Needs, Phys. Rev. Lett. 74, 1827 (1995))
                  </xs:documentation></xs:annotation>
                </xs:attribute>
                
                <xs:attribute ex:importance="expert" type="xs:integer" ex:unit="" name="npol" default="0"> 
                  <xs:annotation><xs:documentation>
                    Number of poles used in the analytical continuation.
                  </xs:documentation></xs:annotation>
                </xs:attribute>
                
                <xs:attribute ex:importance="expert" type="xs:string" ex:unit="" name="singularity" default="mpb"> 
                  <xs:annotation><xs:documentation>
                    Treatment of the integrable singular terms:
                    'none': No special treatment (test purpose only);  
                    'mpb' : Auxiliary function method by S. Massidda, M. Posternak, and A. Baldereschi, PRB 48, 5058 (1993);
                    'crg' : Auxiliary function method by P. Carrier, S. Rohra, and A. Goerling, PRB 75, 205126 (2007).
                  </xs:documentation></xs:annotation>
                </xs:attribute>
                
                <xs:attribute ex:importance="expert" type="xs:boolean" ex:unit="" name="secordw" default="false"> 
                  <xs:annotation><xs:documentation>
                    Calculate second order screened exchange contribution.
                  </xs:documentation></xs:annotation>
                </xs:attribute>
                
              </xs:complexType>
            </xs:element>
                              
            <xs:element ex:importance="expert" ex:unit="" name="mixbasis" maxOccurs="1" minOccurs="0">
              <xs:annotation>
                <xs:documentation>
                    Mixed basis parameters.
                 </xs:documentation>
              </xs:annotation>
              <xs:complexType>
                <xs:attribute ex:importance="expert" type="xs:integer" ex:unit="" name="lmaxmb" default="3"> </xs:attribute>
                <xs:attribute ex:importance="expert" type="fortrandouble" ex:unit="" name="epsmb" default="1.0d-4"> </xs:attribute>
                <xs:attribute ex:importance="expert" type="fortrandouble" ex:unit="" name="gmb" default="1.0"> </xs:attribute>
              </xs:complexType>
            </xs:element>
                          
            <xs:element ex:importance="expert" ex:unit="" name="barecoul" maxOccurs="1" minOccurs="0">
              <xs:annotation>
                <xs:documentation>
                    Parameters for the bare coulomb potential:
                      pwm - Maximum G for the pw basis (in gmaxvr*gmb units)
                      stctol - Convergence tolerance of the struct. const.
                      barcevtol - Tolerance to choose basis functions from bare Coulomb matrix eigenvectors.
                </xs:documentation>
              </xs:annotation>
              <xs:complexType>
                <xs:attribute ex:importance="expert" type="fortrandouble" ex:unit="" name="pwm" default="2.0d0"> </xs:attribute>
                <xs:attribute ex:importance="expert" type="fortrandouble" ex:unit="" name="stctol" default="1.0d-15"> </xs:attribute>
                <xs:attribute ex:importance="expert" ex:unit="" name="barcevtol" type="fortrandouble" default="0.1d0"> </xs:attribute>
                <xs:attribute ex:importance="expert" type="xs:string" ex:unit="" name="cutofftype" default="none"/>
                <xs:attribute ex:importance="expert" type="xs:string" ex:unit="" name="basis" default="mb"/>
              </xs:complexType>
            </xs:element>
            
            <xs:element ex:importance="expert" ex:unit="" name="scrcoul" maxOccurs="1" minOccurs="0">
              <xs:annotation>
                <xs:documentation>
                    Parameters for the dynamically screened Coulomb potential:
                </xs:documentation>
              </xs:annotation>
              <xs:complexType>
                <xs:attribute ex:importance="expert" type="xs:string" ex:unit="" name="scrtype" default="rpa">
                  <xs:annotation><xs:documentation>
                  Model type: 
                    rpa - Full-frequency random-phase approximation;
                    ppm - Godby-Needs plasmon-pole model.
                  </xs:documentation></xs:annotation>
                </xs:attribute>
                <xs:attribute ex:importance="expert" type="fortrandouble" ex:unit="" name="omegap" default="1.0d0"> 
                <xs:annotation><xs:documentation>
                  Plasmon-pole model fitting parameter (plasmon frequency).
                  </xs:documentation></xs:annotation>
                </xs:attribute>
                <xs:attribute ex:importance="expert" type="xs:string" ex:unit="" name="sciavtype" default="isotropic">
                  <xs:annotation><xs:documentation>
                  Type of volume averaging: 
                    isotropic - Simple averaging along a specified direction using 
                                only diagonal components of the dielectric tensor;
                    anisotropic - Anisotropic screening by C. Freysoldt et al., CPC 176, 1-13 (2007).
                  </xs:documentation></xs:annotation>
                 </xs:attribute>
                <xs:attribute ex:importance="expert" type="xs:integer" ex:unit="" name="lmaxdielt" default="2"> 
                  <xs:annotation><xs:documentation>
                  Angular momentum cutoff in anisotropy treatment.
                  </xs:documentation></xs:annotation>
                </xs:attribute>
                <xs:attribute ex:importance="expert" type="xs:integer" ex:unit="" name="nleblaik" default="5810">
                  <xs:annotation><xs:documentation>
                  Number of Lebedev-Laikov grid points in anisotropy treatment.
                  </xs:documentation></xs:annotation>
                </xs:attribute>
                <xs:attribute ex:importance="expert" type="xs:boolean" ex:unit="" name="sciavbd" default="false"> 
                  <xs:annotation><xs:documentation>
                  Flag for anisotropic averaging of the dielectric tensor 'body' part.
                  </xs:documentation></xs:annotation>
                </xs:attribute>
                <xs:attribute ex:importance="expert" ex:unit="" name="q0eps" type="vect3d" default="1.0d0 1.0d0 1.0d0">
                  <xs:annotation><xs:documentation>
                  q0eps - averaging direction q <inlinemath>\to</inlinemath> 0.
                  Default: (1,1,1)
                  </xs:documentation></xs:annotation>
                </xs:attribute>
              </xs:complexType>
            </xs:element>            
            
          </xs:all>

          <xs:attribute ex:importance="expert" ex:unit="" name="taskname" type="xs:string" use="optional" default="g0w0">
            <xs:annotation>
              <xs:documentation>
                  Type of calculations.
  	          </xs:documentation>
            </xs:annotation>
          </xs:attribute>
          
          <xs:attribute ex:importance="expert" ex:unit="" name="iik" type="xs:integer" use="optional" default="1">
            <xs:annotation>
              <xs:documentation>Lower bound for the k-point number</xs:documentation>
            </xs:annotation>
          </xs:attribute>
          
          <xs:attribute ex:importance="expert" ex:unit="" name="jjk" type="xs:integer" use="optional" default="1">
            <xs:annotation>
              <xs:documentation>Upper bound for the k-point number</xs:documentation>
            </xs:annotation>
          </xs:attribute>
          
          <xs:attribute ex:importance="expert" ex:unit="" name="igmin" type="xs:integer" use="optional" default="1">
            <xs:annotation>
              <xs:documentation>Lower bound for the G-vector number</xs:documentation>
            </xs:annotation>
          </xs:attribute>
          
          <xs:attribute ex:importance="expert" ex:unit="" name="igmax" type="xs:integer" use="optional" default="1">
            <xs:annotation>
              <xs:documentation>Upper bound for the G-vector number</xs:documentation>
            </xs:annotation>
          </xs:attribute>
          
          <xs:attribute ex:importance="expert" ex:unit="" name="ibmin" type="xs:integer" use="optional" default="1">
            <xs:annotation>
              <xs:documentation>Lower bound for the band number</xs:documentation>
            </xs:annotation>
          </xs:attribute>
          
          <xs:attribute ex:importance="expert" ex:unit="" name="ibmax" type="xs:integer" use="optional" default="1">
            <xs:annotation>
              <xs:documentation>Upper bound for the band number</xs:documentation>
            </xs:annotation>
          </xs:attribute>
          
          <xs:attribute ex:importance="expert" ex:unit="" name="ibmin2" type="xs:integer" use="optional" default="1">
            <xs:annotation>
             <xs:documentation>Lower bound for the band number</xs:documentation>
            </xs:annotation>
          </xs:attribute>
          
          <xs:attribute ex:importance="expert" ex:unit="" name="ibmax2" type="xs:integer" use="optional" default="1">
            <xs:annotation>
              <xs:documentation>Upper bound for the band number</xs:documentation>
            </xs:annotation>
          </xs:attribute>
          
          <xs:attribute ex:importance="expert" ex:unit="" name="at1" type="xs:integer" use="optional" default="1">
            <xs:annotation>
              <xs:documentation>First atom number</xs:documentation>
            </xs:annotation>
          </xs:attribute>
          
          <xs:attribute ex:importance="expert" ex:unit="" name="at2" type="xs:integer" use="optional" default="1">
            <xs:annotation>
              <xs:documentation>Second atom number</xs:documentation>
            </xs:annotation>
          </xs:attribute>

          <xs:attribute ex:importance="expert" ex:unit="" name="rpath" type="xs:string" use="optional" default="atoms">
            <xs:annotation>
              <xs:documentation>
                Type of the 1d real space path: "atoms" - connecting atoms specified in at1 and at2; "rad" - radial grid path in MT of at1; "azi" - azimuthal path in MT of at1.
              </xs:documentation>
            </xs:annotation>
          </xs:attribute>

          <xs:attribute ex:importance="expert" ex:unit="" name="nempty" type="xs:integer" use="optional" default="0">
            <xs:annotation>
              <xs:documentation>Number of empty states (cutoff parameter) used in GW. If not specified, the same number as for the groundstate calculations is used.
              </xs:documentation>
            </xs:annotation>
          </xs:attribute>
          
          <xs:attribute ex:importance="expert" ex:unit="" name="ibgw" type="xs:integer" use="optional" default="1">
            <xs:annotation>
              <xs:documentation>Lower band index for GW output.</xs:documentation>
            </xs:annotation>
          </xs:attribute>
          
          <xs:attribute ex:importance="expert" ex:unit="" name="nbgw" type="xs:integer" use="optional" default="0">
            <xs:annotation>
              <xs:documentation>Upper band index for GW output. If not specified, the maximum number of the available states is used.
              </xs:documentation>
            </xs:annotation>
          </xs:attribute>
          
          <xs:attribute ex:importance="expert" ex:unit="" name="coreflag" type="xs:string" default="all">
            <xs:annotation>
              <xs:documentation>
                  Option for treating core. Valid options are:
                      all - All electron calculation;
                      val - Valence electrons only;
                      vab - Valence-only without cores in mixbasis;
                      xal - All electron for exchange only.
                  Default value: all.
              </xs:documentation>
            </xs:annotation>
          </xs:attribute>
                    
          <xs:attribute ex:importance="expert" ex:unit="" name="reduceq" type="xs:boolean" default="false">
            <xs:annotation>
              <xs:documentation>
	          Use the crystal symmetry to calculate the dielectric function and perform q-point BZ integration (currently is not implemented).
	            </xs:documentation>
            </xs:annotation>
          </xs:attribute>

          <xs:attribute ex:importance="expert" ex:unit="" name="bzconv" type="xs:string" default="tetra">
            <xs:annotation>
              <xs:documentation>
                 BZ convolution option:
                   tetra - Use the linearized tetrahedron method;
                   sum   - Simple sum over k-points (test only).
	            </xs:documentation>
            </xs:annotation>
          </xs:attribute>
          
          <xs:attribute ex:importance="expert" ex:unit="" name="debug" type="xs:boolean" default="false">
            <xs:annotation>
              <xs:documentation>
	          Print debugging information.
	            </xs:documentation>
            </xs:annotation>
          </xs:attribute>

          <xs:attribute ex:importance="essential" ex:unit="" name="ngridq" type="integertriple" default="0 0 0">
            <xs:annotation>
              <xs:documentation>
                k/q-point grid size to be used in GW calculations. 
                If not specified,  (2,2,2) k-grid is used.
              </xs:documentation>
            </xs:annotation>
          </xs:attribute>
          
          <xs:attribute ex:importance="expert" ex:unit="" name="vqloff" type="vect3d" default="0.0d0 0.0d0 0.0d0">
            <xs:annotation>
              <xs:documentation>
                The <inlinemath>{\mathbf k/q}</inlinemath>-point offset vector in lattice coordinates.
              </xs:documentation>
            </xs:annotation>
          </xs:attribute>
          
          <xs:attribute ex:importance="expert" ex:unit="" name="skipgnd" type="xs:boolean" default="false">
            <xs:annotation>
              <xs:documentation>
	              Skip recalculation KS eigenvalues and eigenvectors for the complete k-point grid.
	          </xs:documentation>
            </xs:annotation>
          </xs:attribute>
          
          <xs:attribute ex:importance="expert" ex:unit="" name="mblksiz" type="xs:integer" default="64">
            <xs:annotation>
              <xs:documentation>
	              To reduce memory usage, big matrices are considered to be split into blocks, each with a size of mblksiz (not supported). 
	          </xs:documentation>
            </xs:annotation>
          </xs:attribute>
          
          <xs:attribute ex:importance="expert" ex:unit="" name="rpmat" type="xs:boolean" default="false">
            <xs:annotation>
              <xs:documentation>
	          Skip calculation of the momentum matrix elements but read them from files PMATVV.OUT and PMATCV.OUT.
	          </xs:documentation>
            </xs:annotation>
          </xs:attribute>

          <xs:attribute ex:importance="expert" type="fortrandouble" ex:unit="" name="rmax" default="40.0">
            <xs:annotation>
              <xs:documentation>
                Determine the basis size for the Fourier-series based interpolation subroutine used for the QP bandstructure plot.
              </xs:documentation>
            </xs:annotation>
          </xs:attribute>
                    
        </xs:complexType>
    </xs:element>
  <xs:annotation>
     <xs:documentation> 
	In order to perform an <exciting/> calculation an <pre-bf>XML</pre-bf> input file called
        <pre-bf>input.xml</pre-bf> must be provided. 
	<p> 
	   This web page lists all <blue>elements</blue> and 
	   <green>attributes</green> that can be used in the input file of
	   an <exciting/> calculation: 
	</p>
        <list>
           <li>
              <blue>elements</blue> are defined according to the 
	      <a href="http://en.wikipedia.org/wiki/XML#Key_terminology">general XML conventions</a>.
              <filename>Example:</filename> The element <elementref>groundstate</elementref> is used to set up a
              self-consistent calculation of the ground-state energy. 
	   </li>
           <li>
	      <green>attributes</green> are also defined from the 
	      <a href="http://en.wikipedia.org/wiki/XML#Key_terminology">general XML conventions</a>.
	      An attribute is always connected to an element. In <exciting/> an attribute
              generally specifies a parameter or a set of parameters which are connected to the
              corresponding element. <filename>Example:</filename> The attribute <attref>xctype</attref> of the
              element <elementref>groundstate</elementref> defines which exchange-correlation potential
              is used in the self-consistent calculation. 
	   </li>
        </list>
        <p> 
	   The input file of an <exciting>exciting</exciting> calculation has the default name
           <pre-bf>input.xml</pre-bf>. Simple examples for input files can be found in the available
	   <a href="http://exciting-code.org/tutorials-carbon">Tutorials</a>. 
	   The input file <pre-bf>input.xml</pre-bf> must be a valid <pre-bf>XML</pre-bf> file 
	   and it must contain the root element <elementref>input</elementref>. 
	</p>
        <p> 
	   Unless explicitly stated otherwise, <exciting>exciting</exciting> uses atomic units, setting 
	   <inlinemath>\hbar = m_{e} = e = 1</inlinemath>. Relevant units are: 
	</p>
        <list>
        <li> 
	   Energies are given in Hartree: 
	   <p>
              <inlinemath> 
		 \phantom{mmm} 1\ {\rm Ha} = 2\ {\rm Ry} = 27.21138386(68)\ {\rm eV} = 4.35926\cdot 10^{-18}\ 
		 {\rm J}
              </inlinemath>
           </p>
        </li>
        <li> 
	   Lengths are given in Bohr: 
	   <p>
              <inlinemath> 
         	 \phantom{mmm} 1\ a_{\rm Bohr}\ = 0.52917720859(36)\ {\buildrel _{\circ} \over
                 {\mathrm{A}}} \ = 0.52917720859(36) \cdot 10^{-10} \ {\rm m}
	      </inlinemath>
           </p>
        </li>
        <li> 
	    Magnetic fields are given in units of 
	    <p>
               <inlinemath> 
		  \phantom{mmm} 1\ {\rm a.u.} = \displaystyle\frac{e}{a_{\rm Bohr}^2}\ = 1717.2445320376\
                  {\rm Tesla}. 
	       </inlinemath>
            </p>
        </li>
        </list>
        <p> 
	   <pre-bf>Note:</pre-bf> The electron charge is positive, so that the atomic numbers
           <inlinemath>Z</inlinemath> are negative. 
	</p>
     </xs:documentation>
     <xs:appinfo>
        <title>
           <exciting>exciting</exciting> input reference 
	</title>
        <root>input</root>
     </xs:appinfo>
  </xs:annotation>
  <xs:element ex:importance="essential" ex:unit="" name="input">
    <xs:annotation>
      <xs:appinfo> </xs:appinfo>
      <xs:documentation> The <pre-bf>XML</pre-bf> element <elementref>input</elementref> is 
          the root element of the
          <exciting>exciting</exciting> input file. It must contain at least the elements
          <elementref>title</elementref>, <elementref>structure</elementref>, and
          <elementref>groundstate</elementref>, each of them must be present only one time.
      </xs:documentation>
    </xs:annotation>
    <xs:complexType>
      <xs:all>
        <xs:element ex:importance="essential" ex:unit="" maxOccurs="1" minOccurs="1" name="title" type="xs:string">
          <xs:annotation>
            <xs:documentation>The title of the input file, <it>e.g.</it>, "Ground-State
              Calculation for Aluminum". </xs:documentation>
          </xs:annotation>
        </xs:element>
        <xs:element ex:importance="essential" ex:unit="" maxOccurs="1" minOccurs="1" ref="structure"/>
        <xs:element ex:importance="essential" ex:unit="" maxOccurs="1" minOccurs="1" ref="groundstate"/>
        <xs:element ex:importance="essential" ex:unit="" maxOccurs="1" minOccurs="0" ref="relax"/>
        <xs:element ex:importance="essential" ex:unit="" maxOccurs="1" minOccurs="0" ref="properties"/>
        <xs:element ex:importance="expert" ex:unit="" maxOccurs="1" minOccurs="0" ref="phonons"/>
        <xs:element ex:importance="expert" ex:unit="" maxOccurs="1" minOccurs="0" ref="xs"/>
        <xs:element ex:importance="expert" ex:unit="" maxOccurs="1" minOccurs="0" ref="gw"/>
        <xs:element maxOccurs="1" minOccurs="0" name="keywords" type="xs:string">
          <xs:annotation>
            <xs:documentation> The keywords tag can contain a space separated list of keywords
              classifying the calculation for archiving purposes. It is not used by the
                <exciting>exciting</exciting> program. </xs:documentation>
          </xs:annotation>
        </xs:element>
      </xs:all>
      <xs:attribute default="http://xml.exciting-code.org" ex:importance="experimental" ex:unit="" name="xsltpath" type="xs:anyURI">
        <xs:annotation>
          <xs:appinfo> </xs:appinfo>
        </xs:annotation>
      </xs:attribute>
      <!--xs:attribute default="./" ex:importance="expert" ex:unit="" name="scratchpath" type="xs:anyURI" use="optional">
        <xs:annotation>
          <xs:documentation> The path to the scratch space where the eigenvector related files,
              <filename>EVECFV.OUT</filename>, <filename>EVECSV.OUT</filename>, and
              <filename>OCCSV.OUT</filename> will be written. If the local directory is accessed via
            a network then <attref>scratchpath</attref> can be set to a directory on a local disk.
            The default value is the working directory, <it>i.e.</it>, the directory where the
            program is started. </xs:documentation>
        </xs:annotation>
      </xs:attribute-->
      <xs:attribute default="true" name="sharedfs" type="xs:boolean">
      <xs:annotation>
      <xs:documentation>
      This attributes tells if a parallel job has a shared file system. 
      Set it to <pre>false</pre> if the processes of the job do not share a common file system.
      It gives <exciting/> a chance  to adapt the file IO accordingly
      
      
      </xs:documentation>
      </xs:annotation>
      </xs:attribute>
    </xs:complexType>
  </xs:element>
</xs:schema>
